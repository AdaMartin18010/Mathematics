# åœ¨çº¿å­¦ä¹ ä¸Banditç®—æ³• (Online Learning and Bandits)

> **Learning from Sequential Data: Regret Minimization**
>
> ä»åºåˆ—æ•°æ®å­¦ä¹ ï¼šé—æ†¾æœ€å°åŒ–

---

## ç›®å½•

- [åœ¨çº¿å­¦ä¹ ä¸Banditç®—æ³• (Online Learning and Bandits)](#åœ¨çº¿å­¦ä¹ ä¸banditç®—æ³•-online-learning-and-bandits)
  - [ç›®å½•](#ç›®å½•)
  - [ğŸ“‹ æ ¸å¿ƒæ€æƒ³](#-æ ¸å¿ƒæ€æƒ³)
  - [1. åœ¨çº¿å­¦ä¹ æ¡†æ¶](#1-åœ¨çº¿å­¦ä¹ æ¡†æ¶)
    - [1.1 åœ¨çº¿å­¦ä¹ è®¾ç½®](#11-åœ¨çº¿å­¦ä¹ è®¾ç½®)
    - [1.2 é—æ†¾ (Regret)](#12-é—æ†¾-regret)
    - [1.3 å­¦ä¹ ç›®æ ‡](#13-å­¦ä¹ ç›®æ ‡)
  - [2. ä¸“å®¶é—®é¢˜ä¸Hedgeç®—æ³•](#2-ä¸“å®¶é—®é¢˜ä¸hedgeç®—æ³•)
    - [2.1 ä¸“å®¶é—®é¢˜](#21-ä¸“å®¶é—®é¢˜)
    - [2.2 Hedgeç®—æ³•](#22-hedgeç®—æ³•)
    - [2.3 é—æ†¾ç•Œ](#23-é—æ†¾ç•Œ)
  - [3. åœ¨çº¿å‡¸ä¼˜åŒ–](#3-åœ¨çº¿å‡¸ä¼˜åŒ–)
    - [3.1 åœ¨çº¿å‡¸ä¼˜åŒ–è®¾ç½®](#31-åœ¨çº¿å‡¸ä¼˜åŒ–è®¾ç½®)
    - [3.2 åœ¨çº¿æ¢¯åº¦ä¸‹é™](#32-åœ¨çº¿æ¢¯åº¦ä¸‹é™)
    - [3.3 é—æ†¾ç•Œ](#33-é—æ†¾ç•Œ)
  - [4. å¤šè‡‚è€è™æœº (Multi-Armed Bandits)](#4-å¤šè‡‚è€è™æœº-multi-armed-bandits)
    - [4.1 æ¢ç´¢-åˆ©ç”¨æƒè¡¡](#41-æ¢ç´¢-åˆ©ç”¨æƒè¡¡)
    - [4.2 UCBç®—æ³•](#42-ucbç®—æ³•)
    - [4.3 é—æ†¾ç•Œ](#43-é—æ†¾ç•Œ)
  - [5. ä¸Šä¸‹æ–‡Bandits](#5-ä¸Šä¸‹æ–‡bandits)
    - [5.1 ä¸Šä¸‹æ–‡Banditè®¾ç½®](#51-ä¸Šä¸‹æ–‡banditè®¾ç½®)
    - [5.2 LinUCBç®—æ³•](#52-linucbç®—æ³•)
    - [5.3 åº”ç”¨](#53-åº”ç”¨)
  - [6. å¯¹æŠ—æ€§Bandits](#6-å¯¹æŠ—æ€§bandits)
    - [6.1 å¯¹æŠ—æ€§è®¾ç½®](#61-å¯¹æŠ—æ€§è®¾ç½®)
    - [6.2 Exp3ç®—æ³•](#62-exp3ç®—æ³•)
    - [6.3 é—æ†¾ç•Œ](#63-é—æ†¾ç•Œ)
  - [7. åœ¨çº¿å­¦ä¹ ä¸å¼ºåŒ–å­¦ä¹ ](#7-åœ¨çº¿å­¦ä¹ ä¸å¼ºåŒ–å­¦ä¹ )
    - [7.1 è”ç³»](#71-è”ç³»)
    - [7.2 åº”ç”¨](#72-åº”ç”¨)
  - [8. å½¢å¼åŒ–å®šä¹‰ (Lean)](#8-å½¢å¼åŒ–å®šä¹‰-lean)
  - [9. ä¹ é¢˜](#9-ä¹ é¢˜)
  - [10. å‚è€ƒèµ„æ–™](#10-å‚è€ƒèµ„æ–™)

---

## ğŸ“‹ æ ¸å¿ƒæ€æƒ³

**åœ¨çº¿å­¦ä¹ **ç ”ç©¶å¦‚ä½•ä»åºåˆ—æ•°æ®ä¸­å­¦ä¹ ï¼Œç›®æ ‡æ˜¯**æœ€å°åŒ–é—æ†¾**ï¼ˆä¸æœ€ä¼˜ç­–ç•¥çš„å·®è·ï¼‰ã€‚

**ä¸ºä»€ä¹ˆåœ¨çº¿å­¦ä¹ é‡è¦**:

```text
æ ¸å¿ƒé—®é¢˜:
â”œâ”€ å¦‚ä½•ä»åºåˆ—æ•°æ®ä¸­å­¦ä¹ ï¼Ÿ
â”œâ”€ å¦‚ä½•å¹³è¡¡æ¢ç´¢ä¸åˆ©ç”¨ï¼Ÿ
â”œâ”€ å¦‚ä½•åœ¨å¯¹æŠ—ç¯å¢ƒä¸­å­¦ä¹ ï¼Ÿ
â””â”€ åœ¨çº¿å­¦ä¹ ä¸ç¦»çº¿å­¦ä¹ çš„åŒºåˆ«ï¼Ÿ

ç†è®ºå·¥å…·:
â”œâ”€ é—æ†¾ç•Œ: æ€§èƒ½åº¦é‡
â”œâ”€ Hedgeç®—æ³•: ä¸“å®¶é—®é¢˜
â”œâ”€ UCB: æ¢ç´¢-åˆ©ç”¨æƒè¡¡
â””â”€ åœ¨çº¿æ¢¯åº¦ä¸‹é™: å‡¸ä¼˜åŒ–

å®è·µåº”ç”¨:
â”œâ”€ æ¨èç³»ç»Ÿ: ä¸ªæ€§åŒ–æ¨è
â”œâ”€ å¹¿å‘ŠæŠ•æ”¾: ç‚¹å‡»ç‡ä¼˜åŒ–
â”œâ”€ åœ¨çº¿ä¼˜åŒ–: åŠ¨æ€å†³ç­–
â””â”€ å¼ºåŒ–å­¦ä¹ : åºåˆ—å†³ç­–
```

---

## 1. åœ¨çº¿å­¦ä¹ æ¡†æ¶

### 1.1 åœ¨çº¿å­¦ä¹ è®¾ç½®

**åœ¨çº¿å­¦ä¹ åè®®**:

1. **å›åˆ** \( t = 1, 2, \ldots, T \)
2. ç®—æ³•é€‰æ‹©åŠ¨ä½œ \( a_t \in \mathcal{A} \)
3. ç¯å¢ƒæ­ç¤ºæŸå¤± \( \ell_t(a_t) \in [0, 1] \)
4. ç®—æ³•æ›´æ–°ç­–ç•¥

**ç›®æ ‡**: æœ€å°åŒ–ç´¯ç§¯æŸå¤± \( \sum_{t=1}^T \ell_t(a_t) \)

### 1.2 é—æ†¾ (Regret)

**å®šä¹‰ 1.1** (é—æ†¾)
**é—æ†¾**å®šä¹‰ä¸ºï¼š
\[
R_T = \sum_{t=1}^T \ell_t(a_t) - \min_{a^* \in \mathcal{A}} \sum_{t=1}^T \ell_t(a^*)
\]

**è§£é‡Š**: ç®—æ³•çš„ç´¯ç§¯æŸå¤±ä¸æœ€ä¼˜å›ºå®šåŠ¨ä½œçš„å·®è·ã€‚

**ç›®æ ‡**: å®ç°**æ¬¡çº¿æ€§é—æ†¾** \( R_T = o(T) \)ï¼Œå³å¹³å‡é—æ†¾è¶‹äº0ã€‚

### 1.3 å­¦ä¹ ç›®æ ‡

**ç›®æ ‡**: è®¾è®¡ç®—æ³•ä½¿å¾—ï¼š
\[
R_T \leq O(\sqrt{T \log |\mathcal{A}|})
\]

---

## 2. ä¸“å®¶é—®é¢˜ä¸Hedgeç®—æ³•

### 2.1 ä¸“å®¶é—®é¢˜

**è®¾ç½®**:
- \( N \) ä¸ªä¸“å®¶
- æ¯å›åˆï¼Œæ¯ä¸ªä¸“å®¶ç»™å‡ºå»ºè®®
- ç®—æ³•é€‰æ‹©ä¸“å®¶ï¼ˆæˆ–ç»„åˆï¼‰
- ç¯å¢ƒæ­ç¤ºæ‰€æœ‰ä¸“å®¶çš„æŸå¤±

### 2.2 Hedgeç®—æ³•

**Hedgeç®—æ³•**:

1. åˆå§‹åŒ–æƒé‡ \( w_1(i) = 1 \) for all \( i \)
2. For \( t = 1, \ldots, T \):
   - é€‰æ‹©ä¸“å®¶ \( i \) çš„æ¦‚ç‡ï¼š\( p_t(i) = \frac{w_t(i)}{\sum_j w_t(j)} \)
   - è§‚å¯ŸæŸå¤± \( \ell_t(i) \)
   - æ›´æ–°æƒé‡ï¼š\( w_{t+1}(i) = w_t(i) \exp(-\eta \ell_t(i)) \)

å…¶ä¸­ \( \eta > 0 \) æ˜¯å­¦ä¹ ç‡ã€‚

### 2.3 é—æ†¾ç•Œ

**å®šç† 2.1** (Hedgeé—æ†¾ç•Œ)
Hedgeç®—æ³•ï¼ˆå­¦ä¹ ç‡ \( \eta = \sqrt{2\log N / T} \)ï¼‰çš„é—æ†¾ç•Œä¸ºï¼š
\[
R_T \leq \sqrt{2T \log N}
\]

**è¯æ˜æ€è·¯**: ä½¿ç”¨æƒé‡å’Œçš„å¯¹æ•°ä½œä¸ºåŠ¿å‡½æ•°ï¼Œåˆ†æå…¶å˜åŒ–ã€‚

---

## 3. åœ¨çº¿å‡¸ä¼˜åŒ–

### 3.1 åœ¨çº¿å‡¸ä¼˜åŒ–è®¾ç½®

**è®¾ç½®**:
- å†³ç­–é›† \( \mathcal{K} \subset \mathbb{R}^d \)ï¼ˆå‡¸é›†ï¼‰
- æ¯å›åˆï¼Œç®—æ³•é€‰æ‹© \( x_t \in \mathcal{K} \)
- ç¯å¢ƒæ­ç¤ºå‡¸æŸå¤±å‡½æ•° \( f_t: \mathcal{K} \to \mathbb{R} \)
- ç®—æ³•è§‚å¯Ÿ \( f_t \) å’Œæ¢¯åº¦ \( \nabla f_t(x_t) \)

### 3.2 åœ¨çº¿æ¢¯åº¦ä¸‹é™

**åœ¨çº¿æ¢¯åº¦ä¸‹é™ (OGD)**:

1. åˆå§‹åŒ– \( x_1 \in \mathcal{K} \)
2. For \( t = 1, \ldots, T \):
   - é€‰æ‹© \( x_t \)
   - è§‚å¯Ÿ \( f_t \) å’Œ \( \nabla f_t(x_t) \)
   - æ›´æ–°ï¼š\( y_{t+1} = x_t - \eta_t \nabla f_t(x_t) \)
   - æŠ•å½±ï¼š\( x_{t+1} = \Pi_{\mathcal{K}}(y_{t+1}) \)

å…¶ä¸­ \( \eta_t \) æ˜¯å­¦ä¹ ç‡ï¼Œ\( \Pi_{\mathcal{K}} \) æ˜¯æŠ•å½±ç®—å­ã€‚

### 3.3 é—æ†¾ç•Œ

**å®šç† 3.1** (OGDé—æ†¾ç•Œ)
å¦‚æœ \( \|x\|_2 \leq D \) ä¸” \( \|\nabla f_t(x)\|_2 \leq G \)ï¼Œåˆ™OGDï¼ˆå­¦ä¹ ç‡ \( \eta_t = D/(G\sqrt{t}) \)ï¼‰çš„é—æ†¾ç•Œä¸ºï¼š
\[
R_T \leq DG\sqrt{2T}
\]

---

## 4. å¤šè‡‚è€è™æœº (Multi-Armed Bandits)

### 4.1 æ¢ç´¢-åˆ©ç”¨æƒè¡¡

**å¤šè‡‚è€è™æœºé—®é¢˜**:
- \( K \) ä¸ªè‡‚ï¼ˆåŠ¨ä½œï¼‰
- æ¯å›åˆé€‰æ‹©ä¸€ä¸ªè‡‚
- åªè§‚å¯Ÿæ‰€é€‰è‡‚çš„å¥–åŠ±ï¼ˆä¸è§‚å¯Ÿå…¶ä»–è‡‚ï¼‰

**æŒ‘æˆ˜**: **æ¢ç´¢-åˆ©ç”¨æƒè¡¡**
- æ¢ç´¢ï¼šå°è¯•æœªçŸ¥è‡‚ä»¥è·å–ä¿¡æ¯
- åˆ©ç”¨ï¼šé€‰æ‹©å½“å‰æœ€ä¼˜è‡‚ä»¥æœ€å¤§åŒ–å¥–åŠ±

### 4.2 UCBç®—æ³•

**UCB (Upper Confidence Bound) ç®—æ³•**:

1. åˆå§‹åŒ–ï¼šæ¯ä¸ªè‡‚æ‹‰ä¸€æ¬¡
2. For \( t = K+1, \ldots, T \):
   - é€‰æ‹© \( a_t = \arg\max_{a} \left(\hat{\mu}_a + c\sqrt{\frac{\log t}{n_a}}\right) \)
   - è§‚å¯Ÿå¥–åŠ± \( r_t \)
   - æ›´æ–° \( \hat{\mu}_{a_t} \) å’Œ \( n_{a_t} \)

å…¶ä¸­ï¼š
- \( \hat{\mu}_a \) æ˜¯è‡‚ \( a \) çš„å¹³å‡å¥–åŠ±
- \( n_a \) æ˜¯è‡‚ \( a \) è¢«é€‰æ‹©çš„æ¬¡æ•°
- \( c \) æ˜¯ç½®ä¿¡åº¦å‚æ•°

### 4.3 é—æ†¾ç•Œ

**å®šç† 4.1** (UCBé—æ†¾ç•Œ)
UCBç®—æ³•çš„é—æ†¾ç•Œä¸ºï¼š
\[
R_T \leq O\left(\sum_{a: \Delta_a > 0} \frac{\log T}{\Delta_a}\right)
\]

å…¶ä¸­ \( \Delta_a = \mu^* - \mu_a \) æ˜¯æ¬¡ä¼˜è‡‚çš„å·®è·ã€‚

---

## 5. ä¸Šä¸‹æ–‡Bandits

### 5.1 ä¸Šä¸‹æ–‡Banditè®¾ç½®

**è®¾ç½®**:
- æ¯å›åˆï¼Œç¯å¢ƒæä¾›ä¸Šä¸‹æ–‡ \( x_t \in \mathbb{R}^d \)
- ç®—æ³•é€‰æ‹©åŠ¨ä½œ \( a_t \in \mathcal{A} \)
- è§‚å¯Ÿå¥–åŠ± \( r_t(a_t) \in [0, 1] \)

**ç›®æ ‡**: å­¦ä¹ ä»ä¸Šä¸‹æ–‡åˆ°åŠ¨ä½œçš„æ˜ å°„ã€‚

### 5.2 LinUCBç®—æ³•

**LinUCBç®—æ³•**ï¼ˆçº¿æ€§ä¸Šä¸‹æ–‡Banditsï¼‰:

å‡è®¾å¥–åŠ±æ¨¡å‹ï¼š\( r_t(a) = \langle \theta_a, x_t \rangle + \epsilon_t \)

1. åˆå§‹åŒ–ï¼š\( A_a = I \)ï¼Œ\( b_a = 0 \) for all \( a \)
2. For \( t = 1, \ldots, T \):
   - è§‚å¯Ÿä¸Šä¸‹æ–‡ \( x_t \)
   - å¯¹æ¯ä¸ªåŠ¨ä½œ \( a \)ï¼Œè®¡ç®—ï¼š
     \[
     UCB_t(a) = \langle \hat{\theta}_a, x_t \rangle + \alpha \sqrt{x_t^T A_a^{-1} x_t}
     \]
   - é€‰æ‹© \( a_t = \arg\max_a UCB_t(a) \)
   - è§‚å¯Ÿå¥–åŠ± \( r_t \)
   - æ›´æ–°ï¼š\( A_{a_t} \leftarrow A_{a_t} + x_t x_t^T \)ï¼Œ\( b_{a_t} \leftarrow b_{a_t} + r_t x_t \)

### 5.3 åº”ç”¨

**åº”ç”¨**: æ¨èç³»ç»Ÿã€å¹¿å‘ŠæŠ•æ”¾ã€ä¸ªæ€§åŒ–åŒ»ç–—ã€‚

---

## 6. å¯¹æŠ—æ€§Bandits

### 6.1 å¯¹æŠ—æ€§è®¾ç½®

**å¯¹æŠ—æ€§Bandits**:
- ç¯å¢ƒæ˜¯**å¯¹æŠ—æ€§çš„**ï¼ˆå¯èƒ½é€‰æ‹©æœ€åæƒ…å†µï¼‰
- ä¸å‡è®¾å¥–åŠ±åˆ†å¸ƒ
- ç›®æ ‡æ˜¯**å¯¹æŠ—æ€§é—æ†¾**

### 6.2 Exp3ç®—æ³•

**Exp3 (Exponential-weight algorithm for Exploration and Exploitation)**:

1. åˆå§‹åŒ–æƒé‡ \( w_1(a) = 1 \) for all \( a \)
2. For \( t = 1, \ldots, T \):
   - é€‰æ‹©åŠ¨ä½œ \( a_t \) çš„æ¦‚ç‡ï¼š\( p_t(a) = (1-\gamma)\frac{w_t(a)}{\sum_b w_t(b)} + \frac{\gamma}{K} \)
   - è§‚å¯Ÿå¥–åŠ± \( r_t \)
   - ä¼°è®¡æŸå¤±ï¼š\( \hat{\ell}_t(a) = \frac{1 - r_t}{p_t(a)} \mathbb{1}\{a = a_t\} \)
   - æ›´æ–°æƒé‡ï¼š\( w_{t+1}(a) = w_t(a) \exp(-\eta \hat{\ell}_t(a)) \)

å…¶ä¸­ \( \gamma \in (0, 1] \) æ˜¯æ¢ç´¢å‚æ•°ã€‚

### 6.3 é—æ†¾ç•Œ

**å®šç† 6.1** (Exp3é—æ†¾ç•Œ)
Exp3ç®—æ³•ï¼ˆ\( \eta = \sqrt{\log K / (KT)} \)ï¼Œ\( \gamma = \eta K \)ï¼‰çš„å¯¹æŠ—æ€§é—æ†¾ç•Œä¸ºï¼š
\[
R_T \leq 2\sqrt{KT \log K}
\]

---

## 7. åœ¨çº¿å­¦ä¹ ä¸å¼ºåŒ–å­¦ä¹ 

### 7.1 è”ç³»

**è”ç³»**:
- åœ¨çº¿å­¦ä¹ ï¼šæ¯å›åˆç‹¬ç«‹å†³ç­–
- å¼ºåŒ–å­¦ä¹ ï¼šè€ƒè™‘çŠ¶æ€è½¬ç§»å’Œé•¿æœŸå¥–åŠ±

**å…³ç³»**: å¼ºåŒ–å­¦ä¹ å¯ä»¥çœ‹ä½œå¸¦çŠ¶æ€çš„åœ¨çº¿å­¦ä¹ ã€‚

### 7.2 åº”ç”¨

**åº”ç”¨**:
- åœ¨çº¿æ¨èç³»ç»Ÿ
- åŠ¨æ€å®šä»·
- èµ„æºåˆ†é…

---

## 8. å½¢å¼åŒ–å®šä¹‰ (Lean)

```lean
-- é—æ†¾
def regret (T : â„•) (alg : Fin T â†’ A) (loss : Fin T â†’ A â†’ â„) : â„ :=
  âˆ‘ t, loss t (alg t) - min_{a : A} âˆ‘ t, loss t a

-- Hedgeç®—æ³•
def hedge (Î· : â„) (N : â„•) : Algorithm :=
  Î» t w, update_weights w (Î» i, exp (-Î· * loss t i))

-- UCBç®—æ³•
def ucb (c : â„) (K : â„•) : Algorithm :=
  Î» t Î¼Ì‚ n, argmax (Î» a, Î¼Ì‚ a + c * sqrt (log t / n a))
```

---

## 9. ä¹ é¢˜

### åŸºç¡€ä¹ é¢˜

1. **é—æ†¾è®¡ç®—**:
   è®¡ç®—Hedgeç®—æ³•åœ¨2ä¸“å®¶ã€3å›åˆæƒ…å†µä¸‹çš„é—æ†¾ã€‚

2. **UCBç®—æ³•**:
   å®ç°UCBç®—æ³•å¹¶éªŒè¯é—æ†¾ç•Œã€‚

3. **åœ¨çº¿æ¢¯åº¦ä¸‹é™**:
   æ¨å¯¼OGDçš„é—æ†¾ç•Œã€‚

### è¿›é˜¶ä¹ é¢˜

1. **è‡ªé€‚åº”å­¦ä¹ ç‡**:
   è®¾è®¡è‡ªé€‚åº”å­¦ä¹ ç‡çš„åœ¨çº¿æ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚

2. **ä¸Šä¸‹æ–‡Bandits**:
   åˆ†æLinUCBçš„é—æ†¾ç•Œã€‚

3. **å¯¹æŠ—æ€§Bandits**:
   è¯æ˜Exp3çš„é—æ†¾ç•Œã€‚

---

## 10. å‚è€ƒèµ„æ–™

### æ•™æ

1. **Cesa-Bianchi, N. & Lugosi, G.** *Prediction, Learning, and Games*. Cambridge University Press, 2006.
2. **Hazan, E.** "Introduction to Online Convex Optimization." *Foundations and Trends in Machine Learning*, 2016.
3. **Lattimore, T. & SzepesvÃ¡ri, C.** *Bandit Algorithms*. Cambridge University Press, 2020.

### è¯¾ç¨‹

1. **Stanford CS234** - Reinforcement Learning
2. **CMU 10-703** - Deep Reinforcement Learning

### è®ºæ–‡

1. **Auer, P. et al.** "Finite-time Analysis of the Multiarmed Bandit Problem." *Machine Learning*, 2002.
2. **Li, L. et al.** "A Contextual-Bandit Approach to Personalized News Article Recommendation." *WWW*, 2010.

---

**æœ€åæ›´æ–°**: 2025-12-20
**å®Œæˆåº¦**: çº¦75% (æ ¸å¿ƒå†…å®¹å®Œæˆï¼Œå¯ç»§ç»­è¡¥å……æ›´å¤šåº”ç”¨å®ä¾‹å’Œå½¢å¼åŒ–è¯æ˜)
