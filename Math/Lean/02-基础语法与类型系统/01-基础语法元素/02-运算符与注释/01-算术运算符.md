# 算术运算符 | Arithmetic Operators

## 概述 | Overview

Lean提供了丰富的算术运算符，支持自然数、整数、实数等不同类型的数值运算。这些运算符是数学计算和证明的基础。

Lean provides rich arithmetic operators supporting numerical operations on different types like natural numbers, integers, and real numbers. These operators are fundamental to mathematical computation and proof.

## 基本算术运算符 | Basic Arithmetic Operators

### 1. 加法运算符 | Addition Operator

```lean
-- 自然数加法 | Natural number addition
#eval 3 + 4  -- 结果: 7

-- 整数加法 | Integer addition
#eval (-3) + 4  -- 结果: 1

-- 实数加法 | Real number addition
#eval 3.14 + 2.86  -- 结果: 6.0

-- 函数中的加法 | Addition in functions
def add (x y : Nat) : Nat := x + y
#eval add 5 3  -- 结果: 8
```

### 2. 减法运算符 | Subtraction Operator

```lean
-- 自然数减法 | Natural number subtraction
#eval 7 - 3  -- 结果: 4

-- 整数减法 | Integer subtraction
#eval 3 - 7  -- 结果: -4

-- 实数减法 | Real number subtraction
#eval 5.5 - 2.3  -- 结果: 3.2

-- 函数中的减法 | Subtraction in functions
def subtract (x y : Nat) : Nat := x - y
#eval subtract 10 4  -- 结果: 6
```

### 3. 乘法运算符 | Multiplication Operator

```lean
-- 自然数乘法 | Natural number multiplication
#eval 3 * 4  -- 结果: 12

-- 整数乘法 | Integer multiplication
#eval (-3) * 4  -- 结果: -12

-- 实数乘法 | Real number multiplication
#eval 2.5 * 4.0  -- 结果: 10.0

-- 函数中的乘法 | Multiplication in functions
def multiply (x y : Nat) : Nat := x * y
#eval multiply 6 7  -- 结果: 42
```

### 4. 除法运算符 | Division Operator

```lean
-- 自然数除法 | Natural number division
#eval 15 / 3  -- 结果: 5

-- 整数除法 | Integer division
#eval (-15) / 3  -- 结果: -5

-- 实数除法 | Real number division
#eval 15.0 / 3.0  -- 结果: 5.0

-- 函数中的除法 | Division in functions
def divide (x y : Nat) : Nat := x / y
#eval divide 20 4  -- 结果: 5
```

## 高级算术运算符 | Advanced Arithmetic Operators

### 1. 取模运算符 | Modulo Operator

```lean
-- 自然数取模 | Natural number modulo
#eval 17 % 5  -- 结果: 2

-- 整数取模 | Integer modulo
#eval (-17) % 5  -- 结果: 3

-- 函数中的取模 | Modulo in functions
def modulo (x y : Nat) : Nat := x % y
#eval modulo 23 7  -- 结果: 2
```

### 2. 幂运算 | Exponentiation

```lean
-- 自然数幂运算 | Natural number exponentiation
#eval 2 ^ 3  -- 结果: 8

-- 实数幂运算 | Real number exponentiation
#eval 2.0 ^ 3.0  -- 结果: 8.0

-- 函数中的幂运算 | Exponentiation in functions
def power (x y : Nat) : Nat := x ^ y
#eval power 3 4  -- 结果: 81
```

### 3. 绝对值 | Absolute Value

```lean
-- 整数绝对值 | Integer absolute value
#eval abs (-5)  -- 结果: 5
#eval abs 5     -- 结果: 5

-- 实数绝对值 | Real number absolute value
#eval abs (-3.14)  -- 结果: 3.14

-- 函数中的绝对值 | Absolute value in functions
def absolute (x : Int) : Int := abs x
#eval absolute (-10)  -- 结果: 10
```

## 比较运算符 | Comparison Operators

### 1. 相等性比较 | Equality Comparison

```lean
-- 自然数相等性 | Natural number equality
#eval 5 = 5  -- 结果: true
#eval 5 = 3  -- 结果: false

-- 实数相等性 | Real number equality
#eval 3.14 = 3.14  -- 结果: true

-- 函数中的相等性 | Equality in functions
def isEqual (x y : Nat) : Bool := x = y
#eval isEqual 7 7  -- 结果: true
```

### 2. 大小比较 | Size Comparison

```lean
-- 小于比较 | Less than comparison
#eval 3 < 5  -- 结果: true
#eval 5 < 3  -- 结果: false

-- 小于等于比较 | Less than or equal comparison
#eval 3 ≤ 5  -- 结果: true
#eval 5 ≤ 5  -- 结果: true

-- 大于比较 | Greater than comparison
#eval 5 > 3  -- 结果: true
#eval 3 > 5  -- 结果: false

-- 大于等于比较 | Greater than or equal comparison
#eval 5 ≥ 3  -- 结果: true
#eval 5 ≥ 5  -- 结果: true
```

## 运算符优先级 | Operator Precedence

### 1. 优先级规则 | Precedence Rules

```lean
-- 运算符优先级（从高到低）| Operator precedence (high to low)
-- 1. 函数应用和括号
-- 2. ^ (幂运算)
-- 3. *, /, % (乘法、除法、取模)
-- 4. +, - (加法、减法)
-- 5. =, <, ≤, >, ≥ (比较运算符)

-- 示例 | Examples
#eval 2 + 3 * 4    -- 结果: 14 (等同于 2 + (3 * 4))
#eval 2 * 3 ^ 4    -- 结果: 162 (等同于 2 * (3 ^ 4))
#eval 2 ^ 3 * 4    -- 结果: 32 (等同于 (2 ^ 3) * 4)
```

### 2. 括号使用 | Parentheses Usage

```lean
-- 使用括号改变优先级 | Use parentheses to change precedence
#eval (2 + 3) * 4  -- 结果: 20
#eval 2 + (3 * 4)  -- 结果: 14

-- 复杂表达式 | Complex expressions
#eval ((2 + 3) * 4) ^ 2  -- 结果: 400
#eval 2 + 3 * 4 ^ 2      -- 结果: 50
```

## 类型相关运算符 | Type-Related Operators

### 1. 类型转换 | Type Conversion

```lean
-- 自然数到整数转换 | Natural to integer conversion
#eval (5 : Nat) + (3 : Int)  -- 需要显式转换

-- 整数到实数转换 | Integer to real conversion
#eval (5 : Int) + (3.14 : Float)  -- 需要显式转换

-- 函数中的类型转换 | Type conversion in functions
def convertAndAdd (x : Nat) (y : Int) : Int :=
  (x : Int) + y
#eval convertAndAdd 5 3  -- 结果: 8
```

### 2. 类型类实例 | Type Class Instances

```lean
-- 使用类型类进行运算 | Use type classes for operations
class Add (α : Type) where
  add : α → α → α

instance : Add Nat where
  add := Nat.add

instance : Add Int where
  add := Int.add

-- 泛型加法函数 | Generic addition function
def genericAdd [Add α] (x y : α) : α := Add.add x y
```

## 实际应用示例 | Practical Application Examples

### 1. 数学函数 | Mathematical Functions

```lean
-- 平方函数 | Square function
def square (x : Nat) : Nat := x * x
#eval square 5  -- 结果: 25

-- 阶乘函数 | Factorial function
def factorial (n : Nat) : Nat :=
  match n with
  | 0 => 1
  | n + 1 => (n + 1) * factorial n
#eval factorial 5  -- 结果: 120

-- 最大公约数 | Greatest common divisor
def gcd (a b : Nat) : Nat :=
  if b = 0 then a else gcd b (a % b)
#eval gcd 48 18  -- 结果: 6
```

### 2. 统计函数 | Statistical Functions

```lean
-- 平均值 | Average
def average (xs : List Nat) : Float :=
  if xs.isEmpty then 0.0
  else (xs.sum : Float) / xs.length
#eval average [1, 2, 3, 4, 5]  -- 结果: 3.0

-- 方差 | Variance
def variance (xs : List Nat) : Float :=
  let avg := average xs
  let squaredDiffs := xs.map (fun x => (x : Float) - avg) |>.map (· ^ 2)
  average squaredDiffs
```

## 最佳实践 | Best Practices

### 1. 运算符使用 | Operator Usage

```lean
-- 优先使用标准运算符 | Prefer standard operators
def add (x y : Nat) : Nat := x + y  -- 推荐
def add (x y : Nat) : Nat := Nat.add x y  -- 避免

-- 使用括号提高可读性 | Use parentheses for readability
def complex (a b c : Nat) : Nat :=
  (a + b) * (c - a)  -- 清晰
def complex (a b c : Nat) : Nat :=
  a + b * c - a  -- 模糊
```

### 2. 类型安全 | Type Safety

```lean
-- 确保类型匹配 | Ensure type matching
def safeAdd (x y : Nat) : Nat := x + y  -- 类型安全

-- 避免类型不匹配 | Avoid type mismatches
-- def unsafeAdd (x : Nat) (y : Int) : Nat := x + y  -- 错误
def safeAdd (x : Nat) (y : Int) : Int := (x : Int) + y  -- 正确
```

## 相关链接 | Related Links

- [02-逻辑运算符](./02-逻辑运算符.md)
- [03-位运算符](./03-位运算符.md)
- [04-注释系统](./04-注释系统.md)
- [类型系统基础](../../02-类型系统基础/README.md)

## 练习 | Exercises

1. 实现基本的数学函数（平方、立方、阶乘）
2. 创建统计计算函数（平均值、方差、标准差）
3. 设计类型安全的算术运算库

---

*最后更新：2025年1月*
*版本：1.0*
