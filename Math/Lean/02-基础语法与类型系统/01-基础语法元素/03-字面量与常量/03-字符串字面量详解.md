# 字符串字面量详解 | String Literals Detailed

## 1. 基本字符串字面量 | Basic String Literals

### 简单字符串 | Simple Strings

```lean
-- 基本字符串
#check "hello" : String
#check "world" : String
#check "Lean 4" : String
#check "" : String  -- 空字符串

-- 包含空格的字符串
#check "hello world" : String
#check "  spaces  " : String
#check "multiple   spaces" : String
```

### 字符串长度和内容 | String Length and Content

```lean
-- 字符串长度
#check "hello".length : Nat  -- 5
#check "".length : Nat       -- 0
#check "Lean 4".length : Nat -- 6

-- 字符串内容检查
def is_empty (s : String) : Bool := s.length = 0
def is_non_empty (s : String) : Bool := s.length > 0

#check is_empty ""        -- true
#check is_empty "hello"   -- false
#check is_non_empty "hi"  -- true
```

## 2. 转义字符 | Escape Characters

### 基本转义字符 | Basic Escape Characters

```lean
-- 换行符
#check "line1\nline2" : String
#check "first\nsecond\nthird" : String

-- 制表符
#check "col1\tcol2\tcol3" : String
#check "name\tage\tcity" : String

-- 回车符
#check "line1\rline2" : String

-- 反斜杠
#check "path\\to\\file" : String
#check "C:\\Users\\Name" : String

-- 双引号
#check "He said \"Hello\"" : String
#check "Quote: \"To be or not to be\"" : String

-- 单引号
#check "It's a beautiful day" : String
#check "Don't worry" : String
```

### 特殊转义字符 | Special Escape Characters

```lean
-- 空字符
#check "null\0char" : String

-- 退格符
#check "back\bspace" : String

-- 换页符
#check "form\ffeed" : String

-- 垂直制表符
#check "vertical\vtab" : String

-- 八进制转义
#check "octal\101" : String  -- \101 = 'A'

-- 十六进制转义
#check "hex\x41" : String    -- \x41 = 'A'
#check "unicode\u0041" : String  -- \u0041 = 'A'
```

## 3. 多行字符串 | Multiline Strings

### 基本多行字符串 | Basic Multiline Strings

```lean
-- 使用\n的多行字符串
def multiline_text : String := "This is line 1\nThis is line 2\nThis is line 3"

-- 使用转义字符的多行字符串
def code_example : String := "def hello : String := \"world\"\n#check hello"

-- 包含缩进的多行字符串
def indented_text : String := "  Indented line 1\n  Indented line 2\n    More indented"
```

### 原始字符串 | Raw Strings

```lean
-- 使用三重引号的原始字符串（如果支持）
-- 注意：Lean 4 可能不直接支持三重引号，这里展示概念
def raw_string_concept : String := "This is a \"raw\" string with \\backslashes and \n newlines"

-- 替代方案：使用字符串连接
def multiline_alternative : String :=
  "Line 1" ++ "\n" ++
  "Line 2" ++ "\n" ++
  "Line 3"
```

## 4. 字符串操作 | String Operations

### 字符串连接 | String Concatenation

```lean
-- 基本连接
#check "hello" ++ " " ++ "world" : String  -- "hello world"

-- 多个字符串连接
def greet (name : String) : String := "Hello, " ++ name ++ "!"
#check greet "Alice"  -- "Hello, Alice!"

-- 使用String.append
def append_example : String := String.append "prefix" "suffix"
#check append_example  -- "prefixsuffix"
```

### 字符串长度和索引 | String Length and Indexing

```lean
-- 字符串长度
def get_length (s : String) : Nat := s.length
#check get_length "hello"  -- 5

-- 字符串索引（注意：Lean 4的字符串索引可能有限制）
def get_first_char (s : String) : Option Char :=
  if s.length > 0 then s.get 0 else none

-- 字符串切片
def get_substring (s : String) (start len : Nat) : String :=
  s.extract start (start + len)
```

## 5. 字符串比较 | String Comparison

### 基本比较 | Basic Comparison

```lean
-- 字符串相等
def strings_equal (s1 s2 : String) : Bool := s1 = s2
#check strings_equal "hello" "hello"  -- true
#check strings_equal "hello" "world"  -- false

-- 字符串不等
def strings_not_equal (s1 s2 : String) : Bool := s1 ≠ s2
#check strings_not_equal "hello" "world"  -- true

-- 字典序比较
def string_less_than (s1 s2 : String) : Bool := s1 < s2
#check string_less_than "apple" "banana"  -- true
#check string_less_than "zebra" "apple"   -- false
```

### 大小写比较 | Case Comparison

```lean
-- 大小写敏感比较
def case_sensitive_equal (s1 s2 : String) : Bool := s1 = s2
#check case_sensitive_equal "Hello" "hello"  -- false

-- 大小写不敏感比较（需要实现）
def case_insensitive_equal (s1 s2 : String) : Bool :=
  s1.toLower = s2.toLower
#check case_insensitive_equal "Hello" "hello"  -- true
```

## 6. 字符串转换 | String Conversion

### 数字到字符串 | Number to String

```lean
-- 自然数到字符串
def nat_to_string (n : Nat) : String := toString n
#check nat_to_string 42  -- "42"

-- 整数到字符串
def int_to_string (i : Int) : String := toString i
#check int_to_string (-42)  -- "-42"

-- 浮点数到字符串
def float_to_string (f : Float) : String := toString f
#check float_to_string 3.14  -- "3.14"
```

### 字符串到数字 | String to Number

```lean
-- 字符串到自然数（需要解析函数）
def string_to_nat (s : String) : Option Nat :=
  -- 这里需要实现字符串解析逻辑
  -- 简化示例
  if s = "42" then some 42 else none

-- 字符串到整数
def string_to_int (s : String) : Option Int :=
  if s = "-42" then some (-42) else none
```

## 7. 字符串格式化 | String Formatting

### 基本格式化 | Basic Formatting

```lean
-- 简单的字符串模板
def format_greeting (name : String) (age : Nat) : String :=
  "Hello, " ++ name ++ "! You are " ++ toString age ++ " years old."

#check format_greeting "Alice" 25  -- "Hello, Alice! You are 25 years old."

-- 格式化数字
def format_number (n : Nat) : String :=
  "The number is: " ++ toString n

#check format_number 42  -- "The number is: 42"
```

### 复杂格式化 | Complex Formatting

```lean
-- 多参数格式化
def format_person (name : String) (age : Nat) (city : String) : String :=
  "Name: " ++ name ++ ", Age: " ++ toString age ++ ", City: " ++ city

#check format_person "Bob" 30 "New York"  -- "Name: Bob, Age: 30, City: New York"

-- 条件格式化
def format_status (name : String) (is_active : Bool) : String :=
  name ++ " is " ++ (if is_active then "active" else "inactive")

#check format_status "User1" true   -- "User1 is active"
#check format_status "User2" false  -- "User2 is inactive"
```

## 8. 字符串常量定义 | String Constant Definitions

### 系统消息 | System Messages

```lean
-- 错误消息
def ERROR_INVALID_INPUT : String := "Error: Invalid input provided"
def ERROR_FILE_NOT_FOUND : String := "Error: File not found"
def ERROR_PERMISSION_DENIED : String := "Error: Permission denied"

-- 成功消息
def SUCCESS_OPERATION_COMPLETE : String := "Operation completed successfully"
def SUCCESS_FILE_SAVED : String := "File saved successfully"

-- 警告消息
def WARNING_DEPRECATED_FEATURE : String := "Warning: This feature is deprecated"
def WARNING_LOW_MEMORY : String := "Warning: Low memory detected"
```

### 用户界面文本 | User Interface Text

```lean
-- 按钮文本
def BUTTON_OK : String := "OK"
def BUTTON_CANCEL : String := "Cancel"
def BUTTON_SAVE : String := "Save"
def BUTTON_DELETE : String := "Delete"

-- 菜单项
def MENU_FILE : String := "File"
def MENU_EDIT : String := "Edit"
def MENU_VIEW : String := "View"
def MENU_HELP : String := "Help"

-- 状态文本
def STATUS_READY : String := "Ready"
def STATUS_LOADING : String := "Loading..."
def STATUS_PROCESSING : String := "Processing..."
```

## 9. 字符串最佳实践 | String Best Practices

### 性能优化 | Performance Optimization

```lean
-- 避免频繁的字符串连接
def efficient_concat (parts : List String) : String :=
  String.join parts  -- 使用专门的连接函数

-- 使用StringBuilder模式（如果可用）
def build_message (name : String) (count : Nat) : String :=
  let parts := ["User ", name, " has ", toString count, " items"]
  String.join parts
```

### 可读性 | Readability

```lean
-- 使用有意义的常量名
def WELCOME_MESSAGE : String := "Welcome to Lean 4!"
def GOODBYE_MESSAGE : String := "Thank you for using Lean 4!"

-- 避免硬编码字符串
def format_user_message (username : String) : String :=
  "Hello, " ++ username ++ "! Welcome to our application."

-- 使用描述性的变量名
def user_input := "hello world"
def processed_input := user_input.toUpper
```

### 国际化考虑 | Internationalization Considerations

```lean
-- 为国际化准备字符串常量
def MSG_HELLO : String := "Hello"
def MSG_GOODBYE : String := "Goodbye"
def MSG_ERROR : String := "Error"

-- 支持多语言的字符串模板
def format_message (template : String) (args : List String) : String :=
  -- 这里可以实现简单的模板替换
  template  -- 简化实现
```

---

*相关链接：*

- [字面量与常量总览](./01-总览.md)
- [数值字面量详解](./02-数值字面量详解.md)
- [字符字面量详解](./04-字符字面量详解.md)
