# 字符字面量详解 | Character Literals Detailed

## 1. 基本字符字面量 | Basic Character Literals

### 简单字符 | Simple Characters

```lean
-- 基本字符
#check 'a' : Char
#check 'Z' : Char
#check '0' : Char
#check '9' : Char

-- 特殊字符
#check ' ' : Char  -- 空格字符
#check '\t' : Char -- 制表符
#check '\n' : Char -- 换行符
#check '\r' : Char -- 回车符

-- 标点符号
#check '.' : Char
#check ',' : Char
#check '!' : Char
#check '?' : Char
#check ':' : Char
#check ';' : Char
```

### 字符类型检查 | Character Type Checking

```lean
-- 字符类型验证
def is_letter (c : Char) : Bool := c.isAlpha
def is_digit (c : Char) : Bool := c.isDigit
def is_whitespace (c : Char) : Bool := c.isWhitespace
def is_upper (c : Char) : Bool := c.isUpper
def is_lower (c : Char) : Bool := c.isLower

#check is_letter 'a'     -- true
#check is_letter '1'     -- false
#check is_digit '5'      -- true
#check is_digit 'a'      -- false
#check is_whitespace ' ' -- true
#check is_upper 'A'      -- true
#check is_lower 'a'      -- true
```

## 2. 转义字符 | Escape Characters

### 基本转义字符 | Basic Escape Characters

```lean
-- 换行符
#check '\n' : Char

-- 制表符
#check '\t' : Char

-- 回车符
#check '\r' : Char

-- 反斜杠
#check '\\' : Char

-- 单引号
#check '\'' : Char

-- 双引号
#check '\"' : Char

-- 空字符
#check '\0' : Char

-- 退格符
#check '\b' : Char

-- 换页符
#check '\f' : Char

-- 垂直制表符
#check '\v' : Char
```

### 数值转义字符 | Numeric Escape Characters

```lean
-- 八进制转义
#check '\101' : Char  -- 八进制101 = 十进制65 = 'A'
#check '\141' : Char  -- 八进制141 = 十进制97 = 'a'

-- 十六进制转义
#check '\x41' : Char  -- 十六进制41 = 十进制65 = 'A'
#check '\x61' : Char  -- 十六进制61 = 十进制97 = 'a'

-- Unicode转义
#check '\u0041' : Char  -- Unicode U+0041 = 'A'
#check '\u0061' : Char  -- Unicode U+0061 = 'a'
#check '\u03B1' : Char  -- Unicode U+03B1 = 'α' (希腊字母alpha)
```

## 3. 字符操作 | Character Operations

### 字符转换 | Character Conversion

```lean
-- 字符到ASCII码
def char_to_ascii (c : Char) : Nat := c.toNat
#check char_to_ascii 'A'  -- 65
#check char_to_ascii 'a'  -- 97
#check char_to_ascii '0'  -- 48

-- ASCII码到字符
def ascii_to_char (n : Nat) : Option Char :=
  if n < 128 then some (Char.ofNat n) else none
#check ascii_to_char 65  -- some 'A'
#check ascii_to_char 97  -- some 'a'
#check ascii_to_char 200 -- none (超出ASCII范围)

-- 大小写转换
def to_upper (c : Char) : Char := c.toUpper
def to_lower (c : Char) : Char := c.toLower

#check to_upper 'a'  -- 'A'
#check to_lower 'Z'  -- 'z'
```

### 字符比较 | Character Comparison

```lean
-- 字符相等
def chars_equal (c1 c2 : Char) : Bool := c1 = c2
#check chars_equal 'a' 'a'  -- true
#check chars_equal 'a' 'A'  -- false

-- 字符不等
def chars_not_equal (c1 c2 : Char) : Bool := c1 ≠ c2
#check chars_not_equal 'a' 'b'  -- true

-- 字符大小比较
def char_less_than (c1 c2 : Char) : Bool := c1 < c2
#check char_less_than 'a' 'b'  -- true
#check char_less_than 'A' 'a'  -- true (ASCII: 65 < 97)

-- 字符范围检查
def is_in_range (c : Char) (start end : Char) : Bool :=
  start ≤ c ∧ c ≤ end
#check is_in_range 'm' 'a' 'z'  -- true
#check is_in_range 'M' 'a' 'z'  -- false
```

## 4. 字符分类 | Character Classification

### 字母字符 | Alphabetic Characters

```lean
-- 检查是否为字母
def is_alphabetic (c : Char) : Bool := c.isAlpha
#check is_alphabetic 'a'  -- true
#check is_alphabetic 'A'  -- true
#check is_alphabetic '1'  -- false
#check is_alphabetic ' '  -- false

-- 检查是否为ASCII字母
def is_ascii_letter (c : Char) : Bool :=
  ('a' ≤ c ∧ c ≤ 'z') ∨ ('A' ≤ c ∧ c ≤ 'Z')
#check is_ascii_letter 'a'  -- true
#check is_ascii_letter 'α'  -- false (希腊字母)
```

### 数字字符 | Numeric Characters

```lean
-- 检查是否为数字
def is_numeric (c : Char) : Bool := c.isDigit
#check is_numeric '0'  -- true
#check is_numeric '9'  -- true
#check is_numeric 'a'  -- false

-- 检查是否为ASCII数字
def is_ascii_digit (c : Char) : Bool := '0' ≤ c ∧ c ≤ '9'
#check is_ascii_digit '5'  -- true
#check is_ascii_digit 'a'  -- false
```

### 空白字符 | Whitespace Characters

```lean
-- 检查是否为空白字符
def is_whitespace_char (c : Char) : Bool := c.isWhitespace
#check is_whitespace_char ' '   -- true
#check is_whitespace_char '\t'  -- true
#check is_whitespace_char '\n'  -- true
#check is_whitespace_char 'a'   -- false

-- 检查是否为空格
def is_space (c : Char) : Bool := c = ' '
#check is_space ' '  -- true
#check is_space '\t' -- false
```

## 5. 字符常量定义 | Character Constant Definitions

### 常用字符常量 | Common Character Constants

```lean
-- 空白字符
def SPACE : Char := ' '
def TAB : Char := '\t'
def NEWLINE : Char := '\n'
def CARRIAGE_RETURN : Char := '\r'

-- 标点符号
def PERIOD : Char := '.'
def COMMA : Char := ','
def EXCLAMATION : Char := '!'
def QUESTION : Char := '?'
def COLON : Char := ':'
def SEMICOLON : Char := ';'

-- 括号
def LEFT_PAREN : Char := '('
def RIGHT_PAREN : Char := ')'
def LEFT_BRACKET : Char := '['
def RIGHT_BRACKET : Char := ']'
def LEFT_BRACE : Char := '{'
def RIGHT_BRACE : Char := '}'
```

### ASCII字符常量 | ASCII Character Constants

```lean
-- 控制字符
def NULL_CHAR : Char := '\0'
def BACKSPACE : Char := '\b'
def FORM_FEED : Char := '\f'
def VERTICAL_TAB : Char := '\v'

-- 可打印ASCII字符范围
def ASCII_PRINTABLE_START : Char := ' '
def ASCII_PRINTABLE_END : Char := '~'

-- 数字字符
def DIGIT_ZERO : Char := '0'
def DIGIT_NINE : Char := '9'

-- 字母字符
def LETTER_A : Char := 'A'
def LETTER_Z : Char := 'Z'
def LETTER_a : Char := 'a'
def LETTER_z : Char := 'z'
```

## 6. 字符处理函数 | Character Processing Functions

### 字符验证 | Character Validation

```lean
-- 验证字符是否为有效标识符首字符
def is_valid_identifier_start (c : Char) : Bool :=
  c.isAlpha ∨ c = '_'

-- 验证字符是否为有效标识符字符
def is_valid_identifier_char (c : Char) : Bool :=
  c.isAlpha ∨ c.isDigit ∨ c = '_'

-- 验证字符是否为十六进制数字
def is_hex_digit (c : Char) : Bool :=
  ('0' ≤ c ∧ c ≤ '9') ∨ ('a' ≤ c ∧ c ≤ 'f') ∨ ('A' ≤ c ∧ c ≤ 'F')
```

### 字符转换函数 | Character Conversion Functions

```lean
-- 字符到数字转换
def char_to_digit (c : Char) : Option Nat :=
  if '0' ≤ c ∧ c ≤ '9' then
    some (c.toNat - '0'.toNat)
  else
    none

#check char_to_digit '5'  -- some 5
#check char_to_digit 'a'  -- none

-- 数字到字符转换
def digit_to_char (n : Nat) : Option Char :=
  if n < 10 then
    some (Char.ofNat (n + '0'.toNat))
  else
    none

#check digit_to_char 5  -- some '5'
#check digit_to_char 15 -- none
```

## 7. 字符在字符串中的应用 | Character Applications in Strings

### 字符串中的字符操作 | Character Operations in Strings

```lean
-- 检查字符串是否以特定字符开头
def starts_with_char (s : String) (c : Char) : Bool :=
  s.length > 0 ∧ s.get 0 = c

-- 检查字符串是否以特定字符结尾
def ends_with_char (s : String) (c : Char) : Bool :=
  s.length > 0 ∧ s.get (s.length - 1) = c

-- 计算字符串中特定字符的出现次数
def count_char (s : String) (c : Char) : Nat :=
  -- 这里需要实现字符计数逻辑
  -- 简化示例
  if s = "hello" ∧ c = 'l' then 2 else 0
```

### 字符过滤 | Character Filtering

```lean
-- 过滤字符串中的特定字符
def filter_chars (s : String) (pred : Char → Bool) : String :=
  -- 这里需要实现字符过滤逻辑
  -- 简化示例
  if s = "hello123" then "hello" else s

-- 移除空白字符
def remove_whitespace (s : String) : String :=
  filter_chars s (fun c => ¬c.isWhitespace)

-- 只保留字母字符
def keep_letters_only (s : String) : String :=
  filter_chars s (fun c => c.isAlpha)
```

## 8. 字符最佳实践 | Character Best Practices

### 性能优化 | Performance Optimization

```lean
-- 使用字符常量避免重复创建
def process_text (text : String) : String :=
  let space := ' '
  let newline := '\n'
  -- 使用预定义的字符常量
  text

-- 避免不必要的字符转换
def efficient_char_check (c : Char) : Bool :=
  c.isAlpha  -- 直接使用内置方法
```

### 可读性 | Readability

```lean
-- 使用有意义的字符常量名
def QUOTE_CHAR : Char := '"'
def APOSTROPHE_CHAR : Char := '\''
def BACKSLASH_CHAR : Char := '\\'

-- 使用描述性的函数名
def is_vowel (c : Char) : Bool :=
  c = 'a' ∨ c = 'e' ∨ c = 'i' ∨ c = 'o' ∨ c = 'u' ∨
  c = 'A' ∨ c = 'E' ∨ c = 'I' ∨ c = 'O' ∨ c = 'U'

def is_consonant (c : Char) : Bool :=
  c.isAlpha ∧ ¬is_vowel c
```

### 错误处理 | Error Handling

```lean
-- 安全的字符转换
def safe_char_to_ascii (c : Char) : Option Nat :=
  let ascii := c.toNat
  if ascii < 128 then some ascii else none

-- 验证字符范围
def validate_char_range (c : Char) (min max : Char) : Bool :=
  min ≤ c ∧ c ≤ max

-- 处理无效字符
def process_char_safely (c : Char) : String :=
  if c.isPrint then toString c else "[INVALID]"
```

---

*相关链接：*

- [字面量与常量总览](./01-总览.md)
- [字符串字面量详解](./03-字符串字面量详解.md)
- [数值字面量详解](./02-数值字面量详解.md)
