# 02-重写策略 | Rewrite Tactics

## 目录

- [02-重写策略 | Rewrite Tactics](#02-重写策略--rewrite-tactics)
  - [目录](#目录)
  - [1. 主题简介 | Topic Introduction](#1-主题简介--topic-introduction)
  - [2. 基本重写策略 | Basic Rewrite Tactics](#2-基本重写策略--basic-rewrite-tactics)
    - [2.1 rewrite策略 | rewrite Tactic](#21-rewrite策略--rewrite-tactic)
    - [2.2 simp策略 | simp Tactic](#22-simp策略--simp-tactic)
  - [3. 高级重写策略 | Advanced Rewrite Tactics](#3-高级重写策略--advanced-rewrite-tactics)
    - [3.1 rw策略 | rw Tactic](#31-rw策略--rw-tactic)
    - [3.2 erw策略 | erw Tactic](#32-erw策略--erw-tactic)
  - [4. 重写策略组合 | Combining Rewrite Tactics](#4-重写策略组合--combining-rewrite-tactics)
  - [5. 代码示例 | Code Examples](#5-代码示例--code-examples)
  - [6. 相关性与本地跳转 | Relevance \& Local Navigation](#6-相关性与本地跳转--relevance--local-navigation)

---

## 1. 主题简介 | Topic Introduction

本主题介绍Lean中的重写策略，包括rewrite、simp、rw等，这些是证明中最常用的策略之一。

This topic introduces rewrite tactics in Lean, including rewrite, simp, rw, etc., which are among the most commonly used tactics in proofs.

---

## 2. 基本重写策略 | Basic Rewrite Tactics

### 2.1 rewrite策略 | rewrite Tactic

- rewrite用于根据等式重写目标或假设。
- 支持正向和反向重写。

```lean
-- 基本rewrite示例
theorem add_zero (n : Nat) : n + 0 = n := by
  rewrite [Nat.add_zero]
  rfl

-- 反向重写
theorem zero_add (n : Nat) : 0 + n = n := by
  rewrite [←Nat.zero_add]
  rfl
```

### 2.2 simp策略 | simp Tactic

- simp是自动重写策略，使用简化规则。
- 可以指定使用的规则。

```lean
-- 基本simp示例
theorem simp_example (a b : Nat) : a + b + 0 = a + b := by
  simp

-- 指定规则的simp
theorem simp_with_rules (a b : Nat) : a + b + 0 = a + b := by
  simp [Nat.add_zero, Nat.add_assoc]
```

---

## 3. 高级重写策略 | Advanced Rewrite Tactics

### 3.1 rw策略 | rw Tactic

- rw是rewrite的简写形式。
- 支持多个规则同时应用。

```lean
-- 多个规则重写
theorem complex_rewrite (a b c : Nat) : 
  a + (b + c) = (a + b) + c := by
  rw [Nat.add_assoc]

-- 条件重写
theorem conditional_rewrite (n : Nat) (h : n > 0) : 
  n + 0 = n := by
  rw [Nat.add_zero]
  rfl
```

### 3.2 erw策略 | erw Tactic

- erw是exact rewrite的简写。
- 用于精确匹配的重写。

```lean
-- 精确重写示例
theorem exact_rewrite (a b : Nat) : a + b = b + a := by
  erw [Nat.add_comm]
  rfl
```

---

## 4. 重写策略组合 | Combining Rewrite Tactics

```lean
-- 策略组合示例
theorem combined_rewrite (a b c : Nat) : 
  (a + b) + c = a + (b + c) := by
  rw [Nat.add_assoc]
  rfl

-- 使用simp和rewrite组合
theorem mixed_tactics (a b : Nat) : 
  a + b + 0 + 0 = a + b := by
  simp [Nat.add_zero]
  rw [Nat.add_zero]
  rfl
```

---

## 5. 代码示例 | Code Examples

```lean
-- 重写策略完整示例
namespace RewriteExamples

-- 基本算术重写
theorem arithmetic_rewrites (a b c : Nat) : 
  a + b + c = c + b + a := by
  rw [Nat.add_comm a b]
  rw [Nat.add_comm (a + b) c]
  rw [Nat.add_comm b a]
  rfl

-- 使用simp的复杂证明
theorem complex_simp (xs : List Nat) : 
  (xs.map (λ x => x + 0)).length = xs.length := by
  simp [List.map_length]
  rw [Nat.add_zero]
  rfl

-- 条件重写
theorem conditional_rewrite_example (n : Nat) (h : n > 0) : 
  n * 1 = n := by
  rw [Nat.mul_one]
  rfl

-- 多步骤重写
theorem multi_step_rewrite (a b c d : Nat) : 
  (a + b) + (c + d) = (a + c) + (b + d) := by
  rw [Nat.add_assoc]
  rw [Nat.add_comm b c]
  rw [←Nat.add_assoc]
  rw [Nat.add_assoc]
  rfl

end RewriteExamples
```

---

## 6. 相关性与本地跳转 | Relevance & Local Navigation

- [返回上级目录](../01-总览.md)
- [证明策略详解总览](01-总览.md)
- [交互式证明环境](../02-交互式证明环境/01-总览.md)
- [形式化验证实践](../04-形式化验证实践/01-总览.md)

---

*最后更新时间：2025年1月*
*版本：1.0*
*状态：已完成*
