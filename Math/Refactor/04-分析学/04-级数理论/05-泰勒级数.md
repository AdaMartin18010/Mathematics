# 05-泰勒级数 (Taylor Series)

我们已经知道，幂级数在其收敛域内定义了一个具有良好性质的函数。现在，我们反过来问一个更深刻的问题：给定一个函数 $f(x)$，我们能否找到一个幂级数，使其和函数恰好就是 $f(x)$？

**泰勒级数**给出了这个问题的答案。它是将一个具有无限阶导数的函数展开成幂级数的系统性方法。

## 1. 从泰勒多项式到泰勒级数

回忆一下，在微分学中，我们用 **n阶泰勒多项式** $P_n(x)$ 来近似函数 $f(x)$：
$P_n(x) = \sum_{k=0}^{n} \frac{f^{(k)}(a)}{k!}(x-a)^k$

这个多项式与原函数 $f(x)$ 在点 $x=a$ 处具有相同的前n阶导数值。
$f(x) = P_n(x) + R_n(x)$，其中 $R_n(x)$ 是**余项**。

如果我们让阶数 $n$ 趋于无穷，这个泰勒多项式就变成了一个无穷级数。这个级数就被称为 $f(x)$ 在点 $a$ 处的**泰勒级数**。

**定义 (泰勒级数)**:
若函数 $f(x)$ 在点 $a$ 处存在任意阶导数，则我们称以下幂级数
$\sum_{n=0}^{\infty} \frac{f^{(n)}(a)}{n!}(x-a)^n = f(a) + f'(a)(x-a) + \frac{f''(a)}{2!}(x-a)^2 + \dots$
为 $f(x)$ 在 $x=a$ 处的泰勒级数。

特别地，当展开中心 $a=0$ 时，这个级数被称为**麦克劳林级数 (Maclaurin Series)**。

## 2. 函数何时等于其泰勒级数？

构造出一个函数的泰勒级数是一回事，但这个级数在它的收敛域内是否真的等于原函数 $f(x)$ 呢？

答案是：**不一定**。

要使 $f(x)$ 等于它的泰勒级数，即 $f(x) = \sum_{n=0}^{\infty} \frac{f^{(n)}(a)}{n!}(x-a)^n$，这等价于要求泰勒公式中的余项 $R_n(x)$ 在 $n \to \infty$ 时极限为0。
$f(x) = \lim_{n \to \infty} P_n(x) \quad \iff \quad \lim_{n \to \infty} R_n(x) = 0$

**泰勒定理**:
如果在一个包含 $a$ 的开区间 $I$ 上，$\lim_{n \to \infty} R_n(x) = 0$，那么对于所有 $x \in I$，函数 $f(x)$ 就等于它自身的泰勒级数展开。

幸运的是，对于绝大多数我们遇到的"表现良好"的函数（如 $e^x, \sin x, \cos x, \ln(1+x)$ 等），这个条件都是满足的。

## 3. 重要的麦克劳林级数

这些是分析学中最重要、最常用的函数展开式，是进行近似计算、理论推导和解决问题的基础。

| 函数 | 麦克劳林级数 | 收敛区间 |
| :--- | :--- | :--- |
| $e^x$ | $\sum_{n=0}^{\infty} \frac{x^n}{n!} = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \dots$ | $(-\infty, \infty)$ |
| $\sin x$ | $\sum_{n=0}^{\infty} \frac{(-1)^n x^{2n+1}}{(2n+1)!} = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \dots$ | $(-\infty, \infty)$ |
| $\cos x$ | $\sum_{n=0}^{\infty} \frac{(-1)^n x^{2n}}{(2n)!} = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \dots$ | $(-\infty, \infty)$ |
| $\ln(1+x)$ | $\sum_{n=1}^{\infty} \frac{(-1)^{n-1} x^n}{n} = x - \frac{x^2}{2} + \frac{x^3}{3} - \dots$ | $(-1, 1]$ |
| $\arctan x$ | $\sum_{n=0}^{\infty} \frac{(-1)^n x^{2n+1}}{2n+1} = x - \frac{x^3}{3} + \frac{x^5}{5} - \dots$ | $[-1, 1]$ |
| $(1+x)^k$ (二项式级数) | $1 + kx + \frac{k(k-1)}{2!}x^2 + \dots = \sum_{n=0}^{\infty} \binom{k}{n} x^n$ | $(-1, 1)$ |

## 4. 应用

将函数展开为泰勒级数（幂级数）是分析学中最强大的技术之一。

1. **近似计算**: 对于复杂的函数值，我们可以取其泰勒级数的前几项来进行高精度近似。例如，计算 $e^{0.1}$ 或 $\sin(0.2)$。
2. **计算极限**: 遇到复杂的未定式时，将函数替换为其泰勒级数可以使问题大大简化。
3. **计算积分**: 对于一些不存在初等函数原函数的被积函数（如 $e^{-x^2}$），我们可以将其展开为泰勒级数，然后进行逐项积分，从而得到一个级数形式的答案。
4. **求解微分方程**: 假设微分方程的解可以表示为一个幂级数，通过待定系数法可以求出解的级数形式。
5. **欧拉公式**: $e^{ix} = \cos x + i \sin x$ 这个连接复指数与三角函数的"上帝公式"，可以通过将三者分别展开为麦克劳林级数来得到最直观、最深刻的证明。比较三者的级数，可以发现它们完美地吻合。
