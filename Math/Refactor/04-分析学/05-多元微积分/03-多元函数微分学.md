# 03-多元函数微分学

## 1. 导言：如何在多维空间中衡量"变化"？

在一元微积分中，"变化率"的概念是明确的：就是函数 \( f(x) \) 在某一点的导数 \( f'(x) \)。然而，对于一个多元函数，例如描述山体海拔的 \( z = f(x, y) \)，其"变化率"取决于你前进的**方向**。朝正东方向（x轴正向）走，坡度可能很平缓；但朝正北方向（y轴正向）走，可能就是悬崖峭壁。

本节的核心任务，就是建立一套完整的理论来描述多元函数在任意方向上的变化。我们将从最简单的**偏导数**（沿坐标轴的变化率）开始，然后引入**全微分**的概念，它为函数在一点附近提供了一个切平面作为线性近似，是"可微性"的真正体现。最终，我们将引出**方向导数**和**梯度**，它们完美地回答了"在某点沿任意方向的变化率是多少？"以及"哪个方向的变化率最大？"这两个核心问题。

---

## 2. 偏导数 (Partial Derivatives)

#### 2.1 定义与计算

对于函数 \( z = f(x, y) \)，它在点 \( (x_0, y_0) \) 处对 \( x \) 的偏导数定义为：
\[ \frac{\partial f}{\partial x} \bigg|_{(x_0, y_0)} = \lim_{\Delta x \to 0} \frac{f(x_0 + \Delta x, y_0) - f(x_0, y_0)}{\Delta x} \]
**计算方法**: 在求对某个变量（如 \( x \)）的偏导数时，只需将所有其他变量（如 \( y \)）**视为常数**，然后像一元函数一样进行求导。

**常用记号**: \( \frac{\partial z}{\partial x}, f_x(x, y), D_1 f \)

#### 2.2 几何意义

- \( \frac{\partial f}{\partial x}(x_0, y_0) \) 的几何意义是：曲面 \( z = f(x, y) \) 被平面 \( y = y_0 \) 所截得的曲线，在点 \( P_0(x_0, y_0, f(x_0, y_0)) \) 处的切线对 x 轴的斜率。
- \( \frac{\partial f}{\partial y}(x_0, y_0) \) 的几何意义同理，是曲面被平面 \( x = x_0 \) 所截曲线的切线斜率。
![偏导数的几何意义](https://wiki.ubc.ca/images/thumb/3/33/M200_Partial_Derivatives_Fig1.png/400px-M200_Partial_Derivatives_Fig1.png)

<center>（图片来源：UBC Wiki）</center>

#### 2.3 高阶偏导数与克莱罗定理

我们可以对偏导数继续求偏导，得到高阶偏导数，如 \( f_{xx}, f_{yy}, f_{xy}, f_{yx} \)。
**克莱罗定理 (Clairaut's Theorem)**: 如果二阶混合偏导数 \( f_{xy} \) 和 \( f_{yx} \) 在某点附近是连续的，那么在该点它们的值必然相等：
\[ f_{xy}(x_0, y_0) = f_{yx}(x_0, y_0) \]
这意味着求导次序在一定条件下可以交换。

---

## 3. 全微分与可微性 (Total Differential & Differentiability)

偏导数只反映了沿坐标轴方向的变化，信息是不全面的。我们需要一个工具来近似函数在一点附近任意方向上的**总体变化**。

#### 3.1 可微性的定义

设函数 \( z = f(x, y) \) 在点 \( (x_0, y_0) \) 的某邻域内有定义。如果函数的全增量 \( \Delta z = f(x_0 + \Delta x, y_0 + \Delta y) - f(x_0, y_0) \) 可以表示为：
\[ \Delta z = A \Delta x + B \Delta y + o(\rho) \]
其中 \( A, B \) 是不依赖于 \( \Delta x, \Delta y \) 的常数，\( \rho = \sqrt{(\Delta x)^2 + (\Delta y)^2} \)，且 \( o(\rho) \) 是比 \( \rho \)更高阶的无穷小（即 \( \lim_{\rho \to 0} \frac{o(\rho)}{\rho} = 0 \)），那么称函数 \( f \) 在点 \( (x_0, y_0) \) **可微**。

线性主部 \( A \Delta x + B \Delta y \) 称为函数在点 \( (x_0, y_0) \) 的**全微分**，记作 \( dz \)。如果函数可微，则必有 \( A = f_x(x_0, y_0) \) 和 \( B = f_y(x_0, y_0) \)。因此：
\[ dz = \frac{\partial f}{\partial x} dx + \frac{\partial f}{\partial y} dy \]

#### 3.2 几何意义

函数在一点可微，几何上等价于曲面 \( z=f(x,y) \) 在该点处存在一个**切平面 (Tangent Plane)**。全微分 \( dz \) 就是当自变量发生微小变化时，函数值在切平面上的增量，它是函数真实增量 \( \Delta z \) 的**线性主部近似**。

#### 3.3 可微、连续、偏导数存在的关系

这是一个核心理论点，辨析三者关系至关重要：

- **可微 \(\implies\) 连续**: 如果函数在一点可微，它在该点必然连续。
- **可微 \(\implies\) 偏导数存在**: 如果函数在一点可微，它在该点对各个变量的偏导数必然存在。
- **反之不成立！** 连续不一定可微，偏导数存在也不一定可微。
- **可微性的充分条件**: 如果函数 \( f(x, y) \) 的两个偏导数 \( f_x \) 和 \( f_y \) 在点 \( (x_0, y_0) \) 的某个邻域内存在，并且在 \( (x_0, y_0) \) **这一点是连续的**，那么函数 \( f \) 在该点**必定可微**。这是实践中最常用的判据。

---

## 4. 链式法则 (The Chain Rule)

当函数是复合构成时，链式法则提供了计算导数的系统方法。

- **情形一**: \( z = f(x, y) \), 而 \( x = x(t), y = y(t) \)。此时 \( z \) 是 \( t \) 的一元函数。
    \[ \frac{dz}{dt} = \frac{\partial f}{\partial x} \frac{dx}{dt} + \frac{\partial f}{\partial y} \frac{dy}{dt} \]
- **情形二 (一般形式)**: \( z = f(x, y) \), 而 \( x = x(u, v), y = y(u, v) \)。此时 \( z \) 是 \( u, v \) 的多元函数。
    \[ \frac{\partial z}{\partial u} = \frac{\partial f}{\partial x} \frac{\partial x}{\partial u} + \frac{\partial f}{\partial y} \frac{\partial y}{\partial u} \]
    \[ \frac{\partial z}{\partial v} = \frac{\partial f}{\partial x} \frac{\partial x}{\partial v} + \frac{\partial f}{\partial y} \frac{\partial y}{\partial v} \]
使用"树状图"可以非常清晰地帮助记忆和理解多元复合函数的链式法则。

---

## 5. 方向导数与梯度 (Directional Derivative & Gradient)

#### 5.1 方向导数

**方向导数** \( D_{\vec{u}}f \) 衡量了函数 \( f \) 在某点 \( P_0 \) 沿着一个特定的**单位向量** \( \vec{u} \) 方向的变化率。
如果 \( f \) 可微，其计算公式为：
\[ D_{\vec{u}}f(P_0) = f_x(P_0) u_1 + f_y(P_0) u_2 \]
其中 \( \vec{u} = (u_1, u_2) \) 是方向单位向量。

#### 5.2 梯度

**梯度 (Gradient)** 是一个非常核心的概念，它是一个向量，由函数对各个自变量的偏导数构成：
\[ \nabla f = \text{grad} f = \left( \frac{\partial f}{\partial x}, \frac{\partial f}{\partial y} \right) \]
利用梯度，方向导数的公式可以更优雅地写成**梯度与方向向量的点积**:
\[ D_{\vec{u}}f = \nabla f \cdot \vec{u} \]

#### 5.3 梯度的几何意义

梯度向量 \( \nabla f \) 在一点的几何意义是：

1. **方向**: 梯度向量**指向函数 \( f \) 在该点增长最快的方向**。
2. **大小**: 梯度向量的模 \( \|\nabla f\| \) 就是这个最大增长率的值，即所有方向导数中的最大值。
3. **正交性**: 梯度向量 \( \nabla f(P_0) \) 与函数 \( f \) 过 \( P_0 \) 点的**等值线（面）**在该点是**正交（垂直）**的。

梯度概念的引入，完美地回答了本节开头提出的问题，是优化理论（如梯度下降法）的绝对基石。
