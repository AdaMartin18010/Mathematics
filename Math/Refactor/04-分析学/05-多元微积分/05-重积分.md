# 05-重积分的计算

## 1. 导言：从“是什么”到“怎么算”

在上一节中，我们建立了重积分的直观概念——它是对高维区域上函数值的“累加”，可以表示体积或质量。现在，我们面临一个更实际的问题：**如何精确地计算出它的值？**

直接使用黎曼和的定义来计算几乎是不可能的。本节的核心思想，是通过一种名为**累次积分 (Iterated Integral)** 的技术，巧妙地将一个复杂的**重积分**（如二重、三重积分）“降维”打击，转化为我们熟悉的一元定积分的嵌套计算。

我们将学习支撑这一转化的核心理论——**傅比尼定理**，并掌握在不同形状的积分区域上，如何正确设定积分的上下限。最后，我们将介绍通过**变量替换**（尤其是在极坐标、柱坐标和球坐标系中）来简化计算的强大技术，其中**雅可比行列式 (Jacobian)** 将扮演关键角色。

---

## 2. 二重积分的计算

#### 2.1 傅比尼定理与累次积分

**傅比尼定理 (Fubini's Theorem)** 是计算重积分的理论基石。它指出：如果函数 \( f(x, y) \) 在一个矩形区域 \( D = [a, b] \times [c, d] \) 上是连续的，那么其二重积分可以表示为两种顺序的累次积分：
\[ \iint_D f(x, y) \,dA = \int_a^b \left[ \int_c^d f(x, y) \,dy \right] dx = \int_c^d \left[ \int_a^b f(x, y) \,dx \right] dy \]
**核心操作**：先对内层积分，例如 \( \int_c^d f(x, y) \,dy \)，此时将 \( x \) 暂时视为常数，对 \( y \) 进行积分。得到的结果是一个只含 \( x \) 的函数，再对这个函数进行外层积分 \( \int_a^b \dots dx \)。

#### 2.2 在一般区域上的计算

对于非矩形的一般区域，选择正确的积分次序和设定积分限是关键。

- **X-型区域 (垂直简单区域)**: \( D = \{ (x, y) \mid a \le x \le b, g_1(x) \le y \le g_2(x) \} \)
    此时积分次序必须是 \( dy\,dx \)：
    \[ \iint_D f(x, y) \,dA = \int_a^b \int_{g_1(x)}^{g_2(x)} f(x, y) \,dy \,dx \]
    直观上，是先沿垂直方向（y轴方向）从下边界曲线 \( g_1(x) \) 累加到上边界曲线 \( g_2(x) \)，形成一个“截面”，然后再沿水平方向（x轴方向）将所有“截面”累加起来。

- **Y-型区域 (水平简单区域)**: \( D = \{ (x, y) \mid c \le y \le d, h_1(y) \le x \le h_2(y) \} \)
    此时积分次序必须是 \( dx\,dy \)：
    \[ \iint_D f(x, y) \,dA = \int_c^d \int_{h_1(y)}^{h_2(y)} f(x, y) \,dx \,dy \]

**技巧**：面对一个区域，需要判断它更适合被描述为X-型还是Y-型，有时甚至需要将复杂区域切分成几个简单区域分别积分。

---

## 3. 二重积分的变量替换

#### 3.1 核心思想与雅可比行列式

当积分区域是圆形、环形或扇形时，使用直角坐标会非常麻烦。**变量替换**（或称**坐标变换**）是解决这类问题的利器。
从坐标系 \( (x, y) \) 变换到新坐标系 \( (u, v) \)，其中 \( x = x(u, v), y = y(u, v) \)。关键问题是，面积微元 \( dA = dx\,dy \) 在新坐标系下变成了什么？
答案由**雅可比行列式 (Jacobian Determinant)** 给出：
\[ J(u, v) = \frac{\partial(x, y)}{\partial(u, v)} = \det \begin{pmatrix} \frac{\partial x}{\partial u} & \frac{\partial x}{\partial v} \\ \frac{\partial y}{\partial u} & \frac{\partial y}{\partial v} \end{pmatrix} = \frac{\partial x}{\partial u}\frac{\partial y}{\partial v} - \frac{\partial x}{\partial v}\frac{\partial y}{\partial u} \]
面积微元的关系是 \( dA = |J(u, v)| \,du\,dv \)。
二重积分的变量替换公式为：
\[ \iint_D f(x, y) \,dx\,dy = \iint_{D^*} f(x(u, v), y(u, v)) |J(u, v)| \,du\,dv \]
其中 \( D^* \) 是原区域 \( D \) 在 \( uv \)-平面上的对应区域。

#### 3.2 极坐标变换

这是最重要的变量替换实例。

- **变换关系**: \( x = r \cos\theta, y = r \sin\theta \)
- **雅可比行列式**: \( J = r \)
- **面积微元**: \( dA = dx\,dy = r \,dr\,d\theta \)
- **应用**: 计算在圆形或扇形区域上的二重积分时，转换为极坐标会极大简化积分限的设定。

---

## 4. 三重积分的计算

三重积分的计算原理与二重积分完全相同，只是增加了一个维度。

#### 4.1 直角坐标系下的累次积分

同样通过傅比尼定理，将三重积分化为三次单积分的嵌套。例如，对于区域 \( V = \{ (x,y,z) \mid (x,y) \in D, u_1(x,y) \le z \le u_2(x,y) \} \)，计算顺序为：
\[ \iiint_V f(x, y, z) \,dV = \iint_D \left[ \int_{u_1(x,y)}^{u_2(x,y)} f(x, y, z) \,dz \right] dA \]

#### 4.2 柱坐标变换 (Cylindrical Coordinates)

- **适用场景**: 积分区域具有绕某一直线的旋转对称性，例如圆柱体、圆锥体、抛物旋转体。
- **变换关系**: \( x = r \cos\theta, y = r \sin\theta, z = z \)
- **体积微元**: \( dV = r \,dz\,dr\,d\theta \)

#### 4.3 球坐标变换 (Spherical Coordinates)

- **适用场景**: 积分区域具有绕某一点的中心对称性，例如球体、球壳、锥体。
- **变换关系**: \( x = \rho \sin\phi \cos\theta, y = \rho \sin\phi \sin\theta, z = \rho \cos\phi \)
  - \( \rho \): 到原点的距离
  - \( \phi \): 与正 z 轴的夹角（天顶角）
  - \( \theta \): 在 xy-平面上的投影与正 x 轴的夹角（方位角）
- **体积微元**: \( dV = \rho^2 \sin\phi \,d\rho\,d\phi\,d\theta \)

## 5. 总结

计算重积分的核心策略是将其**转化为累次积分**。其中，最关键的两个步骤是：

1. 根据积分区域的形状，**正确地确定积分的次序和上下限**。
2. 对于具有对称性的区域（如圆形、球形），果断**采用合适的坐标系**（极坐标、柱坐标、球坐标）进行变量替换，以简化积分限和被积函数。
