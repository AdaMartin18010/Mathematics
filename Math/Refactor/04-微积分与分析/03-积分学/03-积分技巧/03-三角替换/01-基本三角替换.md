# 基本三角替换

## 目录

1. [基本概念](#基本概念)
2. [正弦替换](#正弦替换)
3. [正切替换](#正切替换)
4. [正割替换](#正割替换)
5. [特殊情况处理](#特殊情况处理)
6. [应用实例](#应用实例)
7. [代码实现](#代码实现)
8. [相关文件](#相关文件)

## 基本概念

### 定义

基本三角替换是微积分中最常用的积分技巧之一，通过引入三角函数变量来简化含有根式或二次式的积分。

### 核心思想

利用三角函数的恒等式和性质，将复杂的代数表达式转化为更简单的三角函数表达式，从而简化积分计算。

### 基本原理

1. **勾股定理**：$a^2 + b^2 = c^2$
2. **三角恒等式**：$\sin^2\theta + \cos^2\theta = 1$, $1 + \tan^2\theta = \sec^2\theta$
3. **反三角函数**：$\arcsin$, $\arccos$, $\arctan$

## 正弦替换

### 基本形式

对于 $\sqrt{a^2 - x^2}$ 形式的表达式：

$$x = a\sin\theta, \quad dx = a\cos\theta d\theta$$

$$\sqrt{a^2 - x^2} = a\cos\theta$$

### 理论证明

**定理**：设 $x = a\sin\theta$，则 $\sqrt{a^2 - x^2} = a\cos\theta$

**证明**：

1. 根据正弦替换：$x = a\sin\theta$
2. 代入表达式：$\sqrt{a^2 - x^2} = \sqrt{a^2 - a^2\sin^2\theta}$
3. 提取公因子：$= \sqrt{a^2(1 - \sin^2\theta)}$
4. 使用三角恒等式：$= \sqrt{a^2\cos^2\theta}$
5. 简化：$= a\cos\theta$

### 应用范围

#### 1. 基本积分

$$\int \frac{dx}{\sqrt{a^2 - x^2}} = \arcsin\left(\frac{x}{a}\right) + C$$

**证明**：

1. 设 $x = a\sin\theta$，则 $dx = a\cos\theta d\theta$
2. 代入积分：$\int \frac{a\cos\theta d\theta}{\sqrt{a^2 - a^2\sin^2\theta}}$
3. 简化：$= \int \frac{a\cos\theta d\theta}{a\cos\theta}$
4. 进一步简化：$= \int d\theta = \theta + C$
5. 回代：$= \arcsin\left(\frac{x}{a}\right) + C$

#### 2. 幂函数积分

$$\int x^n \sqrt{a^2 - x^2} dx$$

**方法**：

1. 设 $x = a\sin\theta$，则 $dx = a\cos\theta d\theta$
2. 代入：$\int a^n\sin^n\theta \cdot a\cos\theta \cdot a\cos\theta d\theta$
3. 简化：$= a^{n+2} \int \sin^n\theta \cos^2\theta d\theta$
4. 使用三角恒等式：$= a^{n+2} \int \sin^n\theta (1 - \sin^2\theta) d\theta$
5. 展开：$= a^{n+2} \int (\sin^n\theta - \sin^{n+2}\theta) d\theta$

#### 3. 有理函数积分

$$\int \frac{P(x)}{\sqrt{a^2 - x^2}} dx$$

**方法**：

1. 设 $x = a\sin\theta$，则 $dx = a\cos\theta d\theta$
2. 将 $P(x)$ 展开为 $\sin\theta$ 的多项式
3. 利用三角恒等式简化
4. 逐项积分

### 特殊情况

#### 1. 常数项处理

当积分中含有常数项时，需要调整替换：

$$\int \frac{dx}{\sqrt{a^2 - (x-b)^2}}$$

**方法**：

1. 设 $u = x - b$，则 $du = dx$
2. 积分变为：$\int \frac{du}{\sqrt{a^2 - u^2}}$
3. 应用正弦替换：$u = a\sin\theta$

#### 2. 系数处理

当根式前有系数时：

$$\int \frac{dx}{\sqrt{b^2 - a^2x^2}}$$

**方法**：

1. 提取系数：$= \frac{1}{a} \int \frac{dx}{\sqrt{\left(\frac{b}{a}\right)^2 - x^2}}$
2. 应用正弦替换：$x = \frac{b}{a}\sin\theta$

## 正切替换

### 基本形式

对于 $\sqrt{a^2 + x^2}$ 形式的表达式：

$$x = a\tan\theta, \quad dx = a\sec^2\theta d\theta$$

$$\sqrt{a^2 + x^2} = a\sec\theta$$

### 理论证明

**定理**：设 $x = a\tan\theta$，则 $\sqrt{a^2 + x^2} = a\sec\theta$

**证明**：

1. 根据正切替换：$x = a\tan\theta$
2. 代入表达式：$\sqrt{a^2 + x^2} = \sqrt{a^2 + a^2\tan^2\theta}$
3. 提取公因子：$= \sqrt{a^2(1 + \tan^2\theta)}$
4. 使用三角恒等式：$= \sqrt{a^2\sec^2\theta}$
5. 简化：$= a\sec\theta$

### 应用范围

#### 1. 基本积分

$$\int \frac{dx}{\sqrt{a^2 + x^2}} = \ln\left|x + \sqrt{a^2 + x^2}\right| + C$$

**证明**：

1. 设 $x = a\tan\theta$，则 $dx = a\sec^2\theta d\theta$
2. 代入积分：$\int \frac{a\sec^2\theta d\theta}{\sqrt{a^2 + a^2\tan^2\theta}}$
3. 简化：$= \int \frac{a\sec^2\theta d\theta}{a\sec\theta}$
4. 进一步简化：$= \int \sec\theta d\theta$
5. 积分结果：$= \ln|\sec\theta + \tan\theta| + C$
6. 回代：$= \ln\left|\frac{\sqrt{a^2 + x^2}}{a} + \frac{x}{a}\right| + C$
7. 简化：$= \ln\left|x + \sqrt{a^2 + x^2}\right| + C$

#### 2. 幂函数积分

$$\int x^n \sqrt{a^2 + x^2} dx$$

**方法**：

1. 设 $x = a\tan\theta$，则 $dx = a\sec^2\theta d\theta$
2. 代入：$\int a^n\tan^n\theta \cdot a\sec\theta \cdot a\sec^2\theta d\theta$
3. 简化：$= a^{n+2} \int \tan^n\theta \sec^3\theta d\theta$
4. 使用递推公式或分部积分

#### 3. 有理函数积分

$$\int \frac{P(x)}{\sqrt{a^2 + x^2}} dx$$

**方法**：

1. 设 $x = a\tan\theta$，则 $dx = a\sec^2\theta d\theta$
2. 将 $P(x)$ 展开为 $\tan\theta$ 的多项式
3. 利用三角恒等式简化
4. 逐项积分

### 特殊情况

#### 1. 常数项处理

$$\int \frac{dx}{\sqrt{a^2 + (x-b)^2}}$$

**方法**：

1. 设 $u = x - b$，则 $du = dx$
2. 积分变为：$\int \frac{du}{\sqrt{a^2 + u^2}}$
3. 应用正切替换：$u = a\tan\theta$

#### 2. 系数处理

$$\int \frac{dx}{\sqrt{b^2 + a^2x^2}}$$

**方法**：

1. 提取系数：$= \frac{1}{a} \int \frac{dx}{\sqrt{\left(\frac{b}{a}\right)^2 + x^2}}$
2. 应用正切替换：$x = \frac{b}{a}\tan\theta$

## 正割替换

### 基本形式

对于 $\sqrt{x^2 - a^2}$ 形式的表达式：

$$x = a\sec\theta, \quad dx = a\sec\theta\tan\theta d\theta$$

$$\sqrt{x^2 - a^2} = a\tan\theta$$

### 理论证明

**定理**：设 $x = a\sec\theta$，则 $\sqrt{x^2 - a^2} = a\tan\theta$

**证明**：

1. 根据正割替换：$x = a\sec\theta$
2. 代入表达式：$\sqrt{x^2 - a^2} = \sqrt{a^2\sec^2\theta - a^2}$
3. 提取公因子：$= \sqrt{a^2(\sec^2\theta - 1)}$
4. 使用三角恒等式：$= \sqrt{a^2\tan^2\theta}$
5. 简化：$= a\tan\theta$

### 应用范围

#### 1. 基本积分

$$\int \frac{dx}{\sqrt{x^2 - a^2}} = \ln\left|x + \sqrt{x^2 - a^2}\right| + C$$

**证明**：

1. 设 $x = a\sec\theta$，则 $dx = a\sec\theta\tan\theta d\theta$
2. 代入积分：$\int \frac{a\sec\theta\tan\theta d\theta}{\sqrt{a^2\sec^2\theta - a^2}}$
3. 简化：$= \int \frac{a\sec\theta\tan\theta d\theta}{a\tan\theta}$
4. 进一步简化：$= \int \sec\theta d\theta$
5. 积分结果：$= \ln|\sec\theta + \tan\theta| + C$
6. 回代：$= \ln\left|\frac{x}{a} + \frac{\sqrt{x^2 - a^2}}{a}\right| + C$
7. 简化：$= \ln\left|x + \sqrt{x^2 - a^2}\right| + C$

#### 2. 幂函数积分

$$\int x^n \sqrt{x^2 - a^2} dx$$

**方法**：

1. 设 $x = a\sec\theta$，则 $dx = a\sec\theta\tan\theta d\theta$
2. 代入：$\int a^n\sec^n\theta \cdot a\tan\theta \cdot a\sec\theta\tan\theta d\theta$
3. 简化：$= a^{n+2} \int \sec^{n+1}\theta \tan^2\theta d\theta$
4. 使用递推公式或分部积分

#### 3. 有理函数积分

$$\int \frac{P(x)}{\sqrt{x^2 - a^2}} dx$$

**方法**：

1. 设 $x = a\sec\theta$，则 $dx = a\sec\theta\tan\theta d\theta$
2. 将 $P(x)$ 展开为 $\sec\theta$ 的多项式
3. 利用三角恒等式简化
4. 逐项积分

### 特殊情况

#### 1. 常数项处理

$$\int \frac{dx}{\sqrt{(x-b)^2 - a^2}}$$

**方法**：

1. 设 $u = x - b$，则 $du = dx$
2. 积分变为：$\int \frac{du}{\sqrt{u^2 - a^2}}$
3. 应用正割替换：$u = a\sec\theta$

#### 2. 系数处理

$$\int \frac{dx}{\sqrt{a^2x^2 - b^2}}$$

**方法**：

1. 提取系数：$= \frac{1}{a} \int \frac{dx}{\sqrt{x^2 - \left(\frac{b}{a}\right)^2}}$
2. 应用正割替换：$x = \frac{b}{a}\sec\theta$

## 特殊情况处理

### 1. 复合根式

对于 $\sqrt{\sqrt{a^2 - x^2}}$ 形式的表达式：

**方法**：

1. 先进行内层替换：$x = a\sin\theta$
2. 得到：$\sqrt{a\cos\theta}$
3. 进一步处理

### 2. 多重根式

对于 $\sqrt{a^2 - x^2} + \sqrt{b^2 - x^2}$ 形式的表达式：

**方法**：

1. 分别进行替换
2. 合并结果
3. 简化表达式

### 3. 参数化处理

对于含有参数的表达式：

$$\int \frac{dx}{\sqrt{a^2 - b^2x^2}}$$

**方法**：

1. 提取参数：$= \frac{1}{b} \int \frac{dx}{\sqrt{\left(\frac{a}{b}\right)^2 - x^2}}$
2. 应用正弦替换：$x = \frac{a}{b}\sin\theta$

## 应用实例

### 1. 物理学应用

#### 1.1 振动问题

**问题**：计算单摆的周期积分

$$\int_0^{\theta_0} \frac{d\theta}{\sqrt{\cos\theta - \cos\theta_0}}$$

**解法**：

1. 使用三角替换：$\cos\theta = 1 - 2\sin^2\frac{\theta}{2}$
2. 设 $k = \sin\frac{\theta_0}{2}$，$u = \frac{\sin\frac{\theta}{2}}{k}$
3. 积分转化为椭圆积分

#### 1.2 能量计算

**问题**：计算重力势能积分

$$\int_0^h \sqrt{2g(h-x)} dx$$

**解法**：

1. 设 $u = h - x$，则 $du = -dx$
2. 积分变为：$-\int_h^0 \sqrt{2gu} du$
3. 使用幂函数积分公式

### 2. 工程应用

#### 2.1 信号处理

**问题**：计算滤波器传递函数

$$\int \frac{dx}{\sqrt{1-x^2}}$$

**解法**：

1. 直接应用正弦替换：$x = \sin\theta$
2. 积分结果：$\arcsin x + C$

#### 2.2 控制系统

**问题**：计算状态方程积分

$$\int \frac{x dx}{\sqrt{x^2 + 1}}$$

**解法**：

1. 设 $u = x^2 + 1$，则 $du = 2x dx$
2. 积分变为：$\frac{1}{2} \int \frac{du}{\sqrt{u}}$
3. 结果：$\sqrt{x^2 + 1} + C$

### 3. 经济学应用

#### 3.1 金融数学

**问题**：计算期权定价积分

$$\int \frac{dx}{\sqrt{1-x^2}}$$

**解法**：

1. 应用正弦替换：$x = \sin\theta$
2. 积分结果：$\arcsin x + C$

#### 3.2 风险计算

**问题**：计算风险度量积分

$$\int \frac{x dx}{\sqrt{1-x^2}}$$

**解法**：

1. 设 $u = 1 - x^2$，则 $du = -2x dx$
2. 积分变为：$-\frac{1}{2} \int \frac{du}{\sqrt{u}}$
3. 结果：$-\sqrt{1-x^2} + C$

## 代码实现

### Rust实现

```rust
use std::f64::consts::PI;

/// 三角替换积分计算器
pub struct TrigonometricSubstitution;

impl TrigonometricSubstitution {
    /// 正弦替换积分
    pub fn sine_substitution(a: f64, x: f64) -> f64 {
        if x.abs() > a {
            panic!("Invalid input: |x| must be <= a for sine substitution");
        }
        
        let theta = (x / a).asin();
        theta
    }
    
    /// 正切替换积分
    pub fn tangent_substitution(a: f64, x: f64) -> f64 {
        let theta = (x / a).atan();
        theta
    }
    
    /// 正割替换积分
    pub fn secant_substitution(a: f64, x: f64) -> f64 {
        if x.abs() < a {
            panic!("Invalid input: |x| must be >= a for secant substitution");
        }
        
        let theta = (x / a).acos();
        theta
    }
    
    /// 计算基本积分 ∫dx/√(a²-x²)
    pub fn basic_sine_integral(a: f64, x: f64) -> f64 {
        Self::sine_substitution(a, x)
    }
    
    /// 计算基本积分 ∫dx/√(a²+x²)
    pub fn basic_tangent_integral(a: f64, x: f64) -> f64 {
        ((x + (a * a + x * x).sqrt()) / a).ln()
    }
    
    /// 计算基本积分 ∫dx/√(x²-a²)
    pub fn basic_secant_integral(a: f64, x: f64) -> f64 {
        ((x + (x * x - a * a).sqrt()) / a).ln()
    }
}

#[cfg(test)]
mod tests {
    use super::*;
    
    #[test]
    fn test_sine_substitution() {
        let result = TrigonometricSubstitution::basic_sine_integral(1.0, 0.5);
        assert!((result - 0.5235987755982988).abs() < 1e-10);
    }
    
    #[test]
    fn test_tangent_substitution() {
        let result = TrigonometricSubstitution::basic_tangent_integral(1.0, 1.0);
        assert!((result - 0.881373587019543).abs() < 1e-10);
    }
    
    #[test]
    fn test_secant_substitution() {
        let result = TrigonometricSubstitution::basic_secant_integral(1.0, 2.0);
        assert!((result - 1.3169578969248166).abs() < 1e-10);
    }
}
```

### Haskell实现

```haskell
module TrigonometricSubstitution where

import Data.Complex

-- 三角替换积分计算器
data TrigonometricSubstitution = TrigonometricSubstitution

-- 正弦替换积分
sineSubstitution :: Double -> Double -> Double
sineSubstitution a x
  | abs x > a = error "Invalid input: |x| must be <= a for sine substitution"
  | otherwise = asin (x / a)

-- 正切替换积分
tangentSubstitution :: Double -> Double -> Double
tangentSubstitution a x = atan (x / a)

-- 正割替换积分
secantSubstitution :: Double -> Double -> Double
secantSubstitution a x
  | abs x < a = error "Invalid input: |x| must be >= a for secant substitution"
  | otherwise = acos (x / a)

-- 计算基本积分 ∫dx/√(a²-x²)
basicSineIntegral :: Double -> Double -> Double
basicSineIntegral a x = sineSubstitution a x

-- 计算基本积分 ∫dx/√(a²+x²)
basicTangentIntegral :: Double -> Double -> Double
basicTangentIntegral a x = log ((x + sqrt (a*a + x*x)) / a)

-- 计算基本积分 ∫dx/√(x²-a²)
basicSecantIntegral :: Double -> Double -> Double
basicSecantIntegral a x = log ((x + sqrt (x*x - a*a)) / a)

-- 辅助函数
sqrt :: Double -> Double
sqrt = Prelude.sqrt

log :: Double -> Double
log = Prelude.log

asin :: Double -> Double
asin = Prelude.asin

atan :: Double -> Double
atan = Prelude.atan

acos :: Double -> Double
acos = Prelude.acos

abs :: Double -> Double
abs = Prelude.abs

-- 测试函数
testSineSubstitution :: Bool
testSineSubstitution = abs (basicSineIntegral 1.0 0.5 - 0.5235987755982988) < 1e-10

testTangentSubstitution :: Bool
testTangentSubstitution = abs (basicTangentIntegral 1.0 1.0 - 0.881373587019543) < 1e-10

testSecantSubstitution :: Bool
testSecantSubstitution = abs (basicSecantIntegral 1.0 2.0 - 1.3169578969248166) < 1e-10

-- 运行所有测试
runTests :: Bool
runTests = testSineSubstitution && testTangentSubstitution && testSecantSubstitution
```

## 相关文件

- [00-三角替换总览](../00-三角替换总览.md)
- [02-复合三角替换](02-复合三角替换.md)
- [03-特殊三角替换](03-特殊三角替换.md)
- [04-双曲函数替换](04-双曲函数替换.md)
- [05-欧拉替换](05-欧拉替换.md)
- [06-万能替换](06-万能替换.md)
- [07-应用实例](07-应用实例.md)
- [00-积分技巧总览](../00-积分技巧总览.md)
- [01-换元积分法](../01-换元积分法/00-换元积分法总览.md)
- [02-分部积分法](../02-分部积分法/00-分部积分法总览.md)
- [04-部分分式分解](../04-部分分式分解/00-部分分式分解总览.md)
- [05-有理函数积分](../05-有理函数积分/00-有理函数积分总览.md) 