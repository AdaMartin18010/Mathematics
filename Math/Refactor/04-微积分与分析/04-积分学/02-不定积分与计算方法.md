# 不定积分与计算方法

## 1. 不定积分的基本概念

### 1.1 原函数与不定积分的定义

**定义 1.1.1**（原函数）：如果在区间 $I$ 上，函数 $F$ 的导数等于函数 $f$，即对任意 $x \in I$ 有 $F'(x) = f(x)$，则称 $F$ 是 $f$ 在区间 $I$ 上的一个原函数。

**定义 1.1.2**（不定积分）：函数 $f$ 在区间 $I$ 上的所有原函数的全体称为 $f$ 在 $I$ 上的不定积分，记作：

$$\int f(x) dx$$

如果 $F$ 是 $f$ 的一个原函数，则 $f$ 的不定积分可表示为：

$$\int f(x) dx = F(x) + C$$

其中 $C$ 是任意常数，称为积分常数。

### 1.2 不定积分与导数的关系

不定积分和导数是互逆运算，即：

$$\left(\int f(x) dx\right)' = f(x)$$

$$\int f'(x) dx = f(x) + C$$

### 1.3 不定积分的基本性质

**性质 1**（线性性质）：如果函数 $f$ 和 $g$ 在区间 $I$ 上都有不定积分，$\alpha$ 和 $\beta$ 是任意常数，则：

$$\int [\alpha f(x) + \beta g(x)] dx = \alpha \int f(x) dx + \beta \int g(x) dx$$

**性质 2**（常数因子提取）：

$$\int k f(x) dx = k \int f(x) dx, \quad k \text{ 是常数}$$

**性质 3**（和差公式）：

$$\int [f(x) \pm g(x)] dx = \int f(x) dx \pm \int g(x) dx$$

## 2. 基本积分表与初等函数积分

### 2.1 基本积分表

以下是一些常用的基本积分公式：

1. $\int k dx = kx + C$，其中 $k$ 是常数

2. $\int x^n dx = \frac{x^{n+1}}{n+1} + C$，其中 $n \neq -1$

3. $\int \frac{1}{x} dx = \ln|x| + C$

4. $\int e^x dx = e^x + C$

5. $\int a^x dx = \frac{a^x}{\ln a} + C$，其中 $a > 0, a \neq 1$

6. $\int \sin x dx = -\cos x + C$

7. $\int \cos x dx = \sin x + C$

8. $\int \tan x dx = -\ln|\cos x| + C = \ln|\sec x| + C$

9. $\int \cot x dx = \ln|\sin x| + C$

10. $\int \sec x dx = \ln|\sec x + \tan x| + C$

11. $\int \csc x dx = \ln|\csc x - \cot x| + C$

12. $\int \sec^2 x dx = \tan x + C$

13. $\int \csc^2 x dx = -\cot x + C$

14. $\int \sec x \tan x dx = \sec x + C$

15. $\int \csc x \cot x dx = -\csc x + C$

16. $\int \frac{1}{a^2 + x^2} dx = \frac{1}{a} \arctan \frac{x}{a} + C$，其中 $a > 0$

17. $\int \frac{1}{a^2 - x^2} dx = \frac{1}{2a} \ln \left| \frac{a+x}{a-x} \right| + C$，其中 $|x| < a$

18. $\int \frac{1}{\sqrt{a^2 - x^2}} dx = \arcsin \frac{x}{a} + C$，其中 $|x| < a, a > 0$

19. $\int \frac{1}{\sqrt{x^2 - a^2}} dx = \ln |x + \sqrt{x^2 - a^2}| + C$，其中 $|x| > a > 0$

20. $\int \frac{1}{\sqrt{x^2 + a^2}} dx = \ln |x + \sqrt{x^2 + a^2}| + C$，其中 $a > 0$

### 2.2 初等函数的不定积分

**定理 2.2.1**：并非所有初等函数都有以初等函数表示的不定积分。

例如，下列函数的不定积分不能用初等函数表示：

- $\int e^{x^2} dx$
- $\int \frac{\sin x}{x} dx$
- $\int \sqrt{1 + x^3} dx$

这些积分需要引入特殊函数或数值方法来处理。

## 3. 不定积分的主要计算方法

### 3.1 第一类换元法（凑微分法）

**定理 3.1.1**：设 $u = \varphi(x)$ 是 $x$ 的可微函数，$f$ 是连续函数，则：

$$\int f(\varphi(x)) \varphi'(x) dx = \int f(u) du$$

凑微分法的基本思想是将被积函数表示为某个函数的导数形式。

**例 3.1.2**：计算 $\int \cos(3x+2) dx$。

解：令 $u = 3x+2$，则 $du = 3dx$，即 $dx = \frac{1}{3}du$。代入得：

$$\int \cos(3x+2) dx = \int \cos u \cdot \frac{1}{3} du = \frac{1}{3} \int \cos u du = \frac{1}{3} \sin u + C = \frac{1}{3} \sin(3x+2) + C$$

### 3.2 第二类换元法（换元代入法）

**定理 3.2.1**：设 $x = \psi(t)$ 是单调、可微且有连续导数的函数，$f$ 是连续函数，则：

$$\int f(x) dx = \int f(\psi(t)) \psi'(t) dt$$

**例 3.2.2**：计算 $\int \frac{dx}{\sqrt{1-x^2}}$。

解：令 $x = \sin t$，则 $dx = \cos t dt$，代入得：

$$\int \frac{dx}{\sqrt{1-x^2}} = \int \frac{\cos t dt}{\sqrt{1-\sin^2 t}} = \int \frac{\cos t dt}{\cos t} = \int dt = t + C = \arcsin x + C$$

### 3.3 分部积分法

**定理 3.3.1**（分部积分公式）：设 $u(x)$ 和 $v(x)$ 是可微函数，则：

$$\int u(x) v'(x) dx = u(x) v(x) - \int u'(x) v(x) dx$$

或写成：

$$\int u dv = uv - \int v du$$

**例 3.3.2**：计算 $\int x \cos x dx$。

解：令 $u = x$，$dv = \cos x dx$，则 $du = dx$，$v = \sin x$。代入分部积分公式得：

$$\int x \cos x dx = x \sin x - \int \sin x dx = x \sin x + \cos x + C$$

**例 3.3.3**：计算 $\int \ln x dx$。

解：令 $u = \ln x$，$dv = dx$，则 $du = \frac{1}{x} dx$，$v = x$。代入分部积分公式得：

$$\int \ln x dx = x \ln x - \int x \cdot \frac{1}{x} dx = x \ln x - \int dx = x \ln x - x + C$$

### 3.4 有理函数的积分

#### 3.4.1 有理函数的定义与分类

**定义 3.4.1**（有理函数）：形如 $R(x) = \frac{P(x)}{Q(x)}$ 的函数称为有理函数，其中 $P(x)$ 和 $Q(x)$ 是多项式，且 $Q(x) \neq 0$。

有理函数可以分为两类：

- **真分式**：$\deg P(x) < \deg Q(x)$
- **假分式**：$\deg P(x) \geq \deg Q(x)$

对于假分式，可以通过多项式除法将其表示为多项式与真分式之和：

$$\frac{P(x)}{Q(x)} = S(x) + \frac{R(x)}{Q(x)}$$

其中 $\deg R(x) < \deg Q(x)$。

#### 3.4.2 部分分式分解法

**定理 3.4.2**：任何真分式都可以分解为若干个简单分式之和。

设 $Q(x) = a_n(x-\alpha_1)^{m_1}(x-\alpha_2)^{m_2} \cdots (x-\alpha_s)^{m_s}[(x-\beta_1)^2+\gamma_1^2]^{n_1} \cdots [(x-\beta_t)^2+\gamma_t^2]^{n_t}$，则真分式 $\frac{P(x)}{Q(x)}$ 可以分解为：

$$\frac{P(x)}{Q(x)} = \sum_{i=1}^{s} \sum_{j=1}^{m_i} \frac{A_{ij}}{(x-\alpha_i)^j} + \sum_{k=1}^{t} \sum_{l=1}^{n_k} \frac{B_{kl}x+C_{kl}}{[(x-\beta_k)^2+\gamma_k^2]^l}$$

**例 3.4.3**：计算 $\int \frac{2x-1}{x^2-x-2} dx$。

解：首先进行部分分式分解。注意到 $x^2-x-2 = (x-2)(x+1)$，所以：

$$\frac{2x-1}{x^2-x-2} = \frac{A}{x-2} + \frac{B}{x+1}$$

求解 $A$ 和 $B$ 得 $A = 1$，$B = 1$。因此：

$$\int \frac{2x-1}{x^2-x-2} dx = \int \left(\frac{1}{x-2} + \frac{1}{x+1}\right) dx = \ln|x-2| + \ln|x+1| + C = \ln|x^2-x-2| + C$$

### 3.5 三角函数的积分

#### 3.5.1 基本三角函数积分

基本的三角函数积分已在基本积分表中给出。

#### 3.5.2 三角代换

对于含有 $\sqrt{a^2-x^2}$、$\sqrt{a^2+x^2}$ 或 $\sqrt{x^2-a^2}$ 的积分，可以使用以下三角代换：

1. 当积分中含有 $\sqrt{a^2-x^2}$ 时，令 $x = a\sin t$，则 $\sqrt{a^2-x^2} = a\cos t$
2. 当积分中含有 $\sqrt{a^2+x^2}$ 时，令 $x = a\tan t$，则 $\sqrt{a^2+x^2} = a\sec t$
3. 当积分中含有 $\sqrt{x^2-a^2}$ 时，令 $x = a\sec t$，则 $\sqrt{x^2-a^2} = a\tan t$

**例 3.5.1**：计算 $\int \frac{dx}{\sqrt{4-x^2}}$。

解：令 $x = 2\sin t$，则 $dx = 2\cos t dt$，$\sqrt{4-x^2} = \sqrt{4-4\sin^2 t} = 2\cos t$。代入得：

$$\int \frac{dx}{\sqrt{4-x^2}} = \int \frac{2\cos t dt}{2\cos t} = \int dt = t + C = \arcsin \frac{x}{2} + C$$

#### 3.5.3 万能代换

对于有理三角函数（仅含有 $\sin x$ 和 $\cos x$ 的有理函数），可以使用万能代换 $t = \tan \frac{x}{2}$，则：

$$\sin x = \frac{2t}{1+t^2}, \quad \cos x = \frac{1-t^2}{1+t^2}, \quad dx = \frac{2dt}{1+t^2}$$

**例 3.5.2**：计算 $\int \frac{dx}{1+\sin x}$。

解：使用万能代换 $t = \tan \frac{x}{2}$，则：

$$\int \frac{dx}{1+\sin x} = \int \frac{\frac{2dt}{1+t^2}}{1+\frac{2t}{1+t^2}} = \int \frac{2dt}{1+t^2+2t} = \int \frac{2dt}{(1+t)^2} = -\frac{2}{1+t} + C = -\frac{2}{1+\tan \frac{x}{2}} + C$$

### 3.6 无理函数的积分

#### 3.6.1 根式代换

对于含有 $\sqrt[n]{ax+b}$ 的积分，可以使用代换 $u = \sqrt[n]{ax+b}$，即 $ax+b = u^n$。

**例 3.6.1**：计算 $\int \frac{dx}{\sqrt{x}(1+\sqrt{x})}$。

解：令 $u = \sqrt{x}$，则 $x = u^2$，$dx = 2u du$。代入得：

$$\int \frac{dx}{\sqrt{x}(1+\sqrt{x})} = \int \frac{2u du}{u(1+u)} = 2\int \frac{du}{1+u} = 2\ln|1+u| + C = 2\ln|1+\sqrt{x}| + C$$

#### 3.6.2 欧拉代换

对于形如 $\int R(x, \sqrt{ax^2+bx+c}) dx$ 的积分，其中 $R$ 是有理函数，可以使用欧拉代换：

1. 当 $ax^2+bx+c$ 有两个不同的实根时，可以写成 $a(x-r_1)(x-r_2)$ 的形式，令 $\sqrt{ax^2+bx+c} = (x-r_1)t$ 或 $\sqrt{ax^2+bx+c} = (x-r_2)t$
2. 当 $ax^2+bx+c$ 有一个二重实根时，可以写成 $a(x-r)^2$ 的形式，令 $\sqrt{ax^2+bx+c} = (x-r)t$
3. 当 $ax^2+bx+c$ 没有实根时，可以写成 $a[(x+\frac{b}{2a})^2+\frac{4ac-b^2}{4a^2}]$ 的形式，令 $\sqrt{ax^2+bx+c} = (x+\frac{b}{2a})t \pm \sqrt{\frac{4ac-b^2}{4a^2}}$

**例 3.6.2**：计算 $\int \frac{dx}{\sqrt{x^2-1}}$。

解：注意到 $x^2-1 = (x-1)(x+1)$，使用欧拉代换 $\sqrt{x^2-1} = (x-1)t$。则：

$$(x-1)^2t^2 = x^2-1 = (x-1)(x+1)$$

解得 $x = \frac{t^2+1}{t^2-1}$，$dx = \frac{-4t}{(t^2-1)^2} dt$。代入得：

$$\int \frac{dx}{\sqrt{x^2-1}} = \int \frac{\frac{-4t}{(t^2-1)^2} dt}{\frac{2t}{t^2-1}} = \int \frac{-2}{t^2-1} dt = -\ln\left|\frac{t+1}{t-1}\right| + C$$

经过计算和代回原变量，最终得到：

$$\int \frac{dx}{\sqrt{x^2-1}} = \ln|x + \sqrt{x^2-1}| + C$$

## 4. 特殊函数的积分

### 4.1 含有特殊函数的积分

某些积分需要引入特殊函数来表示，例如：

1. 误差函数：$\text{erf}(x) = \frac{2}{\sqrt{\pi}} \int_0^x e^{-t^2} dt$
2. 正弦积分：$\text{Si}(x) = \int_0^x \frac{\sin t}{t} dt$
3. 余弦积分：$\text{Ci}(x) = -\int_x^{\infty} \frac{\cos t}{t} dt$
4. 对数积分：$\text{li}(x) = \int_0^x \frac{dt}{\ln t}$
5. 椭圆积分：$F(\phi, k) = \int_0^{\phi} \frac{d\theta}{\sqrt{1-k^2\sin^2 \theta}}$

### 4.2 超越函数的积分

某些积分不能用初等函数表示，例如：

1. $\int e^{x^2} dx$ 与误差函数有关
2. $\int \frac{\sin x}{x} dx$ 与正弦积分有关
3. $\int \sqrt{1-k^2\sin^2 x} dx$ 是第二类椭圆积分

## 5. 不定积分的应用

### 5.1 微分方程的求解

不定积分是求解一阶常微分方程的基本工具。例如，对于一阶线性微分方程：

$$\frac{dy}{dx} + P(x)y = Q(x)$$

其通解为：

$$y = e^{-\int P(x) dx} \left( \int Q(x) e^{\int P(x) dx} dx + C \right)$$

### 5.2 物理学中的应用

不定积分在物理学中有广泛应用，例如：

1. 由速度函数求位移函数：$s(t) = \int v(t) dt$
2. 由加速度函数求速度函数：$v(t) = \int a(t) dt$
3. 由功率函数求功：$W = \int P(t) dt$
4. 由电流求电荷：$q = \int i(t) dt$

### 5.3 几何学中的应用

不定积分可以用来求曲线的面积函数、体积函数等。例如，曲线 $y = f(x)$ 从点 $(a, f(a))$ 到点 $(x, f(x))$ 与 $x$ 轴所围成的面积函数为：

$$A(x) = \int_a^x f(t) dt$$

## 6. 计算机代数系统中的积分算法

### 6.1 Risch算法

Risch算法是一种用于计算初等函数不定积分的决策过程，它可以判断一个给定的初等函数是否有初等函数形式的不定积分，并在有的情况下给出结果。

### 6.2 数值积分方法

对于无法用初等函数表示的不定积分，可以使用数值方法求解定积分，例如：

1. 矩形法
2. 梯形法
3. 辛普森法
4. 高斯求积法
5. 自适应积分法

## 7. 参考文献

1. Apostol, T. M. (1974). *Mathematical Analysis*.
2. Courant, R., & John, F. (1989). *Introduction to Calculus and Analysis*.
3. Demidovich, B. P. (1973). *Problems in Mathematical Analysis*.
4. Gradshteyn, I. S., & Ryzhik, I. M. (2007). *Table of Integrals, Series, and Products*.
5. Zwillinger, D. (2014). *Handbook of Differential Equations*.

---

**本文档关联**：

- 上游：[积分学总览](./00-积分学总览.md)
- 同级：[定积分基础](./01-定积分基础.md)、[多元积分](./03-多元积分.md)
- 下游：[广义积分](./04-广义积分.md)
