# 不定积分与换元

## 目录

- [不定积分与换元](#不定积分与换元)
  - [目录](#目录)
  - [1. 不定积分基础](#1-不定积分基础)
    - [1.1 原函数与不定积分定义](#11-原函数与不定积分定义)
    - [1.2 不定积分的性质](#12-不定积分的性质)
    - [1.3 基本积分公式表](#13-基本积分公式表)
  - [2. 换元积分法](#2-换元积分法)
    - [2.1 第一类换元法（凑微分法）](#21-第一类换元法凑微分法)
    - [2.2 第二类换元法（代入法）](#22-第二类换元法代入法)
    - [2.3 三角换元](#23-三角换元)
  - [3. 分部积分法](#3-分部积分法)
    - [3.1 分部积分公式](#31-分部积分公式)
    - [3.2 应用策略](#32-应用策略)
    - [3.3 循环积分](#33-循环积分)
  - [4. 特殊函数的积分](#4-特殊函数的积分)
    - [4.1 有理函数积分](#41-有理函数积分)
    - [4.2 三角函数积分](#42-三角函数积分)
    - [4.3 无理函数积分](#43-无理函数积分)
  - [5. 积分表与查表积分](#5-积分表与查表积分)
    - [5.1 常用积分表](#51-常用积分表)
    - [5.2 递推公式](#52-递推公式)
  - [6. 计算机辅助积分](#6-计算机辅助积分)
    - [6.1 符号积分算法](#61-符号积分算法)
    - [6.2 积分计算工具](#62-积分计算工具)
  - [7. 习题与思考](#7-习题与思考)
  - [8. 参考文献](#8-参考文献)

## 1. 不定积分基础

### 1.1 原函数与不定积分定义

**原函数定义**：对于定义在区间 $I$ 上的函数 $f(x)$，如果存在可导函数 $F(x)$，使得对任意 $x \in I$，都有 $F'(x) = f(x)$，则称 $F(x)$ 为 $f(x)$ 在 $I$ 上的一个原函数。

**不定积分定义**：函数 $f(x)$ 的全体原函数称为 $f(x)$ 的不定积分，记作：
$$\int f(x) \, dx$$

如果 $F(x)$ 是 $f(x)$ 的一个原函数，则：
$$\int f(x) \, dx = F(x) + C$$
其中 $C$ 是任意常数，称为积分常数。

**原函数存在定理**：如果函数 $f(x)$ 在区间 $I$ 上连续，则 $f(x)$ 在 $I$ 上一定存在原函数。

### 1.2 不定积分的性质

1. **常数因子性质**：对于任意常数 $k$，
   $$\int k \cdot f(x) \, dx = k \int f(x) \, dx$$

2. **和差性质**：
   $$\int [f(x) \pm g(x)] \, dx = \int f(x) \, dx \pm \int g(x) \, dx$$

3. **微分与不定积分的关系**：
   $$\frac{d}{dx} \int f(x) \, dx = f(x)$$

4. **不定积分的微分**：
   $$\int F'(x) \, dx = F(x) + C$$

### 1.3 基本积分公式表

1. **常数积分**：
   $$\int a \, dx = ax + C$$

2. **幂函数积分**：
   $$\int x^n \, dx = \frac{x^{n+1}}{n+1} + C \quad (n \neq -1)$$

3. **指数函数积分**：
   $$\int e^x \, dx = e^x + C$$
   $$\int a^x \, dx = \frac{a^x}{\ln a} + C \quad (a > 0, a \neq 1)$$

4. **对数函数积分**：
   $$\int \frac{1}{x} \, dx = \ln |x| + C$$

5. **三角函数积分**：
   $$\int \sin x \, dx = -\cos x + C$$
   $$\int \cos x \, dx = \sin x + C$$
   $$\int \tan x \, dx = -\ln |\cos x| + C = \ln |\sec x| + C$$
   $$\int \cot x \, dx = \ln |\sin x| + C$$
   $$\int \sec x \, dx = \ln |\sec x + \tan x| + C$$
   $$\int \csc x \, dx = \ln |\csc x - \cot x| + C$$

6. **反三角函数积分**：
   $$\int \frac{1}{\sqrt{1-x^2}} \, dx = \arcsin x + C$$
   $$\int \frac{1}{1+x^2} \, dx = \arctan x + C$$
   $$\int \frac{1}{x\sqrt{x^2-1}} \, dx = \arcsec x + C$$

## 2. 换元积分法

### 2.1 第一类换元法（凑微分法）

**基本思想**：识别被积函数中可能构成某个函数的微分形式。

**公式**：如果 $u = g(x)$ 且 $g'(x)$ 连续，则：
$$\int f(g(x)) \cdot g'(x) \, dx = \int f(u) \, du$$

**步骤**：

1. 识别被积函数中的复合函数形式 $f(g(x))$
2. 检查是否包含 $g'(x)$ 因子
3. 代入 $u = g(x)$，将 $dx$ 转换为 $du$
4. 对新的积分式求解，并最后将 $u$ 替换回 $g(x)$

**例1**：求 $\int \sin(2x) \, dx$

解：令 $u = 2x$，则 $du = 2dx$，所以 $dx = \frac{du}{2}$。代入得：
$$\int \sin(2x) \, dx = \int \sin u \cdot \frac{du}{2} = \frac{1}{2} \int \sin u \, du = -\frac{1}{2} \cos u + C = -\frac{1}{2} \cos(2x) + C$$

**例2**：求 $\int \frac{1}{1+x^2} \, dx$

解：令 $u = x$，则 $du = dx$。代入标准积分公式：
$$\int \frac{1}{1+x^2} \, dx = \int \frac{1}{1+u^2} \, du = \arctan u + C = \arctan x + C$$

### 2.2 第二类换元法（代入法）

**基本思想**：通过引入新的变量 $t = \phi(x)$ 使得原积分变为简单形式。

**公式**：如果 $x = \phi(t)$ 且 $\phi'(t)$ 连续，则：
$$\int f(x) \, dx = \int f(\phi(t)) \cdot \phi'(t) \, dt$$

**适用情况**：

- 含有 $\sqrt{a^2-x^2}, \sqrt{a^2+x^2}, \sqrt{x^2-a^2}$ 的无理函数
- 含有三角函数的积分
- 某些复杂有理函数

**例1**：求 $\int \sqrt{1-x^2} \, dx$

解：令 $x = \sin t$，则 $dx = \cos t \, dt$，且 $\sqrt{1-x^2} = \sqrt{1-\sin^2 t} = \cos t$（当 $t \in [-\frac{\pi}{2}, \frac{\pi}{2}]$）。

代入得：
$$\int \sqrt{1-x^2} \, dx = \int \cos t \cdot \cos t \, dt = \int \cos^2 t \, dt = \frac{1}{2} \int (1 + \cos 2t) \, dt = \frac{t}{2} + \frac{\sin 2t}{4} + C$$

因为 $t = \arcsin x$ 且 $\sin 2t = 2\sin t \cos t = 2x \sqrt{1-x^2}$，所以：
$$\int \sqrt{1-x^2} \, dx = \frac{\arcsin x}{2} + \frac{x \sqrt{1-x^2}}{2} + C$$

### 2.3 三角换元

**适用情况**：

1. 被积函数含有 $\sqrt{a^2-x^2}$，可令 $x = a\sin t$
2. 被积函数含有 $\sqrt{a^2+x^2}$，可令 $x = a\tan t$
3. 被积函数含有 $\sqrt{x^2-a^2}$，可令 $x = a\sec t$

**例**：求 $\int \frac{dx}{x^2\sqrt{x^2-4}}$

解：令 $x = 2\sec t$（因为式中含有 $\sqrt{x^2-4} = \sqrt{4(\sec^2 t - 1)} = 2\tan t$），则 $dx = 2\sec t \tan t \, dt$。

代入得：
$$
\begin{align*}
\int \frac{dx}{x^2\sqrt{x^2-4}} &= \int \frac{2\sec t \tan t \, dt}{4\sec^2 t \cdot 2\tan t} \\
&= \int \frac{dt}{4\sec t} \\
&= \frac{1}{4} \int \cos t \, dt \\
&= \frac{1}{4} \sin t + C
\end{align*}
$$

因为 $\sin t = \frac{\tan t}{\sec t} = \frac{\sqrt{x^2-4}}{x}$，所以：
$$\int \frac{dx}{x^2\sqrt{x^2-4}} = \frac{1}{4} \cdot \frac{\sqrt{x^2-4}}{x} + C = \frac{\sqrt{x^2-4}}{4x} + C$$

## 3. 分部积分法

### 3.1 分部积分公式

分部积分公式源自乘积求导法则，表达为：
$$\int u(x) \cdot v'(x) \, dx = u(x) \cdot v(x) - \int v(x) \cdot u'(x) \, dx$$

其中 $u(x)$ 和 $v(x)$ 是可导函数。

这个公式通常简记为：
$$\int u \, dv = u \cdot v - \int v \, du$$

### 3.2 应用策略

分部积分法适用于以下类型的积分：

1. $\int x^n e^{ax} \, dx$
2. $\int x^n \sin ax \, dx$，$\int x^n \cos ax \, dx$
3. $\int x^n \ln x \, dx$
4. $\int e^{ax} \sin bx \, dx$，$\int e^{ax} \cos bx \, dx$
5. $\int \arcsin x \, dx$，$\int \arccos x \, dx$，$\int \arctan x \, dx$

**选择 $u$ 和 $dv$ 的原则**：

- $u$ 应选择求导后能降低复杂度的函数（如多项式，对数，反三角函数）
- $dv$ 应选择容易积分的函数（如指数，三角函数）

记忆口诀：**LIATE**（按优先级选择 $u$）：

- **L**: 对数函数 (Logarithmic functions)
- **I**: 反三角函数 (Inverse trigonometric functions)
- **A**: 代数函数 (Algebraic functions)，如多项式
- **T**: 三角函数 (Trigonometric functions)
- **E**: 指数函数 (Exponential functions)

**例1**：求 $\int x e^x \, dx$

解：取 $u = x$，$dv = e^x dx$，则 $du = dx$，$v = e^x$。

应用分部积分公式：
$$
\begin{align*}
\int x e^x \, dx &= x e^x - \int e^x \, dx \\
&= x e^x - e^x + C \\
&= e^x(x - 1) + C
\end{align*}
$$

**例2**：求 $\int \ln x \, dx$

解：取 $u = \ln x$，$dv = dx$，则 $du = \frac{1}{x} dx$，$v = x$。

应用分部积分公式：
$$
\begin{align*}
\int \ln x \, dx &= x \ln x - \int x \cdot \frac{1}{x} \, dx \\
&= x \ln x - \int 1 \, dx \\
&= x \ln x - x + C
\end{align*}
$$

### 3.3 循环积分

某些情况下，分部积分会导致循环，即最终回到原始积分式。这时可以通过代数方法求解。

**例**：求 $\int e^x \cos x \, dx$

解：取 $u = e^x$，$dv = \cos x \, dx$，则 $du = e^x dx$，$v = \sin x$。

$$
\begin{align*}
\int e^x \cos x \, dx &= e^x \sin x - \int e^x \sin x \, dx
\end{align*}
$$

对 $\int e^x \sin x \, dx$ 再次分部积分，取 $u = e^x$，$dv = \sin x \, dx$，则 $du = e^x dx$，$v = -\cos x$。

$$
\begin{align*}
\int e^x \sin x \, dx &= -e^x \cos x + \int e^x \cos x \, dx
\end{align*}
$$

代入原式，得到：
$$
\begin{align*}
\int e^x \cos x \, dx &= e^x \sin x - \left( -e^x \cos x + \int e^x \cos x \, dx \right) \\
&= e^x \sin x + e^x \cos x - \int e^x \cos x \, dx
\end{align*}
$$

将 $\int e^x \cos x \, dx$ 移到等式左侧：
$$
\begin{align*}
2 \int e^x \cos x \, dx &= e^x \sin x + e^x \cos x \\
\int e^x \cos x \, dx &= \frac{e^x (\sin x + \cos x)}{2} + C
\end{align*}
$$

## 4. 特殊函数的积分

### 4.1 有理函数积分

有理函数是形如 $R(x) = \frac{P(x)}{Q(x)}$ 的函数，其中 $P(x)$ 和 $Q(x)$ 是多项式。

**部分分式分解法**：将有理函数分解为简单分式的和，然后分别积分。

**分解步骤**：

1. 若分子次数不小于分母次数，先用多项式长除法
2. 将分母因式分解为不可约多项式的积
3. 根据不可约因式的形式设立部分分式

**例**：求 $\int \frac{2x-5}{(x-1)(x-2)} \, dx$

解：首先将分式分解为：
$$\frac{2x-5}{(x-1)(x-2)} = \frac{A}{x-1} + \frac{B}{x-2}$$

通过求解系数 $A$ 和 $B$：
对 $x=1$：$\frac{2(1)-5}{(1-1)(1-2)} = \frac{A(1-2)}{(1-1)(1-2)} + \frac{B(1-1)}{(1-1)(1-2)} \Rightarrow -3 = -A \Rightarrow A = 3$
对 $x=2$：$\frac{2(2)-5}{(2-1)(2-2)} = \frac{A(2-2)}{(2-1)(2-2)} + \frac{B(2-1)}{(2-1)(2-2)} \Rightarrow -1 = B \Rightarrow B = -1$

因此：
$$
\begin{align*}
\int \frac{2x-5}{(x-1)(x-2)} \, dx &= \int \left( \frac{3}{x-1} - \frac{1}{x-2} \right) \, dx \\
&= 3 \ln |x-1| - \ln |x-2| + C \\
&= \ln |x-1|^3 - \ln |x-2| + C \\
&= \ln \left| \frac{(x-1)^3}{x-2} \right| + C
\end{align*}
$$

### 4.2 三角函数积分

**基本策略**：

1. 降幂公式：$\sin^2 x = \frac{1 - \cos 2x}{2}$，$\cos^2 x = \frac{1 + \cos 2x}{2}$
2. 和差公式：$\sin \alpha \cos \beta = \frac{1}{2}[\sin(\alpha+\beta) + \sin(\alpha-\beta)]$
3. 万能代换：令 $t = \tan \frac{x}{2}$，则 $\sin x = \frac{2t}{1+t^2}$，$\cos x = \frac{1-t^2}{1+t^2}$，$dx = \frac{2dt}{1+t^2}$

**例1**：求 $\int \sin^2 x \, dx$

解：使用降幂公式：
$$
\begin{align*}
\int \sin^2 x \, dx &= \int \frac{1 - \cos 2x}{2} \, dx \\
&= \frac{1}{2} \int (1 - \cos 2x) \, dx \\
&= \frac{1}{2} \left( x - \frac{\sin 2x}{2} \right) + C \\
&= \frac{x}{2} - \frac{\sin 2x}{4} + C
\end{align*}
$$

**例2**：求 $\int \frac{dx}{5 + 4\sin x}$

解：使用万能代换 $t = \tan \frac{x}{2}$，则：
$$\sin x = \frac{2t}{1+t^2}, \cos x = \frac{1-t^2}{1+t^2}, dx = \frac{2dt}{1+t^2}$$

代入得：
$$
\begin{align*}
\int \frac{dx}{5 + 4\sin x} &= \int \frac{2dt/(1+t^2)}{5 + 4 \cdot 2t/(1+t^2)} \\
&= \int \frac{2dt}{5(1+t^2) + 8t} \\
&= \int \frac{2dt}{5 + 5t^2 + 8t} \\
&= \int \frac{2dt}{5(t + \frac{4}{5})^2 + 5 - \frac{16}{5}} \\
&= \int \frac{2dt}{5(t + \frac{4}{5})^2 + \frac{9}{5}} \\
\end{align*}
$$

进一步代换 $u = t + \frac{4}{5}$，得：
$$
\begin{align*}
\int \frac{2dt}{5(t + \frac{4}{5})^2 + \frac{9}{5}} &= \int \frac{2du}{5u^2 + \frac{9}{5}} \\
&= \int \frac{2du}{\frac{25u^2 + 9}{5}} \\
&= \int \frac{10du}{25u^2 + 9} \\
&= \frac{10}{3} \arctan\frac{5u}{3} + C \\
&= \frac{10}{3} \arctan\frac{5(t + \frac{4}{5})}{3} + C \\
&= \frac{10}{3} \arctan\frac{5t + 4}{3} + C
\end{align*}
$$

将 $t = \tan \frac{x}{2}$ 代回得最终结果。

### 4.3 无理函数积分

对含有无理表达式的积分，常用的方法有：

1. 适当的换元法
2. 三角代换
3. 有理化处理

**例**：求 $\int \frac{dx}{\sqrt{x^2+9}}$

解：令 $x = 3\tan t$，则 $dx = 3\sec^2 t \, dt$ 且 $\sqrt{x^2+9} = \sqrt{9\tan^2 t + 9} = \sqrt{9(\tan^2 t + 1)} = 3\sec t$。

代入得：
$$
\begin{align*}
\int \frac{dx}{\sqrt{x^2+9}} &= \int \frac{3\sec^2 t \, dt}{3\sec t} \\
&= \int \sec t \, dt \\
&= \ln|\sec t + \tan t| + C \\
&= \ln\left|\frac{\sqrt{x^2+9}}{3} + \frac{x}{3}\right| + C \\
&= \ln\left|\frac{x + \sqrt{x^2+9}}{3}\right| + C
\end{align*}
$$

## 5. 积分表与查表积分

### 5.1 常用积分表

除了前面列出的基本积分公式外，以下是一些常用的复杂积分公式：

1. $\int \tan x \, dx = \ln |\sec x| + C$
2. $\int \sec x \, dx = \ln |\sec x + \tan x| + C$
3. $\int \sec^2 x \, dx = \tan x + C$
4. $\int \frac{dx}{a^2 + x^2} = \frac{1}{a} \arctan \frac{x}{a} + C$
5. $\int \frac{dx}{a^2 - x^2} = \frac{1}{2a} \ln \left| \frac{a+x}{a-x} \right| + C$
6. $\int \frac{dx}{\sqrt{a^2 - x^2}} = \arcsin \frac{x}{a} + C$
7. $\int \frac{dx}{\sqrt{x^2 \pm a^2}} = \ln |x + \sqrt{x^2 \pm a^2}| + C$

### 5.2 递推公式

对一些特定形式的积分，可以使用递推公式：

1. $\int \sin^n x \, dx = -\frac{\sin^{n-1} x \cos x}{n} + \frac{n-1}{n} \int \sin^{n-2} x \, dx$
2. $\int \cos^n x \, dx = \frac{\cos^{n-1} x \sin x}{n} + \frac{n-1}{n} \int \cos^{n-2} x \, dx$
3. $\int x^n e^{ax} \, dx = \frac{x^n e^{ax}}{a} - \frac{n}{a} \int x^{n-1} e^{ax} \, dx$

## 6. 计算机辅助积分

### 6.1 符号积分算法

计算机符号积分主要基于以下算法：

1. **Risch算法**：对初等函数的符号积分的决定性算法
2. **Pattern matching**：基于模式匹配的积分规则
3. **延拓法**：通过解析延拓处理特殊积分

### 6.2 积分计算工具

现代数学软件可以高效处理复杂的积分问题：

1. **Mathematica**：功能强大的符号计算系统
2. **Maple**：专业的数学软件
3. **SymPy**：Python的符号数学库
4. **MATLAB Symbolic Math Toolbox**：MATLAB的符号计算工具箱

**例**：使用SymPy计算积分的Python代码：

```python
from sympy import symbols, integrate, sin, cos, exp, log

x = symbols('x')
# 计算不定积分
result = integrate(x**2 * exp(x), x)
print(result)
# 输出: x**2*exp(x) - 2*x*exp(x) + 2*exp(x)

# 计算定积分
definite_result = integrate(sin(x)**2, (x, 0, 2*3.14159))
print(definite_result)
# 输出接近 π
```

## 7. 习题与思考

1. 计算下列不定积分：
   a) $\int \frac{x^2+1}{x^3+x} \, dx$
   b) $\int \sin^3 x \cos^2 x \, dx$
   c) $\int \frac{dx}{x^2\sqrt{1-x^2}}$
   d) $\int x^2 \ln x \, dx$

2. 证明：$\int \frac{dx}{1+x^4} = \frac{1}{2\sqrt{2}} \ln \left| \frac{x^2 + \sqrt{2}x + 1}{x^2 - \sqrt{2}x + 1} \right| + \frac{1}{\sqrt{2}} \arctan \frac{\sqrt{2}x}{1-x^2} + C$

3. 解释为什么有些初等函数的原函数不能用初等函数表示，举例说明。

4. 探讨计算机代数系统在处理积分问题上的优势和局限性。

## 8. 参考文献

1. 陈纪修, 於崇华, 金路. *数学分析*. 高等教育出版社, 2004.
2. Apostol, Tom M. *Calculus, Volume 1: One-Variable Calculus*. 2nd ed., Wiley, 1967.
3. Stewart, James. *Calculus: Early Transcendentals*. 8th ed., Cengage Learning, 2015.
4. Bronshtein, I.N., et al. *Handbook of Mathematics*. 6th ed., Springer, 2015.
5. Gradshteyn, I.S., Ryzhik, I.M. *Table of Integrals, Series, and Products*. 8th ed., Academic Press, 2014.
