# 数论基础：整数结构与素数理论

## 目录

1. [整除理论与基本概念](#1-整除理论与基本概念)
2. [素数理论](#2-素数理论)
3. [最大公因数与欧几里得算法](#3-最大公因数与欧几里得算法)
4. [同余理论](#4-同余理论)
5. [欧拉函数与费马小定理](#5-欧拉函数与费马小定理)
6. [二次剩余理论](#6-二次剩余理论)
7. [连分数理论](#7-连分数理论)
8. [数论函数](#8-数论函数)
9. [应用与联系](#9-应用与联系)

## 1. 整除理论与基本概念

### 1.1 整除的定义

**定义 1.1.1 (整除)**
设 $a, b \in \mathbb{Z}$，如果存在 $k \in \mathbb{Z}$ 使得 $b = ak$，则称 $a$ 整除 $b$，记作 $a \mid b$。

**定义 1.1.2 (倍数与因数)**
如果 $a \mid b$，则称 $a$ 是 $b$ 的因数，$b$ 是 $a$ 的倍数。

**定理 1.1.1 (整除的基本性质)**
对于任意整数 $a, b, c$：

1. $a \mid a$ (自反性)
2. 如果 $a \mid b$ 且 $b \mid c$，则 $a \mid c$ (传递性)
3. 如果 $a \mid b$ 且 $a \mid c$，则 $a \mid (bx + cy)$ 对所有 $x, y \in \mathbb{Z}$ 成立

**证明**:

1. $a = a \cdot 1$，所以 $a \mid a$
2. $b = ak_1$，$c = bk_2$，则 $c = a(k_1k_2)$
3. $b = ak_1$，$c = ak_2$，则 $bx + cy = a(k_1x + k_2y)$

### 1.2 带余除法

**定理 1.2.1 (带余除法)**
设 $a, b \in \mathbb{Z}$，$b \neq 0$，则存在唯一的整数 $q, r$ 使得：
$$a = bq + r, \quad 0 \leq r < |b|$$

**证明**:
存在性：考虑集合 $S = \{a - bk \mid k \in \mathbb{Z}, a - bk \geq 0\}$。$S$ 非空（取 $k$ 充分小），由良序原理，$S$ 有最小元素 $r = a - bq$。显然 $r \geq 0$，且 $r < |b|$（否则 $r - |b| \in S$ 且更小）。

唯一性：设 $a = bq_1 + r_1 = bq_2 + r_2$，则 $b(q_1 - q_2) = r_2 - r_1$。由于 $|r_2 - r_1| < |b|$，必有 $q_1 = q_2$，$r_1 = r_2$。

## 2. 素数理论

### 2.1 素数的定义

**定义 2.1.1 (素数)**
大于1的整数 $p$ 是素数，如果 $p$ 的正因数只有1和 $p$ 本身。

**定义 2.1.2 (合数)**
大于1的整数如果不是素数，则称为合数。

**定理 2.1.1 (素数的基本性质)**
素数 $p$ 满足：如果 $p \mid ab$，则 $p \mid a$ 或 $p \mid b$。

**证明**: 假设 $p \nmid a$ 且 $p \nmid b$。由于 $p$ 是素数，$\gcd(p, a) = 1$ 且 $\gcd(p, b) = 1$。因此存在整数 $x, y$ 使得 $px + ay = 1$，同理存在整数 $u, v$ 使得 $pu + bv = 1$。因此：
$$1 = (px + ay)(pu + bv) = p^2xu + pxbv + aypu + aybv$$
由于 $p \mid ab$，$p \mid 1$，矛盾。

### 2.2 算术基本定理

**定理 2.2.1 (算术基本定理)**
每个大于1的整数都可以唯一地表示为素数的乘积（不计因数的顺序）。

**证明**:
存在性：对 $n$ 用数学归纳法。$n = 2$ 时显然。假设对所有小于 $n$ 的整数成立。如果 $n$ 是素数，已证。否则 $n = ab$，其中 $1 < a, b < n$，由归纳假设 $a, b$ 可分解，故 $n$ 可分解。

唯一性：假设 $n = p_1p_2 \cdots p_k = q_1q_2 \cdots q_l$。由于 $p_1 \mid q_1q_2 \cdots q_l$，由素数性质，$p_1 \mid q_i$ 对某个 $i$。因此 $p_1 = q_i$，约去后继续归纳。

**推论 2.2.1 (标准分解)**
每个大于1的整数 $n$ 可以唯一地表示为：
$$n = p_1^{a_1} p_2^{a_2} \cdots p_k^{a_k}$$
其中 $p_1 < p_2 < \cdots < p_k$ 是素数，$a_i > 0$。

### 2.3 素数无穷性

**定理 2.3.1 (素数无穷性)**
素数有无穷多个。

**证明**: 假设素数只有有限个：$p_1, p_2, \ldots, p_n$。令 $N = p_1p_2 \cdots p_n + 1$，则 $N > 1$。如果 $N$ 是素数，则与假设矛盾。如果 $N$ 是合数，则 $N$ 有素因子 $p$，但 $p \neq p_i$（因为 $p_i \nmid N$），与假设矛盾。

## 3. 最大公因数与欧几里得算法

### 3.1 最大公因数

**定义 3.1.1 (最大公因数)**
整数 $a$ 和 $b$ 的最大公因数，记作 $\gcd(a, b)$ 或 $(a, b)$，是同时整除 $a$ 和 $b$ 的最大正整数。

**定理 3.1.1 (最大公因数的性质)**
对于任意整数 $a, b$：

1. $\gcd(a, b) = \gcd(b, a)$
2. $\gcd(a, b) = \gcd(|a|, |b|)$
3. 如果 $a \mid b$，则 $\gcd(a, b) = |a|$
4. $\gcd(a, b) = \gcd(a, b + ka)$ 对所有整数 $k$ 成立

### 3.2 欧几里得算法

**定理 3.2.1 (欧几里得算法)**
对于任意整数 $a, b$，$\gcd(a, b) = \gcd(b, a \bmod b)$。

**证明**: 设 $a = bq + r$，其中 $0 \leq r < |b|$。如果 $d \mid a$ 且 $d \mid b$，则 $d \mid r$。如果 $d \mid b$ 且 $d \mid r$，则 $d \mid a$。因此 $a$ 和 $b$ 的公约数集合等于 $b$ 和 $r$ 的公约数集合。

**算法 3.2.1 (欧几里得算法)**

```python
def gcd(a, b):
    while b != 0:
        a, b = b, a % b
    return abs(a)
```

**定理 3.2.2 (算法复杂度)**
欧几里得算法在 $O(\log \min(|a|, |b|))$ 步内终止。

### 3.3 贝祖定理

**定理 3.3.1 (贝祖定理)**
对于任意整数 $a, b$，存在整数 $x, y$ 使得：
$$\gcd(a, b) = ax + by$$

**证明**: 设 $S = \{ax + by \mid x, y \in \mathbb{Z}, ax + by > 0\}$。$S$ 非空（因为 $a^2 + b^2 > 0$），由良序原理，$S$ 有最小元素 $d = ax_0 + by_0$。

我们证明 $d = \gcd(a, b)$：

1. $d$ 是公约数：设 $a = dq + r$，$0 \leq r < d$，则 $r = a - dq = a(1 - x_0q) + b(-y_0q)$。如果 $r > 0$，则 $r \in S$，与 $d$ 的最小性矛盾。因此 $r = 0$，即 $d \mid a$。同理 $d \mid b$。
2. $d$ 是最大公约数：设 $c$ 是 $a$ 和 $b$ 的任意公约数，则 $c \mid (ax_0 + by_0) = d$。

**算法 3.3.1 (扩展欧几里得算法)**

```python
def extended_gcd(a, b):
    if b == 0:
        return a, 1, 0
    else:
        d, x, y = extended_gcd(b, a % b)
        return d, y, x - (a // b) * y
```

### 3.4 最小公倍数

**定义 3.4.1 (最小公倍数)**
整数 $a$ 和 $b$ 的最小公倍数，记作 $\text{lcm}(a, b)$ 或 $[a, b]$，是同时是 $a$ 和 $b$ 倍数的最小正整数。

**定理 3.4.1 (最小公倍数的性质)**
对于任意正整数 $a, b$：
$$\gcd(a, b) \cdot \text{lcm}(a, b) = ab$$

**证明**: 设 $a = p_1^{a_1} \cdots p_k^{a_k}$，$b = p_1^{b_1} \cdots p_k^{b_k}$。则：
$$\gcd(a, b) = p_1^{\min(a_1, b_1)} \cdots p_k^{\min(a_k, b_k)}$$
$$\text{lcm}(a, b) = p_1^{\max(a_1, b_1)} \cdots p_k^{\max(a_k, b_k)}$$
因此 $\gcd(a, b) \cdot \text{lcm}(a, b) = p_1^{a_1 + b_1} \cdots p_k^{a_k + b_k} = ab$。

## 4. 同余理论

### 4.1 同余的定义

**定义 4.1.1 (同余)**
设 $a, b, m \in \mathbb{Z}$，$m > 0$。如果 $m \mid (a - b)$，则称 $a$ 与 $b$ 模 $m$ 同余，记作 $a \equiv b \pmod{m}$。

**定理 4.1.1 (同余的基本性质)**
对于任意整数 $a, b, c$ 和正整数 $m$：

1. $a \equiv a \pmod{m}$ (自反性)
2. 如果 $a \equiv b \pmod{m}$，则 $b \equiv a \pmod{m}$ (对称性)
3. 如果 $a \equiv b \pmod{m}$ 且 $b \equiv c \pmod{m}$，则 $a \equiv c \pmod{m}$ (传递性)
4. 如果 $a \equiv b \pmod{m}$ 且 $c \equiv d \pmod{m}$，则：
   - $a + c \equiv b + d \pmod{m}$
   - $a - c \equiv b - d \pmod{m}$
   - $ac \equiv bd \pmod{m}$

### 4.2 剩余类

**定义 4.2.1 (剩余类)**
模 $m$ 的剩余类是集合 $\{a + km \mid k \in \mathbb{Z}\}$，记作 $[a]_m$。

**定义 4.2.2 (完全剩余系)**
模 $m$ 的完全剩余系是 $m$ 个两两不同余的整数。

**定理 4.2.1 (完全剩余系的性质)**
$\{0, 1, 2, \ldots, m-1\}$ 是模 $m$ 的完全剩余系。

### 4.3 线性同余方程

**定义 4.3.1 (线性同余方程)**
形如 $ax \equiv b \pmod{m}$ 的方程称为线性同余方程。

**定理 4.3.1 (线性同余方程的解)**
线性同余方程 $ax \equiv b \pmod{m}$ 有解当且仅当 $\gcd(a, m) \mid b$。

**证明**:
必要性：如果 $ax \equiv b \pmod{m}$ 有解，则存在整数 $k$ 使得 $ax = b + km$，因此 $\gcd(a, m) \mid b$。

充分性：如果 $\gcd(a, m) \mid b$，则存在整数 $x, y$ 使得 $ax + my = b$，因此 $ax \equiv b \pmod{m}$。

**定理 4.3.2 (线性同余方程的解数)**
如果 $\gcd(a, m) = d$ 且 $d \mid b$，则线性同余方程 $ax \equiv b \pmod{m}$ 恰有 $d$ 个解。

**证明**: 设 $a = da'$，$m = dm'$，$b = db'$。则 $a'x \equiv b' \pmod{m'}$。由于 $\gcd(a', m') = 1$，存在唯一解 $x_0$。所有解为 $x_0 + km'$，$k = 0, 1, \ldots, d-1$。

### 4.4 中国剩余定理

**定理 4.4.1 (中国剩余定理)**
设 $m_1, m_2, \ldots, m_k$ 是两两互素的正整数，则对于任意整数 $a_1, a_2, \ldots, a_k$，同余方程组：
$$\begin{cases}
x \equiv a_1 \pmod{m_1} \\
x \equiv a_2 \pmod{m_2} \\
\vdots \\
x \equiv a_k \pmod{m_k}
\end{cases}$$
有唯一解模 $M = m_1m_2 \cdots m_k$。

**证明**: 设 $M_i = M/m_i$，则 $\gcd(M_i, m_i) = 1$。由贝祖定理，存在 $y_i$ 使得 $M_i y_i \equiv 1 \pmod{m_i}$。令 $x = \sum_{i=1}^k a_i M_i y_i$，则：
$$x \equiv a_i M_i y_i \equiv a_i \pmod{m_i}$$
对所有 $i$ 成立。

唯一性：如果 $x_1, x_2$ 都是解，则 $x_1 \equiv x_2 \pmod{m_i}$ 对所有 $i$ 成立。由于 $m_i$ 两两互素，所以 $x_1 \equiv x_2 \pmod{M}$。

## 5. 欧拉函数与费马小定理

### 5.1 欧拉函数

**定义 5.1.1 (欧拉函数)**
欧拉函数 $\phi(n)$ 定义为小于 $n$ 且与 $n$ 互素的正整数的个数。

**定理 5.1.1 (欧拉函数的性质)**
对于素数 $p$，$\phi(p) = p - 1$。

**定理 5.1.2 (欧拉函数的积性)**
如果 $\gcd(m, n) = 1$，则 $\phi(mn) = \phi(m)\phi(n)$。

**证明**: 使用中国剩余定理，$\mathbb{Z}_{mn} \cong \mathbb{Z}_m \times \mathbb{Z}_n$。

**定理 5.1.3 (欧拉函数的公式)**
如果 $n = p_1^{a_1} p_2^{a_2} \cdots p_k^{a_k}$，则：
$$\phi(n) = n \prod_{i=1}^k \left(1 - \frac{1}{p_i}\right)$$

**证明**: 使用积性和 $\phi(p^a) = p^a - p^{a-1}$。

### 5.2 费马小定理

**定理 5.2.1 (费马小定理)**
如果 $p$ 是素数且 $p \nmid a$，则：
$$a^{p-1} \equiv 1 \pmod{p}$$

**证明**: 考虑集合 $\{a, 2a, 3a, \ldots, (p-1)a\}$。这些数模 $p$ 互不相同且都不为0，因此它们构成模 $p$ 的完全剩余系。所以：
$$a \cdot 2a \cdot 3a \cdots (p-1)a \equiv 1 \cdot 2 \cdot 3 \cdots (p-1) \pmod{p}$$
即 $a^{p-1}(p-1)! \equiv (p-1)! \pmod{p}$。由于 $\gcd(p, (p-1)!) = 1$，$a^{p-1} \equiv 1 \pmod{p}$。

### 5.3 欧拉定理

**定理 5.3.1 (欧拉定理)**
如果 $\gcd(a, n) = 1$，则：
$$a^{\phi(n)} \equiv 1 \pmod{n}$$

**证明**: 类似费马小定理的证明，考虑与 $n$ 互素的数的集合。

## 6. 二次剩余理论

### 6.1 二次剩余的定义

**定义 6.1.1 (二次剩余)**
如果存在整数 $x$ 使得 $x^2 \equiv a \pmod{p}$，则称 $a$ 是模 $p$ 的二次剩余。

**定义 6.1.2 (勒让德符号)**
勒让德符号 $\left(\frac{a}{p}\right)$ 定义为：
$$\left(\frac{a}{p}\right) = \begin{cases}
1 & \text{如果 } a \text{ 是模 } p \text{ 的二次剩余} \\
-1 & \text{如果 } a \text{ 不是模 } p \text{ 的二次剩余} \\
0 & \text{如果 } p \mid a
\end{cases}$$

### 6.2 二次互反律

**定理 6.2.1 (欧拉判别法)**
对于奇素数 $p$ 和 $\gcd(a, p) = 1$：
$$\left(\frac{a}{p}\right) \equiv a^{(p-1)/2} \pmod{p}$$

**定理 6.2.2 (二次互反律)**
对于不同的奇素数 $p, q$：
$$\left(\frac{p}{q}\right) \left(\frac{q}{p}\right) = (-1)^{(p-1)(q-1)/4}$$

**定理 6.2.3 (补充定理)**
1. $\left(\frac{-1}{p}\right) = (-1)^{(p-1)/2}$
2. $\left(\frac{2}{p}\right) = (-1)^{(p^2-1)/8}$

### 6.3 雅可比符号

**定义 6.3.1 (雅可比符号)**
对于奇数 $n = p_1^{e_1} p_2^{e_2} \cdots p_k^{e_k}$：
$$\left(\frac{a}{n}\right) = \left(\frac{a}{p_1}\right)^{e_1} \left(\frac{a}{p_2}\right)^{e_2} \cdots \left(\frac{a}{p_k}\right)^{e_k}$$

## 7. 连分数理论

### 7.1 连分数的定义

**定义 7.1.1 (连分数)**
形如 $[a_0; a_1, a_2, \ldots] = a_0 + \frac{1}{a_1 + \frac{1}{a_2 + \cdots}}$ 的表达式称为连分数。

**定义 7.1.2 (有限连分数)**
如果连分数只有有限项，则称为有限连分数。

**定理 7.1.1 (有理数的连分数表示)**
每个有理数都有唯一的有限连分数表示。

### 7.2 连分数的性质

**定理 7.2.1 (连分数的收敛性)**
无限连分数的收敛子序列收敛到无理数。

**定理 7.2.2 (最佳逼近)**
连分数的收敛子是实数的最佳有理逼近。

**定理 7.2.3 (周期性)**
二次无理数的连分数展开是周期的。

## 8. 数论函数

### 8.1 基本数论函数

**定义 8.1.1 (除数函数)**
$\tau(n)$ 表示 $n$ 的正因子个数。

**定义 8.1.2 (因子和函数)**
$\sigma(n)$ 表示 $n$ 的所有正因子之和。

**定义 8.1.3 (莫比乌斯函数)**
$$\mu(n) = \begin{cases}
1 & \text{如果 } n = 1 \\
(-1)^k & \text{如果 } n \text{ 是 } k \text{ 个不同素数的乘积} \\
0 & \text{如果 } n \text{ 有平方因子}
\end{cases}$$

### 8.2 积性函数

**定义 8.2.1 (积性函数)**
数论函数 $f$ 是积性的，如果对于互素的整数 $m, n$，有 $f(mn) = f(m)f(n)$。

**定理 8.2.1 (积性函数的性质)**
如果 $f$ 是积性函数，且 $n = p_1^{e_1} p_2^{e_2} \cdots p_k^{e_k}$，则：
$$f(n) = f(p_1^{e_1}) f(p_2^{e_2}) \cdots f(p_k^{e_k})$$

### 8.3 狄利克雷卷积

**定义 8.3.1 (狄利克雷卷积)**
两个数论函数 $f$ 和 $g$ 的狄利克雷卷积定义为：
$$(f * g)(n) = \sum_{d \mid n} f(d) g\left(\frac{n}{d}\right)$$

**定理 8.3.1 (莫比乌斯反演)**
设 $f, g$ 是数论函数，则：
$$g(n) = \sum_{d \mid n} f(d) \iff f(n) = \sum_{d \mid n} \mu(d) g\left(\frac{n}{d}\right)$$

## 9. 应用与联系

### 9.1 在密码学中的应用

1. **RSA算法**: 基于大数分解的困难性
2. **椭圆曲线密码**: 基于椭圆曲线上的离散对数问题
3. **数字签名**: 基于数论函数的单向性

### 9.2 在计算机科学中的应用

1. **伪随机数生成**: 基于线性同余
2. **哈希函数**: 基于模运算
3. **编码理论**: 基于有限域理论

### 9.3 在数学其他分支中的应用

1. **代数数论**: 研究代数数域中的整数
2. **解析数论**: 使用分析方法研究数论问题
3. **组合数论**: 研究数论中的组合问题

## 参考文献

1. Hardy, G. H., & Wright, E. M. (2008). An introduction to the theory of numbers. Oxford University Press.
2. Niven, I., Zuckerman, H. S., & Montgomery, H. L. (1991). An introduction to the theory of numbers. John Wiley & Sons.
3. Apostol, T. M. (1976). Introduction to analytic number theory. Springer.
4. Ireland, K., & Rosen, M. (1990). A classical introduction to modern number theory. Springer.

---

**最后更新**: 2024-12-19
**状态**: 基础理论完成，需要进一步扩展应用部分
