# 数论基础理论

## 目录

1. [引言](#1-引言)
2. [整除理论](#2-整除理论)
3. [同余理论](#3-同余理论)
4. [素数理论](#4-素数理论)
5. [二次剩余](#5-二次剩余)
6. [连分数](#6-连分数)
7. [数论函数](#7-数论函数)
8. [应用与实例](#8-应用与实例)
9. [习题与练习](#9-习题与练习)

---

## 1. 引言

数论是研究整数性质的数学分支，它是数学中最古老的分支之一，也是最纯粹的分支之一。数论不仅具有深厚的理论价值，在现代密码学、计算机科学等领域也有重要应用。

### 1.1 历史背景

数论的发展历程：

- **古希腊时期**: 毕达哥拉斯学派研究完全数、亲和数
- **欧几里得时代**: 证明素数无穷多，欧几里得算法
- **17世纪**: 费马提出费马小定理和大定理
- **18世纪**: 欧拉、拉格朗日等发展数论
- **19世纪**: 高斯、狄利克雷等建立现代数论
- **20世纪**: 朗兰兹纲领统一数论

### 1.2 数论的重要性

1. **理论价值**: 研究数学的基本结构
2. **应用广泛**: 密码学、编码理论、计算机科学
3. **教育价值**: 培养逻辑思维和证明能力
4. **美学价值**: 数学美的典型体现

---

## 2. 整除理论

### 2.1 整除的定义

**定义 2.1.1** (整除)
设 $a, b \in \mathbb{Z}$，如果存在 $q \in \mathbb{Z}$ 使得 $b = aq$，则称 $a$ 整除 $b$，记作 $a \mid b$。

**性质**:

1. **自反性**: $a \mid a$
2. **传递性**: 如果 $a \mid b$ 且 $b \mid c$，则 $a \mid c$
3. **线性组合**: 如果 $a \mid b$ 且 $a \mid c$，则 $a \mid (mb + nc)$

### 2.2 最大公约数

**定义 2.2.1** (最大公约数)
设 $a, b \in \mathbb{Z}$，不全为零，$d$ 是 $a$ 和 $b$ 的公约数，如果对任意公约数 $c$ 都有 $c \mid d$，则称 $d$ 为 $a$ 和 $b$ 的最大公约数，记作 $\gcd(a, b)$。

**定理 2.2.2** (贝祖定理)
设 $a, b \in \mathbb{Z}$，不全为零，则存在 $x, y \in \mathbb{Z}$ 使得：
$$\gcd(a, b) = ax + by$$

**证明**:
设 $S = \{ax + by \mid x, y \in \mathbb{Z}, ax + by > 0\}$，则 $S$ 非空（因为 $a^2 + b^2 > 0$）。
由良序原理，$S$ 有最小元素 $d = ax_0 + by_0$。
我们证明 $d = \gcd(a, b)$：

1. **$d$ 是公约数**: 设 $a = dq + r$，$0 \leq r < d$，则：
   $$r = a - dq = a - (ax_0 + by_0)q = a(1 - x_0q) + b(-y_0q)$$
   如果 $r > 0$，则 $r \in S$，与 $d$ 的最小性矛盾。因此 $r = 0$，即 $d \mid a$。
   同理 $d \mid b$。

2. **$d$ 是最大公约数**: 设 $c$ 是 $a$ 和 $b$ 的任意公约数，则 $c \mid (ax_0 + by_0) = d$。

### 2.3 欧几里得算法

**算法 2.3.1** (欧几里得算法)
设 $a, b \in \mathbb{Z}$，$b \neq 0$，则：
$$\gcd(a, b) = \gcd(b, a \bmod b)$$

**证明**:
设 $a = bq + r$，$0 \leq r < |b|$，则：

1. 如果 $d \mid a$ 且 $d \mid b$，则 $d \mid r = a - bq$
2. 如果 $d \mid b$ 且 $d \mid r$，则 $d \mid a = bq + r$

因此 $a$ 和 $b$ 的公约数集合等于 $b$ 和 $r$ 的公约数集合，所以最大公约数相等。

**扩展欧几里得算法**:
在计算 $\gcd(a, b)$ 的同时，可以求出贝祖等式中的系数 $x, y$。

---

## 3. 同余理论

### 3.1 同余的定义

**定义 3.1.1** (同余)
设 $a, b, m \in \mathbb{Z}$，$m > 0$，如果 $m \mid (a - b)$，则称 $a$ 与 $b$ 模 $m$ 同余，记作 $a \equiv b \pmod{m}$。

**性质**:

1. **自反性**: $a \equiv a \pmod{m}$
2. **对称性**: 如果 $a \equiv b \pmod{m}$，则 $b \equiv a \pmod{m}$
3. **传递性**: 如果 $a \equiv b \pmod{m}$ 且 $b \equiv c \pmod{m}$，则 $a \equiv c \pmod{m}$

### 3.2 同余的运算

**定理 3.2.1** (同余运算)
设 $a \equiv b \pmod{m}$，$c \equiv d \pmod{m}$，则：

1. $a + c \equiv b + d \pmod{m}$
2. $a - c \equiv b - d \pmod{m}$
3. $ac \equiv bd \pmod{m}$
4. 如果 $\gcd(c, m) = 1$，则 $ac \equiv bc \pmod{m}$ 当且仅当 $a \equiv b \pmod{m}$

### 3.3 中国剩余定理

**定理 3.3.1** (中国剩余定理)
设 $m_1, m_2, \ldots, m_k$ 是两两互素的正整数，$a_1, a_2, \ldots, a_k$ 是任意整数，则同余方程组：
$$\begin{cases}
x \equiv a_1 \pmod{m_1} \\
x \equiv a_2 \pmod{m_2} \\
\vdots \\
x \equiv a_k \pmod{m_k}
\end{cases}$$
在模 $M = m_1m_2 \cdots m_k$ 下有唯一解。

**证明**:
设 $M_i = M/m_i$，则 $\gcd(M_i, m_i) = 1$。
由贝祖定理，存在 $y_i$ 使得 $M_i y_i \equiv 1 \pmod{m_i}$。
令 $x = \sum_{i=1}^k a_i M_i y_i$，则：
$$x \equiv a_i M_i y_i \equiv a_i \pmod{m_i}$$
对所有 $i$ 成立。

唯一性：如果 $x_1, x_2$ 都是解，则 $x_1 \equiv x_2 \pmod{m_i}$ 对所有 $i$ 成立。
由于 $m_i$ 两两互素，所以 $x_1 \equiv x_2 \pmod{M}$。

---

## 4. 素数理论

### 4.1 素数的定义

**定义 4.1.1** (素数)
大于1的整数 $p$ 称为素数，如果它的正因子只有1和 $p$ 本身。

**定义 4.1.2** (合数)
大于1的整数如果不是素数，则称为合数。

### 4.2 素数的基本性质

**定理 4.2.1** (素数无穷多)
素数有无穷多个。

**证明** (欧几里得方法):
假设素数只有有限个：$p_1, p_2, \ldots, p_n$。
令 $N = p_1p_2 \cdots p_n + 1$，则 $N > 1$。
如果 $N$ 是素数，则与假设矛盾。
如果 $N$ 是合数，则 $N$ 有素因子 $p$，但 $p \neq p_i$（因为 $p_i \nmid N$），与假设矛盾。

**定理 4.2.2** (算术基本定理)
每个大于1的整数都可以唯一地表示为素数的乘积（不计顺序）。

**证明**:
存在性：对 $n$ 用数学归纳法。
唯一性：假设 $n = p_1p_2 \cdots p_k = q_1q_2 \cdots q_l$，则 $p_1 \mid q_1q_2 \cdots q_l$。
由于 $p_1$ 是素数，所以 $p_1 \mid q_i$ 对某个 $i$。
因此 $p_1 = q_i$，约去后继续归纳。

### 4.3 素数分布

**定理 4.3.1** (素数定理)
设 $\pi(x)$ 表示不超过 $x$ 的素数个数，则：
$$\lim_{x \to \infty} \frac{\pi(x)}{x/\ln x} = 1$$

**定理 4.3.2** (伯特兰假设)
对任意 $n > 1$，存在素数 $p$ 使得 $n < p < 2n$。

---

## 5. 二次剩余

### 5.1 二次剩余的定义

**定义 5.1.1** (二次剩余)
设 $a, p \in \mathbb{Z}$，$p$ 是奇素数，$\gcd(a, p) = 1$。
如果存在 $x \in \mathbb{Z}$ 使得 $x^2 \equiv a \pmod{p}$，则称 $a$ 是模 $p$ 的二次剩余，否则称为二次非剩余。

**定义 5.1.2** (勒让德符号)
设 $p$ 是奇素数，$a \in \mathbb{Z}$，勒让德符号定义为：
$$\left(\frac{a}{p}\right) = \begin{cases}
1 & \text{如果 } a \text{ 是模 } p \text{ 的二次剩余} \\
-1 & \text{如果 } a \text{ 是模 } p \text{ 的二次非剩余} \\
0 & \text{如果 } p \mid a
\end{cases}$$

### 5.2 二次互反律

**定理 5.2.1** (二次互反律)
设 $p, q$ 是不同的奇素数，则：
$$\left(\frac{p}{q}\right)\left(\frac{q}{p}\right) = (-1)^{\frac{p-1}{2} \cdot \frac{q-1}{2}}$$

**定理 5.2.2** (欧拉判别法)
设 $p$ 是奇素数，$\gcd(a, p) = 1$，则：
$$\left(\frac{a}{p}\right) \equiv a^{\frac{p-1}{2}} \pmod{p}$$

### 5.3 雅可比符号

**定义 5.3.1** (雅可比符号)
设 $n$ 是正奇数，$n = p_1^{e_1}p_2^{e_2} \cdots p_k^{e_k}$，$a \in \mathbb{Z}$，则：
$$\left(\frac{a}{n}\right) = \left(\frac{a}{p_1}\right)^{e_1}\left(\frac{a}{p_2}\right)^{e_2} \cdots \left(\frac{a}{p_k}\right)^{e_k}$$

---

## 6. 连分数

### 6.1 连分数的定义

**定义 6.1.1** (简单连分数)
形如：
$$a_0 + \frac{1}{a_1 + \frac{1}{a_2 + \frac{1}{a_3 + \ddots}}}$$
的表达式称为简单连分数，记作 $[a_0; a_1, a_2, a_3, \ldots]$。

**定义 6.1.2** (渐近分数)
连分数 $[a_0; a_1, a_2, \ldots]$ 的第 $n$ 个渐近分数定义为：
$$\frac{p_n}{q_n} = [a_0; a_1, a_2, \ldots, a_n]$$

### 6.2 连分数的性质

**定理 6.2.1** (递推公式)
设 $\frac{p_n}{q_n}$ 是连分数的第 $n$ 个渐近分数，则：
$$\begin{cases}
p_n = a_n p_{n-1} + p_{n-2} \\
q_n = a_n q_{n-1} + q_{n-2}
\end{cases}$$
其中 $p_{-1} = 1$, $p_0 = a_0$, $q_{-1} = 0$, $q_0 = 1$。

**定理 6.2.2** (误差估计)
$$\left|\alpha - \frac{p_n}{q_n}\right| < \frac{1}{q_n^2}$$

### 6.3 无理数的连分数展开

**定理 6.3.1**
每个无理数都有唯一的无限简单连分数展开。

**定理 6.3.2**
二次无理数的连分数展开是周期的。

---

## 7. 数论函数

### 7.1 基本数论函数

**定义 7.1.1** (除数函数)
$\tau(n)$ 表示 $n$ 的正因子个数。

**定义 7.1.2** (因子和函数)
$\sigma(n)$ 表示 $n$ 的所有正因子之和。

**定义 7.1.3** (欧拉函数)
$\phi(n)$ 表示不超过 $n$ 且与 $n$ 互素的整数个数。

### 7.2 积性函数

**定义 7.2.1** (积性函数)
数论函数 $f$ 称为积性函数，如果对任意互素的正整数 $m, n$，有 $f(mn) = f(m)f(n)$。

**定理 7.2.2**
如果 $f$ 是积性函数，且 $n = p_1^{e_1}p_2^{e_2} \cdots p_k^{e_k}$，则：
$$f(n) = f(p_1^{e_1})f(p_2^{e_2}) \cdots f(p_k^{e_k})$$

### 7.3 默比乌斯函数

**定义 7.3.1** (默比乌斯函数)
$$\mu(n) = \begin{cases}
1 & \text{如果 } n = 1 \\
(-1)^k & \text{如果 } n \text{ 是 } k \text{ 个不同素数的乘积} \\
0 & \text{如果 } n \text{ 有平方因子}
\end{cases}$$

**定理 7.3.2** (默比乌斯反演)
设 $f, g$ 是数论函数，则：
$$g(n) = \sum_{d \mid n} f(d) \iff f(n) = \sum_{d \mid n} \mu(d)g\left(\frac{n}{d}\right)$$

---

## 8. 应用与实例

### 8.1 密码学应用

**RSA算法**:
1. 选择两个大素数 $p, q$
2. 计算 $n = pq$, $\phi(n) = (p-1)(q-1)$
3. 选择 $e$ 使得 $\gcd(e, \phi(n)) = 1$
4. 计算 $d$ 使得 $ed \equiv 1 \pmod{\phi(n)}$
5. 公钥：$(n, e)$，私钥：$(n, d)$

**椭圆曲线密码学**:
基于椭圆曲线上的点群结构，利用离散对数问题的困难性。

### 8.2 编码理论应用

**纠错码**:
利用有限域上的多项式理论构造纠错码。

**哈希函数**:
利用模运算和素数性质构造哈希函数。

### 8.3 计算机科学应用

**随机数生成**:
利用线性同余法生成伪随机数。

**算法优化**:
利用数论性质优化算法复杂度。

---

## 9. 习题与练习

### 9.1 基础练习

1. 证明：如果 $a \mid b$ 且 $b \mid c$，则 $a \mid c$
2. 求 $\gcd(48, 18)$ 和对应的贝祖系数
3. 解同余方程 $3x \equiv 2 \pmod{7}$

### 9.2 中等练习

1. 证明：费马小定理 $a^p \equiv a \pmod{p}$
2. 求模13的二次剩余
3. 求 $\sqrt{2}$ 的连分数展开

### 9.3 高级练习

1. 证明：二次互反律
2. 研究素数分布
3. 分析RSA算法的安全性

---

## 参考文献

1. Hardy, G. H., & Wright, E. M. (2008). An introduction to the theory of numbers. Oxford University Press.
2. Niven, I., Zuckerman, H. S., & Montgomery, H. L. (1991). An introduction to the theory of numbers. John Wiley & Sons.
3. Apostol, T. M. (1976). Introduction to analytic number theory. Springer-Verlag.
4. Ireland, K., & Rosen, M. (1990). A classical introduction to modern number theory. Springer-Verlag.

---

**最后更新**: 2024年12月  
**版本**: 1.0  
**状态**: 完成基础理论部分
