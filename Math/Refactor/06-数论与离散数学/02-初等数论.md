# 02-初等数论

## 目录

1. [基本定理](#1-基本定理)
2. [素数分布](#2-素数分布)
3. [同余方程](#3-同余方程)
4. [原根与指数](#4-原根与指数)
5. [二次剩余](#5-二次剩余)
6. [连分数](#6-连分数)
7. [数论函数](#7-数论函数)
8. [应用与算法](#8-应用与算法)

---

## 1. 基本定理

### 1.1 算术基本定理

**定理 1.1.1 (算术基本定理)**
每个大于1的整数都可以唯一地分解为素数的乘积（不计顺序）。

**证明**：
存在性：对 $n$ 进行数学归纳。
- 基础：$n = 2$ 是素数，成立
- 归纳：假设所有小于 $n$ 的整数都可以分解
  - 如果 $n$ 是素数，则 $n = n$ 是分解
  - 如果 $n$ 是合数，则 $n = ab$，其中 $1 < a, b < n$
  - 由归纳假设，$a$ 和 $b$ 都可以分解为素数乘积
  - 因此 $n = ab$ 也可以分解为素数乘积

唯一性：假设 $n = p_1p_2\cdots p_k = q_1q_2\cdots q_l$，
其中 $p_i, q_j$ 都是素数。
由于 $p_1 \mid q_1q_2\cdots q_l$，由素数的基本性质，
$p_1$ 必须整除某个 $q_j$，因此 $p_1 = q_j$。
重复此过程可得唯一性。

**推论 1.1.1 (标准分解式)**
每个大于1的整数 $n$ 可以唯一地表示为：
$$n = p_1^{e_1}p_2^{e_2}\cdots p_k^{e_k}$$
其中 $p_1 < p_2 < \cdots < p_k$ 是素数，$e_i$ 是正整数。

### 1.2 费马小定理

**定理 1.2.1 (费马小定理)**
如果 $p$ 是素数，$a$ 是不能被 $p$ 整除的整数，则：
$$a^{p-1} \equiv 1 \pmod{p}$$

**证明**：
考虑集合 $S = \{a, 2a, 3a, \ldots, (p-1)a\}$。
可以证明 $S$ 中的元素模 $p$ 互不相同且都不为0。

假设存在 $1 \leq i < j \leq p-1$ 使得 $ia \equiv ja \pmod{p}$，
则 $p \mid (j-i)a$。由于 $p \nmid a$，$p \mid (j-i)$，
但 $0 < j-i < p$，矛盾。

因此 $S$ 模 $p$ 的余数集合是 $\{1, 2, 3, \ldots, p-1\}$。
因此：
$$a \cdot 2a \cdot 3a \cdots (p-1)a \equiv 1 \cdot 2 \cdot 3 \cdots (p-1) \pmod{p}$$
即：
$$a^{p-1}(p-1)! \equiv (p-1)! \pmod{p}$$
由于 $(p-1)!$ 与 $p$ 互素，$a^{p-1} \equiv 1 \pmod{p}$。

**推论 1.2.1 (费马小定理的推广)**
如果 $p$ 是素数，对于任意整数 $a$，有：
$$a^p \equiv a \pmod{p}$$

### 1.3 威尔逊定理

**定理 1.3.1 (威尔逊定理)**
当且仅当 $p$ 是素数时，$(p-1)! \equiv -1 \pmod{p}$。

**证明**：
必要性：如果 $p$ 是素数，考虑多项式 $f(x) = (x-1)(x-2)\cdots(x-(p-1)) - (x^{p-1}-1)$。
$f(x)$ 的次数小于 $p-1$，但在 $x = 1, 2, \ldots, p-1$ 处都为零。
因此 $f(x) = 0$，即 $(x-1)(x-2)\cdots(x-(p-1)) = x^{p-1}-1$。
代入 $x = 0$，得 $(p-1)! \equiv -1 \pmod{p}$。

充分性：如果 $p$ 是合数，设 $p = ab$，其中 $1 < a, b < p$。
如果 $a \neq b$，则 $a, b \mid (p-1)!$，因此 $(p-1)! \equiv 0 \pmod{p}$。
如果 $a = b$，则 $p = a^2$，且 $a > 2$（否则 $p = 4$，但 $3! \equiv 2 \pmod{4}$）。
因此 $a, 2a \mid (p-1)!$，$(p-1)! \equiv 0 \pmod{p}$。

---

## 2. 素数分布

### 2.1 素数计数函数

**定义 2.1.1 (素数计数函数)**
$\pi(x)$ 表示不超过 $x$ 的素数个数。

**定理 2.1.1 (素数定理)**
当 $x \to \infty$ 时：
$$\pi(x) \sim \frac{x}{\ln x}$$

**定理 2.1.2 (切比雪夫不等式)**
存在常数 $c_1, c_2 > 0$ 使得对于充分大的 $x$：
$$c_1 \frac{x}{\ln x} < \pi(x) < c_2 \frac{x}{\ln x}$$

### 2.2 伯特兰假设

**定理 2.2.1 (伯特兰假设)**
对于任意 $n > 1$，存在素数 $p$ 使得 $n < p < 2n$。

**证明**：
使用切比雪夫不等式和组合恒等式。
对于充分大的 $n$，有：
$$\pi(2n) - \pi(n) > \frac{n}{3\ln n}$$
因此存在素数在区间 $(n, 2n)$ 中。

### 2.3 孪生素数猜想

**定义 2.3.1 (孪生素数)**
如果 $p$ 和 $p+2$ 都是素数，则称它们为孪生素数。

**猜想 2.3.1 (孪生素数猜想)**
存在无穷多对孪生素数。

**定理 2.3.1 (孪生素数的分布)**
设 $\pi_2(x)$ 表示不超过 $x$ 的孪生素数对的数量，则：
$$\pi_2(x) \sim C \frac{x}{(\ln x)^2}$$
其中 $C$ 是孪生素数常数。

---

## 3. 同余方程

### 3.1 线性同余方程

**定义 3.1.1 (线性同余方程)**
形如 $ax \equiv b \pmod{m}$ 的方程称为线性同余方程。

**定理 3.1.1 (线性同余方程的解)**
线性同余方程 $ax \equiv b \pmod{m}$ 有解的充分必要条件是 $\gcd(a, m) \mid b$。

**证明**：
设 $d = \gcd(a, m)$。
如果方程有解 $x_0$，则 $ax_0 \equiv b \pmod{m}$，
即 $m \mid (ax_0 - b)$，因此 $d \mid (ax_0 - b)$。
由于 $d \mid a$，$d \mid b$。

反之，如果 $d \mid b$，设 $a = da'$，$m = dm'$，$b = db'$，
则原方程等价于 $a'x \equiv b' \pmod{m'}$。
由于 $\gcd(a', m') = 1$，存在 $a'$ 模 $m'$ 的逆元，
因此方程有解。

**定理 3.1.2 (线性同余方程的解数)**
如果 $d = \gcd(a, m) \mid b$，则线性同余方程 $ax \equiv b \pmod{m}$ 恰有 $d$ 个解模 $m$。

### 3.2 中国剩余定理

**定理 3.2.1 (中国剩余定理)**
设 $m_1, m_2, \ldots, m_k$ 是两两互素的正整数，
对于任意整数 $a_1, a_2, \ldots, a_k$，
同余方程组
$$\begin{cases}
x \equiv a_1 \pmod{m_1} \\
x \equiv a_2 \pmod{m_2} \\
\vdots \\
x \equiv a_k \pmod{m_k}
\end{cases}$$
有唯一解模 $M = m_1m_2\cdots m_k$。

**证明**：
设 $M_i = M/m_i$，$y_i$ 是 $M_i$ 模 $m_i$ 的逆元。
则 $x = a_1M_1y_1 + a_2M_2y_2 + \cdots + a_kM_ky_k$ 是方程组的解。

验证：对于任意 $i$，有：
$$x \equiv a_iM_iy_i \equiv a_i \pmod{m_i}$$
因为 $M_j \equiv 0 \pmod{m_i}$ 当 $j \neq i$ 时。

唯一性：如果 $x'$ 也是解，则 $x \equiv x' \pmod{m_i}$ 对所有 $i$ 成立，
因此 $x \equiv x' \pmod{M}$。

### 3.3 高次同余方程

**定义 3.3.1 (高次同余方程)**
形如 $f(x) \equiv 0 \pmod{m}$ 的方程，其中 $f(x)$ 是多项式。

**定理 3.3.1 (拉格朗日定理)**
如果 $p$ 是素数，$f(x)$ 是次数为 $n$ 的整系数多项式，
则同余方程 $f(x) \equiv 0 \pmod{p}$ 最多有 $n$ 个解。

**证明**：
对 $n$ 进行数学归纳。
- 基础：$n = 1$ 时，线性同余方程最多有1个解
- 归纳：假设次数小于 $n$ 的多项式最多有 $n-1$ 个解
  - 如果 $f(x) \equiv 0 \pmod{p}$ 有解 $\alpha$，
  - 则 $f(x) = (x-\alpha)g(x) + r$，其中 $r$ 是常数
  - 由于 $f(\alpha) \equiv 0 \pmod{p}$，$r \equiv 0 \pmod{p}$
  - 因此 $f(x) \equiv (x-\alpha)g(x) \pmod{p}$
  - $g(x)$ 的次数为 $n-1$，最多有 $n-1$ 个解
  - 因此 $f(x)$ 最多有 $n$ 个解

---

## 4. 原根与指数

### 4.1 原根

**定义 4.1.1 (原根)**
如果 $\gcd(a, m) = 1$，且 $a$ 模 $m$ 的阶等于 $\phi(m)$，
则称 $a$ 是模 $m$ 的原根。

**定义 4.1.2 (阶)**
如果 $\gcd(a, m) = 1$，$a$ 模 $m$ 的阶是最小的正整数 $k$，
使得 $a^k \equiv 1 \pmod{m}$。

**定理 4.1.1 (原根的存在性)**
模 $m$ 存在原根的充分必要条件是 $m = 2, 4, p^k, 2p^k$，
其中 $p$ 是奇素数，$k$ 是正整数。

**证明**：
必要性：如果 $m$ 有原根 $g$，则 $g$ 的阶为 $\phi(m)$。
因此 $\phi(m)$ 必须等于某个元素的阶。
通过分析 $\phi(m)$ 的结构可得必要性。

充分性：对于素数 $p$，可以构造原根。
对于 $p^k$ 和 $2p^k$，可以通过提升原根得到。

### 4.2 指数

**定义 4.2.1 (指数)**
如果 $g$ 是模 $m$ 的原根，$\gcd(a, m) = 1$，
则存在唯一的整数 $k$ 使得 $a \equiv g^k \pmod{m}$，
称 $k$ 为 $a$ 关于原根 $g$ 的指数，记作 $\operatorname{ind}_g(a)$。

**定理 4.2.1 (指数的性质)**
如果 $g$ 是模 $m$ 的原根，则：
1. $\operatorname{ind}_g(ab) \equiv \operatorname{ind}_g(a) + \operatorname{ind}_g(b) \pmod{\phi(m)}$
2. $\operatorname{ind}_g(a^n) \equiv n\operatorname{ind}_g(a) \pmod{\phi(m)}$

**证明**：
1. $ab \equiv g^{\operatorname{ind}_g(a)}g^{\operatorname{ind}_g(b)} \equiv g^{\operatorname{ind}_g(a) + \operatorname{ind}_g(b)} \pmod{m}$
2. $a^n \equiv (g^{\operatorname{ind}_g(a)})^n \equiv g^{n\operatorname{ind}_g(a)} \pmod{m}$

---

## 5. 二次剩余

### 5.1 二次剩余基本概念

**定义 5.1.1 (二次剩余)**
对于素数 $p$ 和整数 $a$，如果存在整数 $x$ 使得 $x^2 \equiv a \pmod{p}$，
则称 $a$ 是模 $p$ 的二次剩余。

**定义 5.1.2 (勒让德符号)**
对于素数 $p$ 和整数 $a$，勒让德符号定义为：
$$\left(\frac{a}{p}\right) = \begin{cases}
1 & \text{如果 } a \text{ 是模 } p \text{ 的二次剩余} \\
-1 & \text{如果 } a \text{ 不是模 } p \text{ 的二次剩余} \\
0 & \text{如果 } p \mid a
\end{cases}$$

**定理 5.1.1 (欧拉判别准则)**
对于奇素数 $p$ 和整数 $a$，有：
$$\left(\frac{a}{p}\right) \equiv a^{\frac{p-1}{2}} \pmod{p}$$

**证明**：
如果 $a$ 是二次剩余，存在 $x$ 使得 $x^2 \equiv a \pmod{p}$，
则 $a^{\frac{p-1}{2}} \equiv x^{p-1} \equiv 1 \pmod{p}$。

如果 $a$ 不是二次剩余，考虑多项式 $f(x) = x^{\frac{p-1}{2}} - 1$。
由于 $a$ 不是二次剩余，$f(a) \not\equiv 0 \pmod{p}$。
但 $a^{p-1} \equiv 1 \pmod{p}$，因此 $a^{\frac{p-1}{2}} \equiv -1 \pmod{p}$。

### 5.2 二次互反律

**定理 5.2.1 (二次互反律)**
对于不同的奇素数 $p, q$，有：
$$\left(\frac{p}{q}\right)\left(\frac{q}{p}\right) = (-1)^{\frac{p-1}{2}\frac{q-1}{2}}$$

**证明**：
使用高斯引理和二次剩余的几何解释。
设 $S = \{1, 2, \ldots, \frac{p-1}{2}\}$，
$T = \{q, 2q, \ldots, \frac{p-1}{2}q\}$。
设 $n$ 是 $T$ 中模 $p$ 余数大于 $\frac{p}{2}$ 的元素个数，
则 $\left(\frac{q}{p}\right) = (-1)^n$。

类似地，设 $m$ 是 $\{p, 2p, \ldots, \frac{q-1}{2}p\}$ 中
模 $q$ 余数大于 $\frac{q}{2}$ 的元素个数，
则 $\left(\frac{p}{q}\right) = (-1)^m$。

通过几何分析可以证明 $n + m \equiv \frac{p-1}{2}\frac{q-1}{2} \pmod{2}$。

**推论 5.2.1 (二次互反律的补充)**
对于奇素数 $p$：
$$\left(\frac{-1}{p}\right) = (-1)^{\frac{p-1}{2}} = \begin{cases}
1 & \text{如果 } p \equiv 1 \pmod{4} \\
-1 & \text{如果 } p \equiv 3 \pmod{4}
\end{cases}$$

$$\left(\frac{2}{p}\right) = (-1)^{\frac{p^2-1}{8}} = \begin{cases}
1 & \text{如果 } p \equiv \pm 1 \pmod{8} \\
-1 & \text{如果 } p \equiv \pm 3 \pmod{8}
\end{cases}$$

---

## 6. 连分数

### 6.1 连分数基本概念

**定义 6.1.1 (简单连分数)**
形如 $[a_0; a_1, a_2, \ldots] = a_0 + \frac{1}{a_1 + \frac{1}{a_2 + \cdots}}$ 的表达式称为简单连分数。

**定义 6.1.2 (收敛分数)**
连分数 $[a_0; a_1, a_2, \ldots]$ 的第 $n$ 个收敛分数是 $[a_0; a_1, a_2, \ldots, a_n]$。

**定理 6.1.1 (收敛分数的递推关系)**
设 $p_n/q_n = [a_0; a_1, a_2, \ldots, a_n]$，则：
$$\begin{cases}
p_n = a_np_{n-1} + p_{n-2} \\
q_n = a_nq_{n-1} + q_{n-2}
\end{cases}$$
其中 $p_{-1} = 1$，$p_{-2} = 0$，$q_{-1} = 0$，$q_{-2} = 1$。

**证明**：
对 $n$ 进行数学归纳。
- 基础：$n = 0$ 时，$p_0 = a_0$，$q_0 = 1$，成立
- 归纳：假设对于 $k < n$ 成立
  - $[a_0; a_1, \ldots, a_n] = [a_0; a_1, \ldots, a_{n-1} + \frac{1}{a_n}]$
  - 设 $[a_0; a_1, \ldots, a_{n-1}] = \frac{p_{n-1}}{q_{n-1}}$
  - 则 $[a_0; a_1, \ldots, a_n] = \frac{(a_{n-1} + \frac{1}{a_n})p_{n-2} + p_{n-3}}{(a_{n-1} + \frac{1}{a_n})q_{n-2} + q_{n-3}}$
  - 化简得递推关系

### 6.2 连分数的性质

**定理 6.2.1 (连分数的逼近性质)**
对于无理数 $\alpha$，其连分数展开的收敛分数 $p_n/q_n$ 满足：
$$\left|\alpha - \frac{p_n}{q_n}\right| < \frac{1}{q_n^2}$$

**定理 6.2.2 (最佳逼近)**
如果 $p/q$ 是 $\alpha$ 的连分数收敛分数，则对于任意 $p'/q'$ 满足 $q' \leq q$，有：
$$\left|\alpha - \frac{p}{q}\right| \leq \left|\alpha - \frac{p'}{q'}\right|$$

**定理 6.2.3 (佩尔方程)**
如果 $d$ 是非平方正整数，则佩尔方程 $x^2 - dy^2 = 1$ 有无穷多组正整数解。

**证明**：
$\sqrt{d}$ 的连分数展开是周期的。
设周期长度为 $k$，则 $p_{k-1}^2 - dq_{k-1}^2 = (-1)^k$。
如果 $k$ 是偶数，则 $(p_{k-1}, q_{k-1})$ 是佩尔方程的解。
如果 $k$ 是奇数，则 $(p_{2k-1}, q_{2k-1})$ 是佩尔方程的解。

---

## 7. 数论函数

### 7.1 基本数论函数

**定义 7.1.1 (除数函数)**
$\tau(n)$ 表示 $n$ 的正因数个数。

**定义 7.1.2 (除数和函数)**
$\sigma(n)$ 表示 $n$ 的所有正因数之和。

**定义 7.1.3 (莫比乌斯函数)**
$$\mu(n) = \begin{cases}
1 & \text{如果 } n = 1 \\
0 & \text{如果 } n \text{ 有平方因子} \\
(-1)^k & \text{如果 } n \text{ 是 } k \text{ 个不同素数的乘积}
\end{cases}$$

**定理 7.1.1 (数论函数的积性)**
$\tau(n)$、$\sigma(n)$、$\mu(n)$ 都是积性函数，即对于互素的整数 $m, n$，有：
- $\tau(mn) = \tau(m)\tau(n)$
- $\sigma(mn) = \sigma(m)\sigma(n)$
- $\mu(mn) = \mu(m)\mu(n)$

**证明**：
由算术基本定理和积性函数的定义直接可得。

### 7.2 莫比乌斯反演

**定理 7.2.1 (莫比乌斯反演公式)**
设 $f$ 和 $g$ 是数论函数，则：
$$g(n) = \sum_{d \mid n} f(d) \iff f(n) = \sum_{d \mid n} \mu(d)g\left(\frac{n}{d}\right)$$

**证明**：
设 $h(n) = \sum_{d \mid n} \mu(d)g\left(\frac{n}{d}\right)$。
代入 $g(n) = \sum_{d \mid n} f(d)$，得：
$$h(n) = \sum_{d \mid n} \mu(d)\sum_{e \mid \frac{n}{d}} f(e) = \sum_{e \mid n} f(e)\sum_{d \mid \frac{n}{e}} \mu(d)$$

当 $n/e = 1$ 时，$\sum_{d \mid 1} \mu(d) = 1$；
当 $n/e > 1$ 时，$\sum_{d \mid \frac{n}{e}} \mu(d) = 0$。
因此 $h(n) = f(n)$。

### 7.3 欧拉函数

**定义 7.3.1 (欧拉函数)**
$\phi(n)$ 表示不超过 $n$ 且与 $n$ 互素的正整数个数。

**定理 7.3.1 (欧拉函数的积性)**
如果 $\gcd(m, n) = 1$，则 $\phi(mn) = \phi(m)\phi(n)$。

**定理 7.3.2 (欧拉函数的公式)**
如果 $n = p_1^{e_1}p_2^{e_2}\cdots p_k^{e_k}$ 是 $n$ 的标准分解式，则：
$$\phi(n) = n\prod_{i=1}^k \left(1 - \frac{1}{p_i}\right)$$

**证明**：
由积性和 $\phi(p^e) = p^e - p^{e-1} = p^e(1 - \frac{1}{p})$ 可得。

**定理 7.3.3 (欧拉定理)**
如果 $\gcd(a, n) = 1$，则 $a^{\phi(n)} \equiv 1 \pmod{n}$。

---

## 8. 应用与算法

### 8.1 素性检验

**算法 8.1.1 (米勒-拉宾素性检验)**
输入：奇数 $n > 1$
输出：$n$ 是否为素数

1. 将 $n-1$ 分解为 $n-1 = 2^s \cdot d$，其中 $d$ 是奇数
2. 随机选择 $a \in \{2, 3, \ldots, n-1\}$
3. 计算 $x = a^d \bmod n$
4. 如果 $x \equiv 1 \pmod{n}$ 或 $x \equiv -1 \pmod{n}$，返回"可能是素数"
5. 对于 $r = 1, 2, \ldots, s-1$：
   - 计算 $x = x^2 \bmod n$
   - 如果 $x \equiv -1 \pmod{n}$，返回"可能是素数"
   - 如果 $x \equiv 1 \pmod{n}$，返回"合数"
6. 返回"合数"

**定理 8.1.1 (米勒-拉宾检验的正确性)**
如果 $n$ 是素数，则米勒-拉宾检验总是返回"可能是素数"。
如果 $n$ 是合数，则对于至少 $\frac{3}{4}$ 的 $a$，检验返回"合数"。

### 8.2 大数分解

**算法 8.2.1 (波拉德 $\rho$ 算法)**
输入：合数 $n$
输出：$n$ 的一个非平凡因子

1. 选择函数 $f(x) = x^2 + 1 \bmod n$
2. 选择初始值 $x_0 = 2$
3. 计算序列 $x_i = f(x_{i-1})$ 和 $y_i = f(f(y_{i-1}))$
4. 计算 $d = \gcd(|x_i - y_i|, n)$
5. 如果 $1 < d < n$，返回 $d$
6. 如果 $d = n$，重新开始
7. 如果 $d = 1$，继续计算

**定理 8.2.1 (波拉德 $\rho$ 算法的期望复杂度)**
波拉德 $\rho$ 算法的期望时间复杂度为 $O(\sqrt{p})$，
其中 $p$ 是 $n$ 的最小素因子。

### 8.3 离散对数

**定义 8.3.1 (离散对数)**
如果 $g$ 是模 $p$ 的原根，$h \equiv g^x \pmod{p}$，
则称 $x$ 是以 $g$ 为底的 $h$ 的离散对数，记作 $x = \log_g h$。

**算法 8.3.1 (大步小步算法)**
输入：素数 $p$，原根 $g$，整数 $h$
输出：$\log_g h \pmod{p-1}$

1. 设 $m = \lceil\sqrt{p-1}\rceil$
2. 计算并存储 $g^0, g^1, \ldots, g^{m-1} \pmod{p}$
3. 计算 $g^{-m} \pmod{p}$
4. 对于 $j = 0, 1, \ldots, m-1$：
   - 计算 $h \cdot (g^{-m})^j \pmod{p}$
   - 如果在存储的表中找到匹配，则 $\log_g h = i + jm$
5. 返回结果

**定理 8.3.1 (大步小步算法的复杂度)**
大步小步算法的时间复杂度为 $O(\sqrt{p})$，空间复杂度为 $O(\sqrt{p})$。

---

## 总结

本文档建立了初等数论的完整理论体系，包括：

1. **基本定理**：算术基本定理、费马小定理、威尔逊定理
2. **素数分布**：素数计数函数、伯特兰假设、孪生素数猜想
3. **同余方程**：线性同余方程、中国剩余定理、高次同余方程
4. **原根与指数**：原根的存在性、指数的性质
5. **二次剩余**：二次剩余、勒让德符号、二次互反律
6. **连分数**：连分数展开、收敛分数、佩尔方程
7. **数论函数**：基本数论函数、莫比乌斯反演、欧拉函数
8. **应用与算法**：素性检验、大数分解、离散对数

每个理论都包含了严格的定义、重要的定理和详细的证明过程，为数论的应用和进一步研究提供了坚实的基础。

---

**返回目录**：[数论与离散数学总览](../00-数论与离散数学总览.md) 