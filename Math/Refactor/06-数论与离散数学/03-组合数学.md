# 组合数学

## 目录

- [组合数学](#组合数学)
  - [目录](#目录)
  - [1. 计数理论](#1-计数理论)
    - [1.1 基本计数原理](#11-基本计数原理)
    - [1.2 排列与组合](#12-排列与组合)
    - [1.3 容斥原理](#13-容斥原理)
    - [1.4 鸽巢原理](#14-鸽巢原理)
  - [2. 生成函数](#2-生成函数)
    - [2.1 普通生成函数](#21-普通生成函数)
    - [2.2 指数生成函数](#22-指数生成函数)
    - [2.3 生成函数的应用](#23-生成函数的应用)
  - [3. 递推关系](#3-递推关系)
    - [3.1 线性递推关系](#31-线性递推关系)
    - [3.2 非线性递推关系](#32-非线性递推关系)
    - [3.3 分治递推](#33-分治递推)
  - [4. 斯特林数](#4-斯特林数)
    - [4.1 第一类斯特林数](#41-第一类斯特林数)
    - [4.2 第二类斯特林数](#42-第二类斯特林数)
    - [4.3 斯特林数的性质](#43-斯特林数的性质)
  - [5. 卡特兰数](#5-卡特兰数)
    - [5.1 卡特兰数的定义](#51-卡特兰数的定义)
    - [5.2 卡特兰数的应用](#52-卡特兰数的应用)
  - [6. 图论基础](#6-图论基础)
    - [6.1 图的基本概念](#61-图的基本概念)
    - [6.2 树](#62-树)
    - [6.3 匹配与着色](#63-匹配与着色)
  - [7. 组合优化](#7-组合优化)
    - [7.1 贪心算法](#71-贪心算法)
    - [7.2 动态规划](#72-动态规划)
    - [7.3 网络流](#73-网络流)
  - [总结](#总结)

---

## 1. 计数理论

### 1.1 基本计数原理

**加法原理**：
如果事件 $A$ 有 $m$ 种方式发生，事件 $B$ 有 $n$ 种方式发生，且 $A$ 和 $B$ 互斥，则 $A$ 或 $B$ 有 $m + n$ 种方式发生。

**乘法原理**：
如果事件 $A$ 有 $m$ 种方式发生，事件 $B$ 有 $n$ 种方式发生，且 $A$ 和 $B$ 独立，则 $A$ 和 $B$ 同时发生有 $m \times n$ 种方式。

**定理 1.1.1** (双射原理)
如果存在集合 $A$ 和 $B$ 之间的双射，则 $|A| = |B|$。

**证明**：
设 $f: A \rightarrow B$ 为双射，则 $f$ 是单射和满射。由于 $f$ 是单射，$|A| \leq |B|$；由于 $f$ 是满射，$|A| \geq |B|$。因此 $|A| = |B|$。

### 1.2 排列与组合

**定义 1.2.1** (排列)
从 $n$ 个不同元素中取 $r$ 个元素的**排列数**为：
$$P(n,r) = \frac{n!}{(n-r)!} = n(n-1)(n-2)\cdots(n-r+1)$$

**定义 1.2.2** (组合)
从 $n$ 个不同元素中取 $r$ 个元素的**组合数**为：
$$C(n,r) = \binom{n}{r} = \frac{n!}{r!(n-r)!}$$

**定理 1.2.3** (二项式定理)
$$(x + y)^n = \sum_{k=0}^{n} \binom{n}{k} x^k y^{n-k}$$

**证明**：
使用数学归纳法。当 $n = 1$ 时显然成立。
假设对 $n-1$ 成立，则：
$$(x + y)^n = (x + y)(x + y)^{n-1} = (x + y)\sum_{k=0}^{n-1} \binom{n-1}{k} x^k y^{n-1-k}$$
$$= \sum_{k=0}^{n-1} \binom{n-1}{k} x^{k+1} y^{n-1-k} + \sum_{k=0}^{n-1} \binom{n-1}{k} x^k y^{n-k}$$
$$= \sum_{k=1}^{n} \binom{n-1}{k-1} x^k y^{n-k} + \sum_{k=0}^{n-1} \binom{n-1}{k} x^k y^{n-k}$$
$$= \sum_{k=0}^{n} \left[\binom{n-1}{k-1} + \binom{n-1}{k}\right] x^k y^{n-k} = \sum_{k=0}^{n} \binom{n}{k} x^k y^{n-k}$$

**定理 1.2.4** (帕斯卡恒等式)
$$\binom{n}{k} = \binom{n-1}{k-1} + \binom{n-1}{k}$$

**证明**：
$$\binom{n-1}{k-1} + \binom{n-1}{k} = \frac{(n-1)!}{(k-1)!(n-k)!} + \frac{(n-1)!}{k!(n-k-1)!}$$
$$= \frac{(n-1)!k + (n-1)!(n-k)}{k!(n-k)!} = \frac{(n-1)!(k + n - k)}{k!(n-k)!} = \frac{n!}{k!(n-k)!} = \binom{n}{k}$$

### 1.3 容斥原理

**定理 1.3.1** (容斥原理)
设 $A_1, A_2, \ldots, A_n$ 为有限集合，则：
$$|A_1 \cup A_2 \cup \cdots \cup A_n| = \sum_{i=1}^{n} |A_i| - \sum_{1 \leq i < j \leq n} |A_i \cap A_j| + \sum_{1 \leq i < j < k \leq n} |A_i \cap A_j \cap A_k| - \cdots + (-1)^{n+1} |A_1 \cap A_2 \cap \cdots \cap A_n|$$

**证明**：
对 $n$ 使用数学归纳法。当 $n = 1$ 时显然成立。
假设对 $n-1$ 成立，则：
$$|A_1 \cup A_2 \cup \cdots \cup A_n| = |(A_1 \cup A_2 \cup \cdots \cup A_{n-1}) \cup A_n|$$
$$= |A_1 \cup A_2 \cup \cdots \cup A_{n-1}| + |A_n| - |(A_1 \cup A_2 \cup \cdots \cup A_{n-1}) \cap A_n|$$
$$= |A_1 \cup A_2 \cup \cdots \cup A_{n-1}| + |A_n| - |(A_1 \cap A_n) \cup (A_2 \cap A_n) \cup \cdots \cup (A_{n-1} \cap A_n)|$$
然后对两个并集分别应用归纳假设即可。

### 1.4 鸽巢原理

**定理 1.4.1** (鸽巢原理)
如果将 $n$ 个物体放入 $m$ 个盒子中，且 $n > m$，则至少有一个盒子包含至少 $\lceil n/m \rceil$ 个物体。

**证明**：
反证法。假设每个盒子最多包含 $\lceil n/m \rceil - 1$ 个物体，则总物体数最多为 $m(\lceil n/m \rceil - 1) < m \cdot n/m = n$，矛盾。

**定理 1.4.2** (广义鸽巢原理)
设 $q_1, q_2, \ldots, q_n$ 为正整数，如果将 $\sum_{i=1}^{n} q_i - n + 1$ 个物体放入 $n$ 个盒子中，则存在 $i$ 使得第 $i$ 个盒子包含至少 $q_i$ 个物体。

## 2. 生成函数

### 2.1 普通生成函数

**定义 2.1.1** (普通生成函数)
序列 $\{a_n\}_{n=0}^{\infty}$ 的**普通生成函数**为：
$$A(x) = \sum_{n=0}^{\infty} a_n x^n$$

**定理 2.1.2** (生成函数的基本运算)
设 $A(x) = \sum_{n=0}^{\infty} a_n x^n$，$B(x) = \sum_{n=0}^{\infty} b_n x^n$，则：

1. $A(x) + B(x) = \sum_{n=0}^{\infty} (a_n + b_n) x^n$
2. $A(x) \cdot B(x) = \sum_{n=0}^{\infty} \left(\sum_{k=0}^{n} a_k b_{n-k}\right) x^n$
3. $\frac{A(x)}{1-x} = \sum_{n=0}^{\infty} \left(\sum_{k=0}^{n} a_k\right) x^n$

**定理 2.1.3** (二项式系数的生成函数)
$$\sum_{n=0}^{\infty} \binom{n+k-1}{k-1} x^n = \frac{1}{(1-x)^k}$$

**证明**：
对 $k$ 使用数学归纳法。当 $k = 1$ 时，$\sum_{n=0}^{\infty} x^n = \frac{1}{1-x}$。
假设对 $k-1$ 成立，则：
$$\frac{1}{(1-x)^k} = \frac{1}{1-x} \cdot \frac{1}{(1-x)^{k-1}} = \sum_{i=0}^{\infty} x^i \cdot \sum_{j=0}^{\infty} \binom{j+k-2}{k-2} x^j$$
$$= \sum_{n=0}^{\infty} \left(\sum_{i=0}^{n} \binom{n-i+k-2}{k-2}\right) x^n = \sum_{n=0}^{\infty} \binom{n+k-1}{k-1} x^n$$

### 2.2 指数生成函数

**定义 2.2.1** (指数生成函数)
序列 $\{a_n\}_{n=0}^{\infty}$ 的**指数生成函数**为：
$$A(x) = \sum_{n=0}^{\infty} a_n \frac{x^n}{n!}$$

**定理 2.2.2** (指数生成函数的乘法)
设 $A(x) = \sum_{n=0}^{\infty} a_n \frac{x^n}{n!}$，$B(x) = \sum_{n=0}^{\infty} b_n \frac{x^n}{n!}$，则：
$$A(x) \cdot B(x) = \sum_{n=0}^{\infty} \left(\sum_{k=0}^{n} \binom{n}{k} a_k b_{n-k}\right) \frac{x^n}{n!}$$

**定理 2.2.3** (指数函数的生成函数)
$$e^x = \sum_{n=0}^{\infty} \frac{x^n}{n!}$$

### 2.3 生成函数的应用

**例 2.3.1** (斐波那契数列)
斐波那契数列 $F_n$ 满足 $F_0 = 0$，$F_1 = 1$，$F_n = F_{n-1} + F_{n-2}$。

设 $F(x) = \sum_{n=0}^{\infty} F_n x^n$，则：
$$F(x) = x + xF(x) + x^2F(x)$$
$$F(x) = \frac{x}{1-x-x^2} = \frac{x}{(1-\alpha x)(1-\beta x)}$$
其中 $\alpha = \frac{1+\sqrt{5}}{2}$，$\beta = \frac{1-\sqrt{5}}{2}$。

因此：
$$F_n = \frac{\alpha^n - \beta^n}{\sqrt{5}}$$

## 3. 递推关系

### 3.1 线性递推关系

**定义 3.1.1** (线性递推关系)
形如 $a_n = c_1a_{n-1} + c_2a_{n-2} + \cdots + c_ka_{n-k}$ 的递推关系称为**线性递推关系**。

**定理 3.1.2** (线性递推关系的解法)
设特征方程为 $x^k = c_1x^{k-1} + c_2x^{k-2} + \cdots + c_k$，其根为 $\alpha_1, \alpha_2, \ldots, \alpha_r$，重数分别为 $m_1, m_2, \ldots, m_r$，则通解为：
$$a_n = \sum_{i=1}^{r} \sum_{j=0}^{m_i-1} A_{i,j} n^j \alpha_i^n$$

**例 3.1.3** (斐波那契数列)
特征方程为 $x^2 = x + 1$，根为 $\alpha = \frac{1+\sqrt{5}}{2}$，$\beta = \frac{1-\sqrt{5}}{2}$。
通解为 $F_n = A\alpha^n + B\beta^n$，代入初始条件得 $A = \frac{1}{\sqrt{5}}$，$B = -\frac{1}{\sqrt{5}}$。

### 3.2 非线性递推关系

**定义 3.2.1** (分治递推)
形如 $T(n) = aT(n/b) + f(n)$ 的递推关系称为**分治递推**。

**定理 3.2.2** (主定理)
设 $T(n) = aT(n/b) + f(n)$，其中 $a \geq 1$，$b > 1$，$f(n)$ 为正函数，则：

1. 如果 $f(n) = O(n^{\log_b a - \epsilon})$，则 $T(n) = \Theta(n^{\log_b a})$
2. 如果 $f(n) = \Theta(n^{\log_b a})$，则 $T(n) = \Theta(n^{\log_b a} \log n)$
3. 如果 $f(n) = \Omega(n^{\log_b a + \epsilon})$ 且 $af(n/b) \leq cf(n)$，则 $T(n) = \Theta(f(n))$

### 3.3 分治递推

**例 3.3.1** (归并排序)
$T(n) = 2T(n/2) + n$，其中 $a = 2$，$b = 2$，$f(n) = n$。
$\log_2 2 = 1$，$f(n) = \Theta(n^1)$，因此 $T(n) = \Theta(n \log n)$。

## 4. 斯特林数

### 4.1 第一类斯特林数

**定义 4.1.1** (第一类斯特林数)
**第一类斯特林数** $s(n,k)$ 定义为：
$$x(x-1)(x-2)\cdots(x-n+1) = \sum_{k=0}^{n} s(n,k) x^k$$

**定理 4.1.2** (第一类斯特林数的递推关系)
$$s(n,k) = s(n-1,k-1) - (n-1)s(n-1,k)$$

**证明**：
$$x(x-1)(x-2)\cdots(x-n+1) = (x-n+1) \cdot x(x-1)(x-2)\cdots(x-n+2)$$
$$= (x-n+1) \sum_{k=0}^{n-1} s(n-1,k) x^k = \sum_{k=0}^{n-1} s(n-1,k) x^{k+1} - (n-1) \sum_{k=0}^{n-1} s(n-1,k) x^k$$
$$= \sum_{k=1}^{n} s(n-1,k-1) x^k - (n-1) \sum_{k=0}^{n-1} s(n-1,k) x^k$$
比较系数得递推关系。

### 4.2 第二类斯特林数

**定义 4.2.1** (第二类斯特林数)
**第二类斯特林数** $S(n,k)$ 定义为将 $n$ 个不同元素划分为 $k$ 个非空子集的方法数。

**定理 4.2.2** (第二类斯特林数的递推关系)
$$S(n,k) = S(n-1,k-1) + kS(n-1,k)$$

**证明**：
考虑第 $n$ 个元素的放置：

1. 单独作为一个子集：$S(n-1,k-1)$ 种方法
2. 放入现有的某个子集：$kS(n-1,k)$ 种方法

**定理 4.2.3** (第二类斯特林数的生成函数)
$$\sum_{n=k}^{\infty} S(n,k) \frac{x^n}{n!} = \frac{(e^x - 1)^k}{k!}$$

### 4.3 斯特林数的性质

**定理 4.3.1** (斯特林数的关系)
$$\sum_{k=0}^{n} s(n,k) S(k,m) = \delta_{n,m}$$

**定理 4.3.2** (幂的展开)
$$x^n = \sum_{k=0}^{n} S(n,k) x(x-1)(x-2)\cdots(x-k+1)$$

## 5. 卡特兰数

### 5.1 卡特兰数的定义

**定义 5.1.1** (卡特兰数)
**卡特兰数** $C_n$ 定义为：
$$C_n = \frac{1}{n+1} \binom{2n}{n}$$

**定理 5.1.2** (卡特兰数的递推关系)
$$C_n = \sum_{k=0}^{n-1} C_k C_{n-1-k}$$

**证明**：
考虑 $n$ 对括号的正确匹配。第一个左括号必须与某个右括号匹配，将序列分为两部分，分别有 $k$ 和 $n-1-k$ 对括号。

**定理 5.1.3** (卡特兰数的生成函数)
设 $C(x) = \sum_{n=0}^{\infty} C_n x^n$，则：
$$C(x) = \frac{1 - \sqrt{1-4x}}{2x}$$

### 5.2 卡特兰数的应用

**例 5.2.1** (括号匹配)
$n$ 对括号的正确匹配方法数为 $C_n$。

**例 5.2.2** (二叉树)
$n$ 个节点的不同二叉树的数量为 $C_n$。

**例 5.2.3** (凸多边形三角剖分)
$n+2$ 边形的三角剖分方法数为 $C_n$。

## 6. 图论基础

### 6.1 图的基本概念

**定义 6.1.1** (图)
**图** $G = (V,E)$ 由顶点集 $V$ 和边集 $E$ 组成。

**定义 6.1.2** (度)
顶点 $v$ 的**度** $d(v)$ 是与 $v$ 相邻的边数。

**定理 6.1.3** (握手定理)
$$\sum_{v \in V} d(v) = 2|E|$$

**证明**：
每条边贡献给两个顶点的度，因此总度数是边数的两倍。

### 6.2 树

**定义 6.2.1** (树)
**树**是连通无环图。

**定理 6.2.2** (树的性质)
设 $T$ 为 $n$ 个顶点的树，则：

1. $T$ 有 $n-1$ 条边
2. $T$ 中任意两点间有唯一路径
3. 删除任意一条边都会使图不连通
4. 添加任意一条边都会产生环

**定理 6.2.3** (生成树)
连通图 $G$ 的**生成树**是包含 $G$ 所有顶点的树。

### 6.3 匹配与着色

**定义 6.3.1** (匹配)
**匹配**是图中没有公共顶点的边集。

**定义 6.3.2** (完美匹配)
**完美匹配**是覆盖所有顶点的匹配。

**定理 6.3.3** (霍尔定理)
二分图 $G = (X \cup Y, E)$ 有完美匹配当且仅当对任意 $S \subseteq X$，$|N(S)| \geq |S|$，其中 $N(S)$ 是 $S$ 的邻域。

**定义 6.3.4** (图着色)
**图着色**是给顶点分配颜色，使得相邻顶点颜色不同。

**定理 6.3.5** (四色定理)
任何平面图都可以用四种颜色着色。

## 7. 组合优化

### 7.1 贪心算法

**定义 7.1.1** (贪心算法)
**贪心算法**在每一步选择当前最优解。

**例 7.1.2** (活动选择问题)
选择最多的互不重叠的活动。

**算法**：

1. 按结束时间排序
2. 选择第一个活动
3. 选择下一个不与已选活动重叠的活动

**定理 7.1.3** (贪心选择性质)
贪心算法对活动选择问题是最优的。

### 7.2 动态规划

**定义 7.2.1** (动态规划)
**动态规划**通过将问题分解为子问题来求解。

**例 7.2.2** (最长公共子序列)
设 $dp[i][j]$ 为 $A[1..i]$ 和 $B[1..j]$ 的最长公共子序列长度，则：
$$dp[i][j] = \begin{cases}
dp[i-1][j-1] + 1 & \text{if } A[i] = B[j] \\
\max(dp[i-1][j], dp[i][j-1]) & \text{otherwise}
\end{cases}$$

### 7.3 网络流

**定义 7.3.1** (网络)
**网络**是带容量和源汇的有向图。

**定义 7.3.2** (最大流)
**最大流**是网络中从源到汇的最大流量。

**定理 7.3.3** (最大流最小割定理)
最大流等于最小割。

---

## 总结

组合数学是研究离散结构的重要分支，涵盖了计数、排列组合、生成函数、递推关系、斯特林数、卡特兰数、图论和组合优化等内容。这些理论不仅在纯数学中有重要应用，在计算机科学、统计学、物理学等领域也发挥着关键作用。

组合数学的发展推动了算法设计、密码学、编码理论等应用领域的进步，是现代数学不可或缺的重要组成部分。

---

**参考文献**：
1. Stanley, R. P. (2011). Enumerative Combinatorics. Cambridge University Press.
2. Graham, R. L., Knuth, D. E., & Patashnik, O. (1994). Concrete Mathematics. Addison-Wesley.
3. Brualdi, R. A. (2010). Introductory Combinatorics. Pearson.
4. Aigner, M. (2007). A Course in Enumeration. Springer.
