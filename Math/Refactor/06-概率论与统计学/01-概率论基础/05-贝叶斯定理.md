# 05-贝叶斯定理：信念的更新法则

**版本**: 1.0
**日期**: 2025-07-02

---

## 5.1. 基础：全概率公式

在介绍贝叶斯定理之前，我们需要一个重要的工具，它能帮助我们"化整为零"，通过分解样本空间来计算一个复杂事件的概率。这个工具就是**全概率公式 (Law of Total Probability)**。

**思想:**
假设我们想计算事件 \(A\) 的概率，但直接计算很困难。不过，我们知道样本空间可以被一族两两互斥且完备的事件 \(B_1, B_2, \dots, B_n\) 所划分（即 \(\cup_{i=1}^n B_i = \Omega\) 且 \(B_i \cap B_j = \emptyset\) for \(i \neq j\)）。这就像把一整块蛋糕切成了若干个不重叠的小块。

事件A的发生，必然是伴随着 \(B_1, B_2, \dots, B_n\) 中的某一个发生的。因此，我们可以把 \(A\) 分解为 \(A = (A \cap B_1) \cup (A \cap B_2) \cup \dots \cup (A \cap B_n)\)。由于 \(B_i\) 之间互斥，\(A \cap B_i\) 之间也必然互斥。根据概率的加法公理和乘法法则：
\[ P(A) = \sum_{i=1}^n P(A \cap B_i) = \sum_{i=1}^n P(B_i)P(A|B_i) \]

**定理 (全概率公式):**
如果事件 \(B_1, B_2, \dots, B_n\) 构成样本空间 \(\Omega\) 的一个划分，且对所有 \(i\)，\(P(B_i) > 0\)，那么对于任意事件 \(A\)，有：
\[ P(A) = P(B_1)P(A|B_1) + P(B_2)P(A|B_2) + \dots + P(B_n)P(A|B_n) \]
这个公式的本质是"先分类，再求和"，是进行复杂概率推断的基石。

## 5.2. 贝叶斯定理

**贝叶斯定理 (Bayes' Theorem)** 是概率论中最具影响力和哲学思辨性的定理之一，由18世纪的英国牧师托马斯·贝叶斯提出。它描述了如何在获得新证据后，更新我们对一个假设的信任程度。

**推导:**
贝叶斯定理的推导异常简单，它源于对条件概率 \(P(B_i|A)\) 的直接计算：
\[ P(B_i|A) = \frac{P(B_i \cap A)}{P(A)} \]
对分子使用乘法法则 \(P(B_i \cap A) = P(B_i)P(A|B_i)\)，对分母使用全概率公式，我们就得到了贝叶斯定理的标准形式。

**定理 (贝叶斯定理):**
在全概率公式的条件下，有：
\[ P(B_i|A) = \frac{P(B_i)P(A|B_i)}{\sum_{j=1}^n P(B_j)P(A|B_j)} \]

## 5.3. 解读：先验、后验与证据

贝叶斯定理的强大之处不在于其数学推导的复杂性，而在于它提供了一个"信念更新"的逻辑框架。公式中的每一项都有其独特的解释：

- **\(P(B_i)\): 先验概率 (Prior Probability)**
  在获得任何关于事件A的信息**之前**，我们对假设 \(B_i\) 为真的信念强度。这是我们的"初始判断"或"背景知识"。

- **\(P(A|B_i)\): 似然度 (Likelihood)**
  在假设 \(B_i\) 为真的条件下，观察到证据 \(A\) 的概率。它衡量了我们的假设 \(B_i\) 对证据 \(A\) 的"解释力"。

- **\(P(A)\): 证据的概率 (Probability of Evidence)**
  在所有可能性下，观察到证据A的总概率。它是一个归一化常数，确保所有后验概率之和为1。

- **\(P(B_i|A)\): 后验概率 (Posterior Probability)**
  在观察到证据 \(A\) **之后**，我们对假设 \(B_i\) 为真的更新后的信念强度。这是我们最关心的结果。

**贝叶斯定理的口语化表达:**
\[ \text{后验概率} \propto \text{先验概率} \times \text{似然度} \]
**"新的信念强度 正比于 旧的信念强度 乘以 假设对新证据的解释力。"**

### 经典应用：医学诊断

假设有一种罕见病的患病率是 0.1%（一千人中有一人得病）。有一种检测手段，其准确率为99%（即如果得病，99%的概率检测为阳性；如果没病，99%的概率检测为阴性）。现在，小明去检测，结果为阳性。请问小明确实患病的概率是多少？

- **事件H**: 小明患病 (Hypothesis)
- **事件E**: 检测结果为阳性 (Evidence)

我们要计算的是 \(P(H|E)\)。

- **先验概率 \(P(H)\)**: \(0.001\) (这是我们没有任何检测信息时的判断)
- **先验概率 \(P(\bar{H})\)**: \(1 - 0.001 = 0.999\)

- **似然度 \(P(E|H)\)**: \(0.99\) (真阳性率)
- **似然度 \(P(E|\bar{H})\)**: \(1 - 0.99 = 0.01\) (假阳性率)

根据贝叶斯定理：
\[ P(H|E) = \frac{P(H)P(E|H)}{P(H)P(E|H) + P(\bar{H})P(E|\bar{H})} \]
\[ P(H|E) = \frac{0.001 \times 0.99}{0.001 \times 0.99 + 0.999 \times 0.01} \]
\[ P(H|E) = \frac{0.00099}{0.00099 + 0.00999} \approx \frac{0.001}{0.011} \approx 0.0909 \approx 9.1\% \]

这个结果非常反直觉。即使检测结果是阳性，小明真正患病的概率也只有大约9.1%！原因在于**先验概率太低了**。绝大多数的阳性结果，实际上都是由大量的健康人中的那1%的误诊造成的。贝叶斯定理精确地量化了这一点，防止我们被看似很高的检测准确率所误导。

---
[返回模块总览](./00-模块总览.md) | [返回上一级: 06-概率论与统计学总览](../00-06-概率论与统计学总览.md) | [返回项目总览](../../09-项目总览/00-项目总览.md)
