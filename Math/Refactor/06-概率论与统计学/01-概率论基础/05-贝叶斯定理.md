# 05 - 贝叶斯定理

---

title: "贝叶斯定理"
date: 2025-07-03

---

## 1. 引言：信念的更新法则

在科学探索、日常决策乃至机器学习中，我们都遵循着一个共同的逻辑模式：我们对世界有一个初始的**信念**（或假设），然后我们不断地观察新的**证据**，并根据这些证据来**更新**和**修正**我们的信念。

**贝叶斯定理 (Bayes' Theorem)**，也称为**贝叶斯法则 (Bayes' Rule)**，正是对这个"信念更新"过程的完美数学表述。它告诉我们，如何将先验知识与新的观测数据相结合，以一种逻辑上严谨的方式，得到更为合理的后验信念。这个看似简单的公式，是现代统计推断和机器学习领域的基石。

## 2. 贝叶斯定理的推导与公式

贝叶斯定理的推导过程非常直接，它源于对条件概率公式的两次巧妙运用。

根据条件概率的定义，我们有：

1. $P(A|B) = \frac{P(A \cap B)}{P(B)}$
2. $P(B|A) = \frac{P(B \cap A)}{P(A)}$

由于 $P(A \cap B) = P(B \cap A)$，我们可以将两个公式中的分子等同起来：
$P(A|B) \cdot P(B) = P(B|A) \cdot P(A)$

整理后，便得到贝叶斯定理的基本形式：
$$ P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)} $$

这个公式描述了两个相关事件 A 和 B 的条件概率之间的关系。

## 3. 诠释：先验、后验与证据

贝叶斯定理真正的威力在于它的诠释。通常，我们用它来评估一个**假设 (Hypothesis, H)** 在出现了新的**证据 (Evidence, E)** 之后的可信度。在这种语境下，公式被写为：

$$ P(H|E) = \frac{P(E|H) \cdot P(H)}{P(E)} $$

公式的每一项都有其独特的名称和意义：

- **$P(H|E)$ - 后验概率 (Posterior Probability)**:
    这是我们最关心的量。它表示在**观察到证据 E 之后**，假设 H 成立的概率。它是我们经过学习和更新后的最终信念。

- **$P(E|H)$ - 似然度 (Likelihood)**:
    它表示在**假设 H 为真**的前提下，我们能够观察到证据 E 的概率。它衡量了假设 H 对证据 E 的解释能力。

- **$P(H)$ - 先验概率 (Prior Probability)**:
    它表示在**没有任何证据 E 的情况下**，我们对假设 H 成立的初始信念或概率。它可以基于历史数据、领域知识或者主观判断。

- **$P(E)$ - 证据的概率 (Probability of Evidence)**:
    它表示证据 E 本身发生的总概率，不论假设 H 是否成立。它扮演着**归一化常数**的角色，确保计算出的后验概率总和为1。

因此，贝叶斯定理可以被通俗地理解为：
**后验概率 ∝ 似然度 × 先验概率**

## 4. 全概率公式与贝叶斯定理的扩展形式

在实际应用中，分母 $P(E)$ 往往不易直接获得。这时，我们需要使用**全概率公式 (Law of Total Probability)** 来将其展开。

假设样本空间被一组互斥且完备的事件（一个划分） $H_1, H_2, \dots, H_n$ 所覆盖。那么任何事件 E 的总概率可以表示为：
$$ P(E) = \sum_{i=1}^{n} P(E|H_i) \cdot P(H_i) $$
这个公式的直观意义是，事件E发生的总概率，等于在每一种可能的情况下E发生的概率的加权平均。

将全概率公式代入贝叶斯定理的分母，我们就得到了更具操作性的**扩展形式**：
$$ P(H_k|E) = \frac{P(E|H_k) \cdot P(H_k)}{\sum_{i=1}^{n} P(E|H_i) \cdot P(H_i)} $$

**经典应用：医疗诊断**:

- **假设 H**: 某人患有某种罕见病（患病率为0.1%）。$P(H) = 0.001$。
- **证据 E**: 该人的检测结果为阳性。
- **似然度 $P(E|H)$**: 如果此人真的有病，检测的准确率（真阳性率）为99%。$P(E|H) = 0.99$。
- **假阳性率 $P(E|\neg H)$**: 如果此人没病，检测仍有1%的可能误报为阳性。$P(E|\neg H) = 0.01$。

现在计算 $P(H|E)$，即"检测为阳性时，此人确实有病的概率"。

1. **计算分母 $P(E)$**:
    $P(E) = P(E|H)P(H) + P(E|\neg H)P(\neg H)$
    $P(E) = (0.99)(0.001) + (0.01)(0.999) = 0.00099 + 0.00999 = 0.01098$

2. **计算后验概率 $P(H|E)$**:
    $P(H|E) = \frac{P(E|H)P(H)}{P(E)} = \frac{0.99 \times 0.001}{0.01098} \approx 0.09016$

**结论**: 即使检测结果为阳性，此人真正患病的概率也只有大约9%。这个与直觉相悖的结果，正是因为疾病的先验概率极低。贝叶斯定理帮助我们以一种理性的方式，结合了检测的证据和疾病的罕见性这一先验知识。

## 5. 总结

贝叶斯定理不仅仅是一个数学公式，它是一种强大的思维框架，一种关于学习和推断的哲学。

- **数学上**，它建立了先验概率和后验概率之间的定量关系。
- **认识论上**，它将概率诠释为我们对一个命题的**信念度 (degree of belief)**，并描述了这种信念度应如何根据新的证据进行理性的更新。
- **应用上**，它是贝叶斯统计学派的基石，并在人工智能、机器学习（如朴素贝叶斯分类器）、信息论、生物信息学、金融等众多领域发挥着核心作用。

掌握贝叶斯定理，就是掌握了在不确定性世界中进行理性思考和决策的关键工具。

---
贝叶斯定理是连接过去（先验）与未来（后验）的逻辑桥梁，由现在（证据）的砖石砌成。

[返回模块总览](./00-模块总览.md) | [返回上一级: 概率论与统计学总览](../00-概率论与统计学总览.md) | [返回项目总览](../../09-项目总览/00-项目总览.md)
