---
title: "条件分布"
date: 2025-07-02
---

## 1. 什么是条件分布？

在上一节，我们学习了联合分布和边际分布。

* **联合分布** $P(X, Y)$ 描述了两个变量**共同**的概率行为。
* **边际分布** $P(X)$ 描述了**单个**变量的概率行为，它通过对联合分布积分或求和得到，忽略了另一个变量的信息。

现在我们提出一个更精细的问题：**如果我们已经观测到了一个变量 $Y$ 的取值为 $y$，那么另一个变量 $X$ 的概率分布会变成什么样？**

这个在给定部分信息（$Y=y$）后，重新评估的关于 $X$ 的概率分布，就是**条件分布 (Conditional Distribution)**。它是在一个缩小的样本空间中定义的新的概率分布。

## 2. 条件分布的定义

条件分布的定义直接源于条件概率的公式 $P(A|B) = \frac{P(A \cap B)}{P(B)}$。

### 2.1 离散型：条件概率质量函数 (Conditional PMF)

给定 $Y=y_j$，随机变量 $X$ 的条件概率质量函数定义为：
$$ p_{X|Y}(x_i|y_j) = P(X=x_i | Y=y_j) = \frac{P(X=x_i, Y=y_j)}{P(Y=y_j)} = \frac{p(x_i, y_j)}{p_Y(y_j)} $$
其中，$p(x_i, y_j)$ 是联合PMF，$p_Y(y_j)$ 是 $Y$ 的边际PMF。这个定义要求 $p_Y(y_j) > 0$。

对于一个固定的 $y_j$，函数 $p_{X|Y}(x_i|y_j)$ 本身就是一个合法的PMF，它描述了在 $Y$ 的取值固定为 $y_j$ 的情况下，$X$ 的所有可能取值的概率。因此，它必须满足：
$$ \sum_i p_{X|Y}(x_i|y_j) = \sum_i \frac{p(x_i, y_j)}{p_Y(y_j)} = \frac{1}{p_Y(y_j)} \sum_i p(x_i, y_j) = \frac{p_Y(y_j)}{p_Y(y_j)} = 1 $$

### 2.2 连续型：条件概率密度函数 (Conditional PDF)

对于连续型随机变量，我们不能直接定义在 $Y=y$ 这个"点"上的条件概率，因为 $P(Y=y)=0$。但我们可以通过一种极限的方式来定义条件密度。

给定 $Y=y$，随机变量 $X$ 的条件概率密度函数定义为：
$$ f_{X|Y}(x|y) = \frac{f(x, y)}{f_Y(y)} $$
其中，$f(x,y)$ 是联合PDF，$f_Y(y)$ 是 $Y$ 的边际PDF。这个定义要求 $f_Y(y)>0$。

同样地，对于一个固定的 $y$，函数 $f_{X|Y}(x|y)$ 也是一个合法的PDF，它描述了在 $Y$ 的取值固定为 $y$ 的情况下，$X$ 的概率密度。因此，它必须满足：
$$ \int_{-\infty}^{\infty} f_{X|Y}(x|y) \,dx = \int_{-\infty}^{\infty} \frac{f(x, y)}{f_Y(y)} \,dx = \frac{1}{f_Y(y)} \int_{-\infty}^{\infty} f(x, y) \,dx = \frac{f_Y(y)}{f_Y(y)} = 1 $$

## 3. 条件分布与独立性

条件分布为我们提供了另一种理解**独立性**的视角。
如果两个随机变量 $X$ 和 $Y$ 相互独立，那么根据独立的定义 $f(x,y) = f_X(x) f_Y(y)$。
我们来看此时的条件分布：
$$ f_{X|Y}(x|y) = \frac{f(x, y)}{f_Y(y)} = \frac{f_X(x) f_Y(y)}{f_Y(y)} = f_X(x) $$

这个结果 $f_{X|Y}(x|y) = f_X(x)$ 完美地诠释了独立性的直观含义：
**如果 $X$ 和 $Y$ 独立，那么关于 $Y$ 的取值信息 $Y=y$ 对 $X$ 的分布没有任何影响，$X$ 的条件分布仍然是它原来的边际分布。**

反之，如果 $f_{X|Y}(x|y) \neq f_X(x)$，则说明 $X$ 和 $Y$ 是相关的。$Y$ 的取值信息改变了我们对 $X$ 概率分布的判断。

## 4. 链式法则与贝叶斯定理

从条件分布的定义 $f(x|y) = \frac{f(x, y)}{f(y)}$，我们可以推导出概率论中两个极其重要的法则。

### 4.1 链式法则 (Chain Rule)

通过移项，我们可以用边际分布和条件分布来表示联合分布：
$$ f(x, y) = f(x|y) f(y) $$
或者
$$ f(x, y) = f(y|x) f(x) $$
这个法则是**贝叶斯网络**等概率图模型的基础，它允许我们将一个复杂的高维联合分布分解为一系列更简单的条件分布的乘积。

### 4.2 贝叶斯定理 (Bayes' Theorem) for Random Variables

联立上面两个链式法则的表达式，我们有 $f(y|x) f(x) = f(x|y) f(y)$。
整理后得到连续型随机变量的**贝叶斯定理**：
$$ f(y|x) = \frac{f(x|y) f(y)}{f(x)} $$
这个公式在统计推断中是至关重要的。它告诉我们如何根据"似然" $f(x|y)$ 和"先验" $f(y)$，来计算"后验" $f(y|x)$。

* **$f(y)$ (先验)**: 在观测到任何数据 $x$ 之前，我们对参数 $y$ 的信念或分布的了解。
* **$f(x|y)$ (似然)**: 在给定参数 $y$ 的条件下，观测到数据 $x$ 的概率密度。
* **$f(y|x)$ (后验)**: 在观测到数据 $x$ 之后，我们对参数 $y$ 的更新后的信念或分布。

## 5. 总结

条件分布是概率论中连接各个核心概念的桥梁。

* 它从**联合分布**和**边际分布**中定义而来。
* 它为**独立性**提供了直观的解释。
* 它直接导出了用于构建复杂模型的**链式法则**和用于统计推断的**贝叶斯定理**。

理解条件分布，就是理解信息如何改变我们对不确定性的判断。它是从基本的概率计算迈向高级的概率建模和统计推断的关键一步。
