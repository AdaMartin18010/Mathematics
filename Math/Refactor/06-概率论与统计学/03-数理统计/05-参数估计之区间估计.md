# 05-参数估计之区间估计

## 1. 点估计的局限性

在前面的章节中，我们学习了如何给出一个未知参数的**点估计**，例如用样本均值 $\bar{x}=175.2$ cm 来估计总体均值 $\mu$。

然而，点估计有两个主要局限性：

1. 它几乎肯定是**错误**的。总体均值 $\mu$ 是一个固定的常数，而我们的估计值是一个依赖于样本的随机结果。$\bar{x}$ 精确等于 $\mu$ 的概率几乎为零。
2. 它没有提供关于**估计精度**的任何信息。我们得到的估计值 $175.2$，真实值 $\mu$ 是在 $175.2 \pm 0.1$ 的范围内，还是在 $175.2 \pm 10$ 的范围内？点估计本身无法回答这个问题。

为了解决这个问题，我们引入**区间估计 (Interval Estimation)**。

## 2. 置信区间 (Confidence Interval) 的核心思想

**区间估计**的目标是提供一个**区间**，并期望这个区间以一个很高的概率**包含**未知参数的真值。这个区间就被称为**置信区间**。

### 2.1 置信水平 (Confidence Level)

我们希望区间能够包含真值的"概率"或"信心程度"，被称为**置信水平 (Confidence Level)**，通常记为 $1-\alpha$（例如 90%, 95%, 99%）。相应的，$\alpha$ 被称为**显著性水平 (Significance Level)**。

### 2.2 置信区间的正确理解

这是统计学中最容易被误解的概念之一。请务必仔细理解：

**一个 95% 置信区间的正确含义是：如果我们用同一种方法，对同一个总体进行无数次重复抽样，并为每一次抽样构造一个置信区间，那么在所有这些构造出的区间中，大约有 95% 的区间会包含真实参数 $\theta$。**

**错误理解**："对于我算出的这一个具体的区间 $[L, U]$，真实参数 $\theta$ 有 95% 的概率落在这个区间内。"

* **辨析**：真实参数 $\theta$ 是一个固定的、未知的常数，它要么在 $[L, U]$ 内，要么不在，不存在概率问题。随机性存在于区间的构造过程（因为区间的端点 $L$ 和 $U$ 依赖于随机样本）。95% 的信心是赋予我们所使用的**方法**，而不是某一个具体的**结果**。

一个经典的类比是"套圈游戏"：

* **参数 $\theta$**: 地上的一个固定不动的目标。
* **置信区间**: 你扔出的一个圈。
* **置信水平 95%**: 你是一个高手，你的长期套中率是 95%。
在你扔出一个圈之后，这个圈要么套中了目标，要么没套中。你不能说"这个已经扔出去的圈有 95% 的概率套中了目标"。你只能说"我用来扔圈的这个方法有 95% 的把握能套中目标"。

## 3. 构造置信区间的一般方法（枢轴量法）

构造置信区间的关键是找到一个**枢轴量 (Pivotal Quantity)**。

枢轴量是一个同时包含样本统计量和未知参数 $\theta$ 的函数，但其**概率分布不依赖于任何未知参数**。

构造步骤如下：

1. 找到一个合适的枢轴量 $Q(X_1, \dots, X_n; \theta)$。
2. 根据 $Q$ 的已知分布，找到两个临界点 $a$ 和 $b$，使得 $P(a \le Q \le b) = 1-\alpha$。
3. 通过代数变形，从不等式 $a \le Q \le b$ 中反解出 $\theta$，得到 $L \le \theta \le U$。那么 $[L, U]$ 就是 $\theta$ 的一个 $1-\alpha$ 置信区间。

## 4. 总体均值 $\mu$ 的置信区间

这是最常用、最重要的置信区间。我们主要分两种情况讨论。

### 4.1 情况一：总体方差 $\sigma^2$ 已知

这种情景在现实中很少见，但它是理解后续内容的基础。
当 $\sigma^2$ 已知时，根据中心极限定理，我们知道：
$$ Z = \frac{\bar{X} - \mu}{\sigma / \sqrt{n}} \sim N(0, 1) $$
$Z$ 就是一个理想的枢轴量，它的分布是标准正态分布，不依赖任何未知参数。

对于给定的置信水平 $1-\alpha$，我们可以找到标准正态分布上的临界点 $\pm z_{\alpha/2}$，使得 $P(-z_{\alpha/2} \le Z \le z_{\alpha/2}) = 1-\alpha$。

将 $Z$ 的表达式代入并反解 $\mu$，可得：
$$ \bar{X} - z_{\alpha/2} \frac{\sigma}{\sqrt{n}} \le \mu \le \bar{X} + z_{\alpha/2} \frac{\sigma}{\sqrt{n}} $$
因此，$\mu$ 的 $1-\alpha$ 置信区间为：
$$ \left[ \bar{X} - z_{\alpha/2} \frac{\sigma}{\sqrt{n}}, \quad \bar{X} + z_{\alpha/2} \frac{\sigma}{\sqrt{n}} \right] $$

### 4.2 情况二：总体方差 $\sigma^2$ 未知

这是现实中最常见的情况。当 $\sigma$ 未知时，我们很自然地想到用它的无偏估计量——样本标准差 $S$ 来替代。此时，枢轴量变为：
$$ t = \frac{\bar{X} - \mu}{S / \sqrt{n}} $$
这个量不再服从标准正态分布，而是服从**自由度为 $n-1$ 的 t 分布**。

t 分布的形状与正态分布相似（钟形、对称），但尾部更"厚"，这说明它考虑了用 $S$ 估计 $\sigma$ 所带来的额外不确定性。

类似地，我们找到 t 分布上的临界点 $\pm t_{\alpha/2}(n-1)$，使得 $P(-t_{\alpha/2}(n-1) \le t \le t_{\alpha/2}(n-1)) = 1-\alpha$。

反解 $\mu$ 可得 $\mu$ 的 $1-\alpha$ 置信区间为：
$$ \left[ \bar{X} - t_{\alpha/2}(n-1) \frac{S}{\sqrt{n}}, \quad \bar{X} + t_{\alpha/2}(n-1) \frac{S}{\sqrt{n}} \right] $$

## 5. 影响置信区间宽度的因素

置信区间的宽度 $W$ 反映了估计的精度。宽度越窄，精度越高。
$$ W = 2 \times (\text{临界值}) \times \frac{\text{标准差}}{\sqrt{n}} $$
影响宽度的因素主要有三个：

1. **置信水平 $1-\alpha$**: 置信水平越高，区间的宽度就**越宽**。因为你需要一个更大的范围来更有信心地"捕获"真实参数。
2. **样本容量 $n$**: 样本容量越大，区间的宽度就**越窄**。因为分母 $\sqrt{n}$ 变大了，这反映了更多的数据带来了更高的精度。
3. **总体波动性 $\sigma$**: 总体的标准差 $\sigma$ 越大，区间的宽度就**越宽**。因为数据本身越分散，估计的不确定性自然就越大。
