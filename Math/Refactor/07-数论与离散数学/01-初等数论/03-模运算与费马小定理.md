---
title: "模运算与费马小定理"
date: 2025-07-03
---

## 1. 模算术 (Modular Arithmetic)

模算术是一种整数的算术系统，其中数字在达到某一特定值（模数）时会"折返"归零。
我们可以把它想象成一个时钟的算术。

- 在一个12小时制的时钟上，时间从1到12循环。8点过后的5个小时是1点，而不是13点。这可以表示为 $8+5 \equiv 1 \pmod{12}$。

这个系统在数论和计算机科学中极为重要。

**剩余类 (Residue Class)**:
模 $m$ 的所有整数可以根据它们除以 $m$ 的余数分为 $m$ 个集合，每个集合称为一个**剩余类**。
例如，模 4 的剩余类有：

- $\{..., -8, -4, 0, 4, 8, ...\}$ (余数为0)
- $\{..., -7, -3, 1, 5, 9, ...\}$ (余数为1)
- $\{..., -6, -2, 2, 6, 10, ...\}$ (余数为2)
- $\{..., -5, -1, 3, 7, 11, ...\}$ (余数为3)

**整数模m环 $\mathbb{Z}_m$**:
我们可以用每个剩余类的代表元（通常是 $0, 1, \dots, m-1$）来构成一个新的代数结构，记作 $\mathbb{Z}_m$。我们可以在这个集合上定义加法和乘法，运算规则是先按普通整数规则计算，然后取结果模 $m$ 的余数。

- **例子**: 在 $\mathbb{Z}_7$ 中：
  - $5+4 = 9 \equiv 2 \pmod{7}$
  - $5 \times 4 = 20 \equiv 6 \pmod{7}$

这个结构 $(\mathbb{Z}_m, +, \times)$ 构成一个**交换环**。

---

## 2. 乘法逆元与欧拉函数

在有理数中，任何非零数 $a$ 都有一个倒数 $a^{-1}$，使得 $a \cdot a^{-1} = 1$。在 $\mathbb{Z}_m$ 中，一个元素 $a$ 是否有**乘法逆元**呢？

- 在 $\mathbb{Z}_{10}$ 中，3的逆元是7，因为 $3 \times 7 = 21 \equiv 1 \pmod{10}$。
- 但在 $\mathbb{Z}_{10}$ 中，4没有逆元。因为任何数乘以4，结果的个位数只可能是 0, 4, 8, 2, 6，永远不可能是1。

**定理**:
一个元素 $a \in \mathbb{Z}_m$ 存在乘法逆元，**当且仅当** $a$ 与模数 $m$ **互素**，即 $\gcd(a, m) = 1$。

**欧拉phi函数 (Euler's Totient Function)**, $\phi(m)$:
这个函数用来计算在 $1, 2, \dots, m$ 中，有多少个整数与 $m$ 互素。

- $\phi(10) = 4$。因为在1到10中，与10互素的数是 1, 3, 7, 9。
- 如果 $p$ 是一个素数，那么 $1, 2, \dots, p-1$ 都与 $p$ 互素，所以 $\phi(p) = p-1$。

$\phi(m)$ 的值，也正是在环 $\mathbb{Z}_m$ 中可逆元的数量。这些可逆元在乘法下构成一个群，称为**整数模m乘法群**，记作 $(\mathbb{Z}/m\mathbb{Z})^\times$。这是一个阶为 $\phi(m)$ 的阿贝尔群。

---

## 3. 欧拉定理

欧拉定理是关于模运算的一个核心结果，它描述了任何与模数互素的数，在模运算下的幂的周期性。

**定理内容 (欧拉定理)**:
如果整数 $a$ 和正整数 $m$ 互素（即 $\gcd(a, m)=1$），那么：
$$ a^{\phi(m)} \equiv 1 \pmod{m} $$

**证明思想**:
这个定理可以作为群论中**拉格朗日定理**的一个直接推论。

- 考虑整数模m乘法群 $(\mathbb{Z}/m\mathbb{Z})^\times$，它的阶是 $\phi(m)$。
- 任何一个元素 $a$（与 $m$ 互素）都在这个群里。
- 根据拉格朗日定理，群中任何一个元素的阶，都能整除群的阶。
- 因此，$a$ 的阶 $k$ 整除 $\phi(m)$。所以 $\phi(m) = sk$ 对于某个整数 $s$ 成立。
- 那么 $a^{\phi(m)} = a^{sk} = (a^k)^s \equiv 1^s \equiv 1 \pmod{m}$。

**例子**:
计算 $3^{100}$ 除以 10 的余数。

- $m=10, a=3$。$\gcd(3, 10)=1$。
- 我们已经知道 $\phi(10) = 4$。
- 根据欧拉定理，$3^4 \equiv 1 \pmod{10}$。
- $3^{100} = 3^{4 \times 25} = (3^4)^{25} \equiv 1^{25} \equiv 1 \pmod{10}$。

---

## 4. 费马小定理 (Fermat's Little Theorem)

费马小定理是欧拉定理在一个非常重要的特殊情况下的应用。

**定理内容 (费马小定理)**:
如果 $p$ 是一个**素数**，而整数 $a$ **不是** $p$ 的倍数（即 $\gcd(a, p)=1$），那么：
$$ a^{p-1} \equiv 1 \pmod{p} $$

**证明**:
这是欧拉定理的直接推论。因为 $p$ 是素数，所以 $\phi(p) = p-1$。将此代入欧拉定理 $a^{\phi(p)} \equiv 1 \pmod{p}$ 即可得到。

**定理的另一种形式**:
将 $a^{p-1} \equiv 1 \pmod{p}$ 两边乘以 $a$，可以得到一个对**任意**整数 $a$ 都成立的表达式（无论 $a$ 是否是 $p$ 的倍数）：
$$ a^p \equiv a \pmod{p} $$

**应用**:
费马小定理是**素性测试**的基础。如果要检验一个很大的数 $n$ 是否是素数，我们可以随机选一个 $a < n$，计算 $a^{n-1} \pmod{n}$。

- 如果结果**不等于1**，那么根据费马小定理的逆否命题， $n$ **一定不是**素数。
- 如果结果**等于1**，那么 $n$ **很可能**是一个素数。
这种测试被称为费马素性测试。虽然存在少量被称为"卡迈克尔数"的合数能够通过测试，但在实际应用中，这仍然是一个快速且有效的概率性素性检验方法。

## 5. 总结

模运算为我们提供了一个有限但结构丰富的算术世界。在这个世界中：

- 元素可以被分类为不同的剩余类，构成环 $\mathbb{Z}_m$。
- 一个元素是否可逆（有乘法逆元）取决于它是否与模数互素。
- **欧拉phi函数** $\phi(m)$ 统计了可逆元的数量。
- **欧拉定理** ($a^{\phi(m)} \equiv 1 \pmod{m}$) 和它的特例**费马小定理** ($a^{p-1} \equiv 1 \pmod{p}$) 揭示了模乘法运算的周期性规律。

这些定理不仅是初等数论的瑰宝，更是现代密码学（如RSA算法）和计算机科学中许多算法的理论基石。
