---
title: "费马小定理与欧拉定理"
date: 2025-07-04
---

## 1. 费马小定理 (Fermat's Little Theorem)

费马小定理是数论中一个非常著名且有用的定理，它揭示了素数模下的一个重要同余性质。它是欧拉定理的一个特例。

**定理 (费马小定理)**:
设 $p$ 是一个素数， $a$ 是一个整数且**不能被 $p$ 整除** (即 $p \nmid a$)。则：
$$ a^{p-1} \equiv 1 \pmod{p} $$

**另一种形式**:
将上式两边同乘以 $a$，我们可以得到一个对**任意整数 $a$** 都成立的表达形式：
$$ a^p \equiv a \pmod{p} $$
当 $p | a$ 时，两边都为 0，同余式显然成立。当 $p \nmid a$ 时，可以由第一种形式推导出来。

**例子**:

- 设 $p=7, a=2$。$p$ 是素数且 $7 \nmid 2$。
    $2^{7-1} = 2^6 = 64$。
    $64 = 9 \times 7 + 1$，所以 $64 \equiv 1 \pmod{7}$。
- 设 $p=5, a=3$。$5 \nmid 3$。
    $3^{5-1} = 3^4 = 81$。
    $81 = 16 \times 5 + 1$，所以 $81 \equiv 1 \pmod{5}$。

**重要应用**:

- **简化幂运算**: 该定理是计算大数幂次模运算的利器。例如，计算 $3^{100} \pmod{7}$。
    根据费马小定理，$3^6 \equiv 1 \pmod{7}$。
    $100 = 6 \times 16 + 4$。
    所以，$3^{100} = 3^{6 \times 16 + 4} = (3^6)^{16} \cdot 3^4 \equiv 1^{16} \cdot 3^4 \equiv 81 \equiv 4 \pmod{7}$。
- **素性检验**: 费马小定理可以用于素性检验（虽然不是100%准确，存在伪素数）。如果对于某个数 $n$，我们能找到一个 $a$ 使得 $a^{n-1} \not\equiv 1 \pmod{n}$，那么 $n$ **一定不是**素数。

---

## 2. 欧拉函数 (Euler's Totient Function)

为了将费马小定理推广到模数为合数的情况，我们需要一个新的工具——欧拉函数。

**定义 (欧拉函数)**:
对于一个正整数 $n$，**欧拉函数 $\phi(n)$** (也称欧拉 totient 函数) 定义为：小于或等于 $n$ 的正整数中，与 $n$ **互素**的数的个数。

**例子**:

- $\phi(10)$: 小于等于10且与10互素的正整数有 1, 3, 7, 9。所以 $\phi(10) = 4$。
- $\phi(7)$: 7 是素数。小于等于7的正整数中，1, 2, 3, 4, 5, 6 都与 7 互素。所以 $\phi(7) = 6$。
- $\phi(12)$: 与12互素的有 1, 5, 7, 11。所以 $\phi(12) = 4$。

**欧拉函数的性质**:

1. **对于素数 $p$**: $\phi(p) = p-1$。
2. **对于素数的幂 $p^k$**: $\phi(p^k) = p^k - p^{k-1} = p^k(1 - \frac{1}{p})$。
3. **积性函数**: 如果 $m$ 和 $n$ 是两个**互素**的正整数，则 $\phi(mn) = \phi(m)\phi(n)$。

**计算公式**:
结合唯一分解定理和积性性质，我们可以得到任意正整数 $n$ 的欧拉函数的计算公式。
如果 $n$ 的标准分解式为 $n = p_1^{a_1} p_2^{a_2} \cdots p_k^{a_k}$，则：
$$ \phi(n) = n \left(1 - \frac{1}{p_1}\right) \left(1 - \frac{1}{p_2}\right) \cdots \left(1 - \frac{1}{p_k}\right) $$

**示例：计算 $\phi(36)$**

- $36 = 2^2 \cdot 3^2$。
- $\phi(36) = 36 \left(1 - \frac{1}{2}\right) \left(1 - \frac{1}{3}\right) = 36 \cdot \frac{1}{2} \cdot \frac{2}{3} = 12$。
- 验证：与36互素的数有1, 5, 7, 11, 13, 17, 19, 23, 25, 29, 31, 35，共12个。

---

## 3. 欧拉定理 (Euler's Totient Theorem)

欧拉定理是费马小定理的推广，适用于任何正整数模。

**定理 (欧拉定理)**:
设 $n$ 是一个正整数， $a$ 是一个整数且与 $n$ **互素** (即 $\gcd(a, n)=1$)。则：
$$ a^{\phi(n)} \equiv 1 \pmod{n} $$

**观察**:
当 $n$ 是一个素数 $p$ 时，$\phi(p) = p-1$。此时欧拉定理的形式变为 $a^{p-1} \equiv 1 \pmod{p}$ (要求 $\gcd(a, p)=1$，即 $p \nmid a$)，这正是费马小定理。

**例子**:

- 计算 $7^{100} \pmod{12}$。
  - 首先，$\gcd(7, 12)=1$。
  - 计算 $\phi(12) = 12(1-\frac{1}{2})(1-\frac{1}{3}) = 12 \cdot \frac{1}{2} \cdot \frac{2}{3} = 4$。
  - 根据欧拉定理，$7^4 \equiv 1 \pmod{12}$。
  - $100 = 4 \times 25$。
  - $7^{100} = (7^4)^{25} \equiv 1^{25} \equiv 1 \pmod{12}$。

**核心应用**:
欧拉定理是现代公钥密码系统 **RSA 算法**的数学基础。RSA算法的安全性正是依赖于计算 $\phi(n)$ 的困难性，而这又等价于对大数 $n$ 进行因子分解的困难性。

## 4. 总结

费马小定理和欧拉定理是初等数论中最核心的两个定理。它们深刻地揭示了在模运算下，整数的幂次具有惊人的周期性。这个周期由模数 $n$ 的性质（具体来说是 $\phi(n)$）所决定。这些定理不仅是理论上优美的结果，更为高效计算大数幂的模运算提供了强大的工具，并直接催生了以RSA为代表的现代密码学体系，是纯粹数学理论走向实际应用的典范。
