---
title: "中国剩余定理"
date: 2025-07-04
---

## 1. 问题来源："孙子算经"

中国剩余定理 (Chinese Remainder Theorem, CRT) 是数论中一个非常著名的、关于求解同余方程组的定理。它的最早形式出现在中国南北朝时期的数学著作《孙子算经》中。

**经典问题（"物不知数"）**:
> 今有物不知其数，三三数之剩二，五五数之剩三，七七数之剩二。问物几何？

用现代数学语言来描述，就是求解以下这个一元线性同余方程组：
$$
\begin{cases}
x \equiv 2 \pmod{3} \\
x \equiv 3 \pmod{5} \\
x \equiv 2 \pmod{7}
\end{cases}
$$

我们的目标是找到一个整数 $x$，它能同时满足这三个条件。

---

## 2. 定理的现代形式

**定理 (中国剩余定理)**:
设 $m_1, m_2, \dots, m_k$ 是 $k$ 个**两两互素**的正整数（即对于任意 $i \neq j$，都有 $\gcd(m_i, m_j) = 1$）。
再设 $a_1, a_2, \dots, a_k$ 是任意 $k$ 个整数。

则同余方程组：
$$
\begin{cases}
x \equiv a_1 \pmod{m_1} \\
x \equiv a_2 \pmod{m_2} \\
\vdots \\
x \equiv a_k \pmod{m_k}
\end{cases}
$$
在模 $M = m_1 m_2 \cdots m_k$ 的意义下，有**唯一解**。

**关键点**:
-   **模数必须两两互素**。这是使用该定理的先决条件。
-   **解是唯一的 (模 M)**。这意味着所有满足条件的解之间都相差 $M$ 的整数倍。如果我们找到了一个特解 $x_0$，那么通解就是 $x_0 + zM$，其中 $z$ 是任意整数。

---

## 3. 求解方法：构造法

求解中国剩余定理问题，最经典的方法是构造法，其思想是分别针对每一个方程构造一个"基础解"，然后将它们线性组合起来。

**求解步骤**:
1.  **计算总模数 $M$**:
    $M = m_1 m_2 \cdots m_k$。

2.  **计算 $M_i$**:
    对于每一个 $i=1, \dots, k$，计算 $M_i = M / m_i$。这个 $M_i$ 是除了 $m_i$ 之外所有模数的乘积。
    -   可以观察到，对于 $j \neq i$， $M_i \equiv 0 \pmod{m_j}$。
    -   同时，因为 $m_i$ 与其他所有 $m_j$ 都互素，所以 $\gcd(M_i, m_i) = 1$。

3.  **计算模逆元 $t_i$**:
    对于每一个 $i$，我们需要找到一个 $t_i$ 使得 $M_i t_i \equiv 1 \pmod{m_i}$。
    这个 $t_i$ 被称为 $M_i$ 对模 $m_i$ 的**模逆元**。因为 $\gcd(M_i, m_i) = 1$，所以这个模逆元保证存在，并且可以用**扩展欧几里得算法**求出。

4.  **构造最终解**:
    将各个部分组合起来，得到方程组的一个特解 $x_0$：
    $$ x_0 = a_1 M_1 t_1 + a_2 M_2 t_2 + \cdots + a_k M_k t_k $$

    **验证这个解**:
    当我们考虑 $x_0$ 对模 $m_i$ 的余数时：
    $x_0 \pmod{m_i} = (a_1 M_1 t_1 + \dots + a_i M_i t_i + \dots + a_k M_k t_k) \pmod{m_i}$
    因为对于所有 $j \neq i$，$M_j$ 含有因子 $m_i$，所以 $M_j \equiv 0 \pmod{m_i}$。
    $x_0 \pmod{m_i} = (0 + \dots + a_i M_i t_i + \dots + 0) \pmod{m_i}$
    $x_0 \equiv a_i (M_i t_i) \pmod{m_i}$
    根据第3步的定义，$M_i t_i \equiv 1 \pmod{m_i}$。
    $x_0 \equiv a_i \cdot 1 \pmod{m_i}$
    $x_0 \equiv a_i \pmod{m_i}$。
    这表明我们构造的解 $x_0$ 确实满足第 $i$ 个方程。由于对所有 $i$ 都成立，所以它是整个方程组的解。

5.  **写出通解**:
    通解为 $x = x_0 + zM$，其中 $z \in \mathbb{Z}$。通常我们取最小非负解，即 $x_0 \pmod M$。

---

## 4. 应用实例：解"孙子问题"

$$
\begin{cases}
x \equiv 2 \pmod{3} & (a_1=2, m_1=3) \\
x \equiv 3 \pmod{5} & (a_2=3, m_2=5) \\
x \equiv 2 \pmod{7} & (a_3=2, m_3=7)
\end{cases}
$$

1.  **计算 M**:
    $M = 3 \times 5 \times 7 = 105$。

2.  **计算 $M_i$**:
    $M_1 = M/3 = 35$
    $M_2 = M/5 = 21$
    $M_3 = M/7 = 15$

3.  **计算模逆元 $t_i$**:
    -   求 $t_1$: $35 t_1 \equiv 1 \pmod{3}$。因为 $35 \equiv 2 \pmod{3}$，所以 $2t_1 \equiv 1 \pmod{3}$。易得 $t_1 = 2$ (因为 $2 \times 2 = 4 \equiv 1 \pmod{3}$)。
    -   求 $t_2$: $21 t_2 \equiv 1 \pmod{5}$。因为 $21 \equiv 1 \pmod{5}$，所以 $1t_2 \equiv 1 \pmod{5}$。易得 $t_2 = 1$。
    -   求 $t_3$: $15 t_3 \equiv 1 \pmod{7}$。因为 $15 \equiv 1 \pmod{7}$，所以 $1t_3 \equiv 1 \pmod{7}$。易得 $t_3 = 1$。

4.  **构造特解 $x_0$**:
    $x_0 = a_1 M_1 t_1 + a_2 M_2 t_2 + a_3 M_3 t_3$
    $x_0 = 2 \times 35 \times 2 + 3 \times 21 \times 1 + 2 \times 15 \times 1$
    $x_0 = 140 + 63 + 30 = 233$

5.  **求最小非负解**:
    $233 \pmod{105}$
    $233 = 2 \times 105 + 23$
    所以最小非负解是 **23**。

**答案**: 所求之数至少为23。

## 5. 总结

中国剩余定理是数论中一个强大而优美的工具，它展示了如何将一个关于大模数的复杂问题，分解为关于两两互素的小模数的若干个简单子问题，并通过巧妙的构造法将子问题的解合并为原问题的解。这种"分而治之"的思想在数学和计算机科学中无处不在。该定理不仅在纯数学中有重要地位，在密码学（如RSA算法的某些实现）、编码理论和计算机算法设计中也有着广泛的应用。 