# ç¨‹åºéªŒè¯ (Program Verification)

> **Proving Programs Correct: From Hoare Logic to Modern Verification**
>
> è¯æ˜ç¨‹åºæ­£ç¡®æ€§ï¼šä»Hoareé€»è¾‘åˆ°ç°ä»£éªŒè¯

---

## ç›®å½•

- [ç¨‹åºéªŒè¯ (Program Verification)](#ç¨‹åºéªŒè¯-program-verification)
  - [ç›®å½•](#ç›®å½•)
  - [ğŸ“‹ æ ¸å¿ƒæ€æƒ³](#-æ ¸å¿ƒæ€æƒ³)
  - [1. Hoareé€»è¾‘](#1-hoareé€»è¾‘)
    - [1.1 Hoareä¸‰å…ƒç»„](#11-hoareä¸‰å…ƒç»„)
    - [1.2 æ¨ç†è§„åˆ™](#12-æ¨ç†è§„åˆ™)
    - [1.3 æœ€å¼±å‰ç½®æ¡ä»¶](#13-æœ€å¼±å‰ç½®æ¡ä»¶)
  - [2. åˆ†ç¦»é€»è¾‘](#2-åˆ†ç¦»é€»è¾‘)
    - [2.1 åˆ†ç¦»é€»è¾‘åŸºç¡€](#21-åˆ†ç¦»é€»è¾‘åŸºç¡€)
    - [2.2 æŒ‡é’ˆç¨‹åºéªŒè¯](#22-æŒ‡é’ˆç¨‹åºéªŒè¯)
  - [3. æ¨¡å‹æ£€æµ‹](#3-æ¨¡å‹æ£€æµ‹)
    - [3.1 æ—¶åºé€»è¾‘](#31-æ—¶åºé€»è¾‘)
    - [3.2 çŠ¶æ€ç©ºé—´æœç´¢](#32-çŠ¶æ€ç©ºé—´æœç´¢)
    - [3.3 ç¬¦å·æ¨¡å‹æ£€æµ‹](#33-ç¬¦å·æ¨¡å‹æ£€æµ‹)
  - [4. æŠ½è±¡è§£é‡Š](#4-æŠ½è±¡è§£é‡Š)
    - [4.1 æŠ½è±¡åŸŸ](#41-æŠ½è±¡åŸŸ)
    - [4.2 ä¸åŠ¨ç‚¹è®¡ç®—](#42-ä¸åŠ¨ç‚¹è®¡ç®—)
  - [5. å®šç†è¯æ˜å™¨éªŒè¯](#5-å®šç†è¯æ˜å™¨éªŒè¯)
    - [5.1 å‡½æ•°å¼ç¨‹åºéªŒè¯](#51-å‡½æ•°å¼ç¨‹åºéªŒè¯)
    - [5.2 å‘½ä»¤å¼ç¨‹åºéªŒè¯](#52-å‘½ä»¤å¼ç¨‹åºéªŒè¯)
  - [6. å½¢å¼åŒ–å®šä¹‰ (Lean)](#6-å½¢å¼åŒ–å®šä¹‰-lean)
  - [7. ä¹ é¢˜](#7-ä¹ é¢˜)
  - [8. å‚è€ƒèµ„æ–™](#8-å‚è€ƒèµ„æ–™)

---

## ğŸ“‹ æ ¸å¿ƒæ€æƒ³

**ç¨‹åºéªŒè¯**ä½¿ç”¨æ•°å­¦æ–¹æ³•è¯æ˜ç¨‹åºæ»¡è¶³å…¶è§„èŒƒï¼Œæ˜¯æ„å»ºå¯ä¿¡è½¯ä»¶ç³»ç»Ÿçš„å…³é”®ã€‚

**ä¸ºä»€ä¹ˆç¨‹åºéªŒè¯é‡è¦**:

```text
æ ¸å¿ƒé—®é¢˜:
â”œâ”€ å¦‚ä½•è¯æ˜ç¨‹åºæ­£ç¡®æ€§ï¼Ÿ
â”œâ”€ å¦‚ä½•éªŒè¯ç¨‹åºæ»¡è¶³è§„èŒƒï¼Ÿ
â”œâ”€ å¦‚ä½•è‡ªåŠ¨åŒ–éªŒè¯è¿‡ç¨‹ï¼Ÿ
â””â”€ å¦‚ä½•éªŒè¯å¤æ‚ç³»ç»Ÿï¼Ÿ

ç†è®ºå·¥å…·:
â”œâ”€ Hoareé€»è¾‘: å‘½ä»¤å¼ç¨‹åºéªŒè¯
â”œâ”€ åˆ†ç¦»é€»è¾‘: æŒ‡é’ˆç¨‹åºéªŒè¯
â”œâ”€ æ¨¡å‹æ£€æµ‹: æœ‰é™çŠ¶æ€ç³»ç»Ÿ
â””â”€ æŠ½è±¡è§£é‡Š: ç¨‹åºåˆ†æ

å®è·µåº”ç”¨:
â”œâ”€ å®‰å…¨å…³é”®ç³»ç»Ÿ: èˆªç©ºèˆªå¤©ã€åŒ»ç–—è®¾å¤‡
â”œâ”€ ç¼–è¯‘å™¨éªŒè¯: ä¿è¯ç¼–è¯‘æ­£ç¡®æ€§
â”œâ”€ æ“ä½œç³»ç»ŸéªŒè¯: å†…æ ¸æ­£ç¡®æ€§
â””â”€ AIç³»ç»ŸéªŒè¯: ç¥ç»ç½‘ç»œé²æ£’æ€§
```

---

## 1. Hoareé€»è¾‘

### 1.1 Hoareä¸‰å…ƒç»„

**å®šä¹‰ 1.1** (Hoareä¸‰å…ƒç»„)
**Hoareä¸‰å…ƒç»„** \( \{P\} C \{Q\} \) è¡¨ç¤ºï¼š
- å¦‚æœç¨‹åº \( C \) åœ¨æ»¡è¶³å‰ç½®æ¡ä»¶ \( P \) çš„çŠ¶æ€ä¸‹æ‰§è¡Œ
- ä¸”ç¨‹åºç»ˆæ­¢
- åˆ™æ‰§è¡Œåæ»¡è¶³åç½®æ¡ä»¶ \( Q \)

**ä¾‹ 1.1**:
\[
\{x = 5\} \quad x := x + 1 \quad \{x = 6\}
\]

### 1.2 æ¨ç†è§„åˆ™

**èµ‹å€¼è§„åˆ™**:
\[
\frac{}{\{Q[E/x]\} \quad x := E \quad \{Q\}}
\]

**åºåˆ—è§„åˆ™**:
\[
\frac{\{P\} C_1 \{R\} \quad \{R\} C_2 \{Q\}}{\{P\} C_1; C_2 \{Q\}}
\]

**æ¡ä»¶è§„åˆ™**:
\[
\frac{\{P \land B\} C_1 \{Q\} \quad \{P \land \neg B\} C_2 \{Q\}}{\{P\} \text{ if } B \text{ then } C_1 \text{ else } C_2 \{Q\}}
\]

**å¾ªç¯è§„åˆ™**:
\[
\frac{\{I \land B\} C \{I\}}{\{I\} \text{ while } B \text{ do } C \{I \land \neg B\}}
\]

å…¶ä¸­ \( I \) æ˜¯å¾ªç¯ä¸å˜é‡ã€‚

### 1.3 æœ€å¼±å‰ç½®æ¡ä»¶

**å®šä¹‰ 1.2** (æœ€å¼±å‰ç½®æ¡ä»¶)
**æœ€å¼±å‰ç½®æ¡ä»¶** \( \text{wp}(C, Q) \) æ˜¯ä½¿å¾— \( \{P\} C \{Q\} \) æˆç«‹çš„æœ€å¼±æ¡ä»¶ \( P \)ã€‚

**æ€§è´¨**:
- \( \text{wp}(x := E, Q) = Q[E/x] \)
- \( \text{wp}(C_1; C_2, Q) = \text{wp}(C_1, \text{wp}(C_2, Q)) \)

---

## 2. åˆ†ç¦»é€»è¾‘

### 2.1 åˆ†ç¦»é€»è¾‘åŸºç¡€

**åˆ†ç¦»é€»è¾‘**æ‰©å±•Hoareé€»è¾‘ä»¥å¤„ç†æŒ‡é’ˆå’ŒåŠ¨æ€å†…å­˜ã€‚

**åˆ†ç¦»åˆå–** \( P * Q \): å†…å­˜å¯ä»¥åˆ†å‰²ä¸ºæ»¡è¶³ \( P \) å’Œ \( Q \) çš„ä¸¤éƒ¨åˆ†ã€‚

**ä¾‹ 2.1** (æŒ‡é’ˆèµ‹å€¼):
\[
\{x \mapsto v\} \quad *x := w \quad \{x \mapsto w\}
\]

### 2.2 æŒ‡é’ˆç¨‹åºéªŒè¯

**æ¡†æ¶è§„åˆ™**:
\[
\frac{\{P\} C \{Q\}}{\{P * R\} C \{Q * R\}}
\]

å…è®¸åœ¨åˆ†ç¦»çš„å †ä¸Šè¿›è¡Œæ¨ç†ã€‚

---

## 3. æ¨¡å‹æ£€æµ‹

### 3.1 æ—¶åºé€»è¾‘

**çº¿æ€§æ—¶åºé€»è¾‘ (LTL)**:
- \( \mathbf{G} \phi \): å…¨å±€ä¸ºçœŸ
- \( \mathbf{F} \phi \): æœ€ç»ˆä¸ºçœŸ
- \( \mathbf{X} \phi \): ä¸‹ä¸€æ—¶åˆ»ä¸ºçœŸ
- \( \phi \mathbf{U} \psi \): \( \phi \) ç›´åˆ° \( \psi \)

**è®¡ç®—æ ‘é€»è¾‘ (CTL)**:
- \( \mathbf{AG} \phi \): æ‰€æœ‰è·¯å¾„å…¨å±€ä¸ºçœŸ
- \( \mathbf{EF} \phi \): å­˜åœ¨è·¯å¾„æœ€ç»ˆä¸ºçœŸ

### 3.2 çŠ¶æ€ç©ºé—´æœç´¢

**æ¨¡å‹æ£€æµ‹ç®—æ³•**:
1. æ„å»ºçŠ¶æ€è½¬æ¢å›¾
2. æ£€æŸ¥æ—¶åºé€»è¾‘å…¬å¼
3. æŠ¥å‘Šåä¾‹ï¼ˆå¦‚æœå­˜åœ¨ï¼‰

### 3.3 ç¬¦å·æ¨¡å‹æ£€æµ‹

**ç¬¦å·è¡¨ç¤º**: ä½¿ç”¨BDDï¼ˆäºŒå…ƒå†³ç­–å›¾ï¼‰è¡¨ç¤ºçŠ¶æ€é›†åˆã€‚

**ä¼˜åŠ¿**: å¯ä»¥å¤„ç†éå¸¸å¤§çš„çŠ¶æ€ç©ºé—´ã€‚

---

## 4. æŠ½è±¡è§£é‡Š

### 4.1 æŠ½è±¡åŸŸ

**æŠ½è±¡è§£é‡Š**é€šè¿‡æŠ½è±¡åŸŸè¿‘ä¼¼ç¨‹åºè¡Œä¸ºã€‚

**ä¾‹ 4.1** (åŒºé—´æŠ½è±¡):
- å…·ä½“å€¼: \( x = 5 \)
- æŠ½è±¡å€¼: \( x \in [3, 7] \)

### 4.2 ä¸åŠ¨ç‚¹è®¡ç®—

**æŠ½è±¡è¯­ä¹‰**:
\[
[\text{while } B \text{ do } C]^\sharp = \text{lfp}(F^\sharp)
\]

å…¶ä¸­ \( F^\sharp \) æ˜¯æŠ½è±¡è½¬ç§»å‡½æ•°ã€‚

---

## 5. å®šç†è¯æ˜å™¨éªŒè¯

### 5.1 å‡½æ•°å¼ç¨‹åºéªŒè¯

**åœ¨Lean/Coqä¸­éªŒè¯**:
```lean
def factorial (n : â„•) : â„• :=
  match n with
  | 0 => 1
  | n+1 => (n+1) * factorial n

theorem factorial_correct (n : â„•) :
  factorial n = n! := by
  -- å½’çº³è¯æ˜
```

### 5.2 å‘½ä»¤å¼ç¨‹åºéªŒè¯

**ä½¿ç”¨Hoareé€»è¾‘éªŒè¯**:
```lean
def swap (x y : ref â„•) : unit :=
  let t := !x in
  x := !y;
  y := t

theorem swap_correct (x y : ref â„•) (vx vy : â„•) :
  {x â†¦ vx * y â†¦ vy} swap x y {x â†¦ vy * y â†¦ vx} := by
  -- ä½¿ç”¨åˆ†ç¦»é€»è¾‘è¯æ˜
```

---

## 6. å½¢å¼åŒ–å®šä¹‰ (Lean)

```lean
-- Hoareä¸‰å…ƒç»„
structure HoareTriple (P Q : State â†’ Prop) (C : Program) : Prop :=
  valid : âˆ€ s, P s â†’ âˆƒ s', execute C s = some s' âˆ§ Q s'

-- æœ€å¼±å‰ç½®æ¡ä»¶
def wp (C : Program) (Q : State â†’ Prop) : State â†’ Prop :=
  Î» s, âˆ€ s', execute C s = some s' â†’ Q s'

-- å¾ªç¯ä¸å˜é‡
def loop_invariant (I : State â†’ Prop) (B : State â†’ Bool) (C : Program) : Prop :=
  âˆ€ s, I s âˆ§ B s â†’ wp C I s
```

---

## 7. ä¹ é¢˜

### åŸºç¡€ä¹ é¢˜

1. **Hoareé€»è¾‘**:
   è¯æ˜ \( \{x = a \land y = b\} \text{ swap}(x, y) \{x = b \land y = a\} \)

2. **å¾ªç¯ä¸å˜é‡**:
   æ‰¾åˆ°æ’åºç®—æ³•çš„å¾ªç¯ä¸å˜é‡ã€‚

3. **æ¨¡å‹æ£€æµ‹**:
   éªŒè¯äº’æ–¥é”ç®—æ³•çš„å®‰å…¨æ€§ã€‚

### è¿›é˜¶ä¹ é¢˜

1. **åˆ†ç¦»é€»è¾‘**:
   éªŒè¯é“¾è¡¨åè½¬ç¨‹åºã€‚

2. **æŠ½è±¡è§£é‡Š**:
   å®ç°åŒºé—´æŠ½è±¡åŸŸã€‚

3. **å®šç†è¯æ˜**:
   åœ¨Leanä¸­éªŒè¯å¿«é€Ÿæ’åºã€‚

---

## 8. å‚è€ƒèµ„æ–™

### æ•™æ

1. **Winskel, G.** *The Formal Semantics of Programming Languages*. MIT Press, 1993.
2. **Reynolds, J. C.** "Separation Logic: A Logic for Shared Mutable Data Structures." *LICS*, 2002.
3. **Clarke, E. M. et al.** *Model Checking*. MIT Press, 2018.

### è¯¾ç¨‹

1. **CMU 15-414** - Bug Catching: Automated Program Verification
2. **MIT 6.826** - Principles of Computer Systems

### è®ºæ–‡

1. **Hoare, C. A. R.** "An Axiomatic Basis for Computer Programming." *Communications of the ACM*, 1969.
2. **Reynolds, J. C.** "Separation Logic: A Logic for Shared Mutable Data Structures." *LICS*, 2002.

---

**æœ€åæ›´æ–°**: 2025-12-20
**å®Œæˆåº¦**: çº¦75% (æ ¸å¿ƒå†…å®¹å®Œæˆï¼Œå¯ç»§ç»­è¡¥å……æ›´å¤šåº”ç”¨å®ä¾‹å’Œå½¢å¼åŒ–è¯æ˜)
